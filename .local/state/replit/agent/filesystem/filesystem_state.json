{"file_contents":{"script/build.ts":{"content":"import { build as esbuild } from \"esbuild\";\nimport { build as viteBuild } from \"vite\";\nimport { rm, readFile, writeFile } from \"fs/promises\";\n\n// server deps to bundle to reduce openat(2) syscalls\n// which helps cold start times\nconst allowlist = [\n  \"@anthropic-ai/sdk\",\n  \"@google/generative-ai\",\n  \"@neondatabase/serverless\",\n  \"axios\",\n  \"connect-pg-simple\",\n  \"cors\",\n  \"date-fns\",\n  \"drizzle-orm\",\n  \"drizzle-zod\",\n  \"express\",\n  \"express-rate-limit\",\n  \"express-session\",\n  \"jsonwebtoken\",\n  \"memorystore\",\n  \"multer\",\n  \"nanoid\",\n  \"node-ical\",\n  \"nodemailer\",\n  \"openai\",\n  \"passport\",\n  \"passport-local\",\n  \"stripe\",\n  \"uuid\",\n  \"ws\",\n  \"xlsx\",\n  \"zod\",\n  \"zod-validation-error\",\n];\n\nasync function buildAll() {\n  await rm(\"dist\", { recursive: true, force: true });\n\n  console.log(\"building client...\");\n  await viteBuild();\n\n  console.log(\"building server...\");\n  const pkg = JSON.parse(await readFile(\"package.json\", \"utf-8\"));\n  const allDeps = [\n    ...Object.keys(pkg.dependencies || {}),\n    ...Object.keys(pkg.devDependencies || {}),\n  ];\n  const externals = allDeps.filter((dep) => !allowlist.includes(dep));\n\n  // Banner to provide CommonJS compatibility in ESM bundle\n  const esmBanner = `\nimport { createRequire as __createRequire } from 'module';\nimport { fileURLToPath as __fileURLToPath } from 'url';\nimport { dirname as __dirname_fn } from 'path';\nconst require = __createRequire(import.meta.url);\nconst __filename = __fileURLToPath(import.meta.url);\nconst __dirname = __dirname_fn(__filename);\n`;\n\n  // Build as ESM to preserve import.meta usage\n  await esbuild({\n    entryPoints: [\"server/index.ts\"],\n    platform: \"node\",\n    target: \"node20\",\n    bundle: true,\n    format: \"esm\",\n    outfile: \"dist/index.mjs\",\n    banner: {\n      js: esmBanner.trim(),\n    },\n    define: {\n      \"process.env.NODE_ENV\": '\"production\"',\n    },\n    minify: true,\n    external: externals,\n    logLevel: \"info\",\n  });\n\n  // Create a CJS wrapper that dynamically imports the ESM bundle\n  const cjsWrapper = `// CommonJS wrapper to load ESM bundle\n(async () => {\n  await import('./index.mjs');\n})();\n`;\n  await writeFile(\"dist/index.cjs\", cjsWrapper.trim());\n}\n\nbuildAll().catch((err) => {\n  console.error(err);\n  process.exit(1);\n});\n","path":null,"size_bytes":2242,"size_tokens":null},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","path":null,"size_bytes":3021,"size_tokens":null},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","path":null,"size_bytes":166,"size_tokens":null},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","path":null,"size_bytes":1209,"size_tokens":null},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","path":null,"size_bytes":261,"size_tokens":null},"server/storage.ts":{"content":"import { eq, lte, desc, and, sql, or, inArray, gte } from \"drizzle-orm\";\nimport { db } from \"./db\";\nimport {\n  usersTable,\n  lecturesTable,\n  topicReviewStatsTable,\n  reviewEventsTable,\n  dailyQuizPlansTable,\n  cachedQuestionsTable,\n  calendarSettingsTable,\n  calendarEventsTable,\n  lectureUploadsTable,\n  dismissedLecturesTable,\n  friendshipsTable,\n  weeklyXpLogsTable,\n  calculateNextReview,\n  calculateTopicPriority,\n  ALL_ACHIEVEMENTS,\n  INITIAL_USER_PROFILE,\n  DEMO_USER_PROFILE,\n  DEMO_LECTURES,\n  DEMO_CALENDAR_SETTINGS,\n  DEMO_CALENDAR_EVENTS,\n} from \"@shared/schema\";\nimport type {\n  UserProfile,\n  Lecture,\n  Achievement,\n  CalendarSettings,\n  CalendarEvent,\n  TopicReviewStats,\n  ReviewEvent,\n  DailyQuizPlan,\n  Question,\n  DismissedLecture,\n  Friendship,\n  DbUser,\n  DbLecture,\n  DbTopicReviewStats,\n  DbCalendarSettings,\n  DbCalendarEvent,\n  DbDailyQuizPlan,\n  DbCachedQuestion,\n  DbLectureUpload,\n  DbDismissedLecture,\n  DbFriendship,\n  DbWeeklyXpLog,\n  User,\n  UpsertUser,\n} from \"@shared/schema\";\n\nexport interface LectureUpload {\n  id: string;\n  batchId: string;\n  userId: string;\n  filename: string | null;\n  status: \"pending\" | \"processing\" | \"completed\" | \"error\";\n  error: string | null;\n  lectureId: string | null;\n  createdAt: string;\n}\n\nexport interface IStorage {\n  getUser(id: string): Promise<User | undefined>;\n  upsertUser(user: UpsertUser): Promise<User>;\n  \n  getUserProfile(userId: string): Promise<UserProfile>;\n  updateUserProfile(userId: string, profile: Partial<UserProfile>): Promise<UserProfile>;\n  resetUserProfile(userId: string): Promise<UserProfile>;\n  loadDemoData(userId: string): Promise<{ profile: UserProfile; lectures: Lecture[]; calendarSettings: CalendarSettings; calendarEvents: CalendarEvent[] }>;\n  \n  getLectures(userId: string): Promise<Lecture[]>;\n  getLecture(userId: string, id: string): Promise<Lecture | undefined>;\n  addLecture(userId: string, lecture: Omit<Lecture, \"id\">): Promise<Lecture>;\n  updateLecture(userId: string, id: string, updates: Partial<Lecture>): Promise<Lecture | undefined>;\n  deleteLecture(userId: string, id: string): Promise<boolean>;\n  getLectureContent(userId: string, id: string): Promise<string | undefined>;\n  \n  getWeakTopics(userId: string): Promise<string[]>;\n  \n  getCalendarSettings(userId: string): Promise<CalendarSettings | null>;\n  setCalendarSettings(userId: string, settings: CalendarSettings): Promise<CalendarSettings>;\n  clearCalendarSettings(userId: string): Promise<void>;\n  \n  getCalendarEvents(userId: string): Promise<CalendarEvent[]>;\n  setCalendarEvents(userId: string, events: CalendarEvent[]): Promise<CalendarEvent[]>;\n  updateCalendarEventMatch(userId: string, eventId: string, lectureId: string | null): Promise<CalendarEvent | undefined>;\n  \n  getTopicReviewStats(userId: string): Promise<TopicReviewStats[]>;\n  getTopicReviewStat(userId: string, topic: string): Promise<TopicReviewStats | undefined>;\n  updateTopicReviewStats(userId: string, topic: string, lectureId: string, lectureTitle: string, score: number): Promise<TopicReviewStats>;\n  initializeTopicsFromLecture(userId: string, lectureId: string, topics: string[]): Promise<void>;\n  \n  getDueTopics(userId: string, limit?: number): Promise<TopicReviewStats[]>;\n  getCurrentDailyQuizPlan(userId: string): Promise<DailyQuizPlan | null>;\n  setCurrentDailyQuizPlan(userId: string, plan: DailyQuizPlan): Promise<DailyQuizPlan>;\n  completeDailyQuizPlan(userId: string, score: number): Promise<DailyQuizPlan | null>;\n  \n  addReviewEvent(userId: string, event: Omit<ReviewEvent, \"id\">): Promise<ReviewEvent>;\n  getReviewHistory(userId: string, limit?: number): Promise<ReviewEvent[]>;\n  \n  getCachedQuestions(userId: string, topic: string, lectureId: string): Promise<Question[]>;\n  cacheQuestions(userId: string, topic: string, lectureId: string, questions: Question[]): Promise<void>;\n  \n  createBatchUpload(userId: string, batchId: string, items: { filename: string | null }[]): Promise<LectureUpload[]>;\n  updateBatchUploadStatus(userId: string, uploadId: string, status: \"pending\" | \"processing\" | \"completed\" | \"error\", lectureId?: string, error?: string): Promise<LectureUpload | undefined>;\n  getBatchUploads(userId: string, batchId: string): Promise<LectureUpload[]>;\n  \n  getDismissedLectures(userId: string): Promise<DismissedLecture[]>;\n  dismissLecture(userId: string, calendarEventId: string, reason?: string): Promise<void>;\n  undismissLecture(userId: string, calendarEventId: string): Promise<void>;\n  \n  sendFriendRequest(userId: string, friendUsername: string): Promise<Friendship>;\n  acceptFriendRequest(userId: string, requestId: string): Promise<void>;\n  declineFriendRequest(userId: string, requestId: string): Promise<void>;\n  removeFriend(userId: string, friendId: string): Promise<void>;\n  getFriends(userId: string): Promise<{friend: User, status: string}[]>;\n  getPendingRequests(userId: string): Promise<{from: User, request: Friendship}[]>;\n  getLeaderboard(userId: string): Promise<{user: User, weeklyXp: number, rank: number}[]>;\n  logXpEarned(userId: string, amount: number): Promise<void>;\n  getUserByUsername(username: string): Promise<User | undefined>;\n}\n\nfunction dbUserToProfile(user: DbUser): UserProfile {\n  return {\n    level: user.level,\n    totalXP: user.totalXP,\n    xpToNextLevel: user.xpToNextLevel,\n    currentStreak: user.currentStreak,\n    longestStreak: user.longestStreak,\n    totalLectures: user.totalLectures,\n    averageConfidence: user.averageConfidence,\n    achievements: (user.achievements as Achievement[]) || ALL_ACHIEVEMENTS.map(a => ({ ...a })),\n    masteredTopics: (user.masteredTopics as string[]) || [],\n    needsPractice: (user.needsPractice as string[]) || [],\n    powerUps: (user.powerUps as UserProfile[\"powerUps\"]) || { secondChance: 0, hints: 0, doubleXP: false },\n    lastActivityDate: user.lastActivityDate || undefined,\n  };\n}\n\nfunction dbLectureToLecture(dbLecture: DbLecture): Lecture {\n  return {\n    id: String(dbLecture.id),\n    title: dbLecture.title,\n    date: dbLecture.date,\n    content: dbLecture.content,\n    reviewScore: dbLecture.reviewScore,\n    xpEarned: dbLecture.xpEarned,\n    incorrectTopics: (dbLecture.incorrectTopics as string[]) || [],\n    confidenceRating: dbLecture.confidenceRating,\n    dailyQuizzes: (dbLecture.dailyQuizzes as Lecture[\"dailyQuizzes\"]) || [],\n    needsReview: dbLecture.needsReview,\n    lastReviewed: dbLecture.lastReviewed || undefined,\n    identifiedSkills: (dbLecture.identifiedSkills as Lecture[\"identifiedSkills\"]) || [],\n    questionsAnswered: dbLecture.questionsAnswered,\n  };\n}\n\nfunction dbTopicStatsToTopicStats(dbStats: DbTopicReviewStats): TopicReviewStats {\n  return {\n    topic: dbStats.topic,\n    lectureId: String(dbStats.lectureId),\n    lectureTitle: dbStats.lectureTitle,\n    lastReviewed: dbStats.lastReviewed,\n    lastScore: dbStats.lastScore,\n    reviewCount: dbStats.reviewCount,\n    easeFactor: dbStats.easeFactor,\n    interval: dbStats.interval,\n    nextDue: dbStats.nextDue,\n    streak: dbStats.streak,\n  };\n}\n\nfunction dbCalendarSettingsToSettings(dbSettings: DbCalendarSettings): CalendarSettings {\n  return {\n    url: dbSettings.url,\n    lastSync: dbSettings.lastSync || undefined,\n    lastSyncStatus: (dbSettings.lastSyncStatus as \"success\" | \"error\") || undefined,\n    lastSyncError: dbSettings.lastSyncError || undefined,\n  };\n}\n\nfunction dbCalendarEventToEvent(dbEvent: DbCalendarEvent): CalendarEvent {\n  return {\n    id: String(dbEvent.id),\n    uid: dbEvent.uid,\n    title: dbEvent.title,\n    eventType: dbEvent.eventType as CalendarEvent[\"eventType\"],\n    startsAt: dbEvent.startsAt,\n    endsAt: dbEvent.endsAt,\n    location: dbEvent.location || undefined,\n    description: dbEvent.description || undefined,\n    matchedLectureId: dbEvent.matchedLectureId ? String(dbEvent.matchedLectureId) : undefined,\n  };\n}\n\nfunction dbDailyQuizPlanToPlan(dbPlan: DbDailyQuizPlan): DailyQuizPlan {\n  return {\n    id: String(dbPlan.id),\n    generatedAt: dbPlan.generatedAt,\n    topics: (dbPlan.topics as DailyQuizPlan[\"topics\"]) || [],\n    lectureExcerpts: (dbPlan.lectureExcerpts as DailyQuizPlan[\"lectureExcerpts\"]) || [],\n    completed: dbPlan.completed,\n    completedAt: dbPlan.completedAt || undefined,\n    score: dbPlan.score || undefined,\n  };\n}\n\nfunction dbLectureUploadToUpload(dbUpload: DbLectureUpload): LectureUpload {\n  return {\n    id: String(dbUpload.id),\n    batchId: dbUpload.batchId,\n    userId: dbUpload.userId,\n    filename: dbUpload.filename,\n    status: (dbUpload.status as LectureUpload[\"status\"]) || \"pending\",\n    error: dbUpload.error,\n    lectureId: dbUpload.lectureId ? String(dbUpload.lectureId) : null,\n    createdAt: dbUpload.createdAt?.toISOString() || new Date().toISOString(),\n  };\n}\n\nexport class DatabaseStorage implements IStorage {\n  \n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(usersTable).where(eq(usersTable.id, id));\n    return user;\n  }\n\n  async upsertUser(userData: UpsertUser): Promise<User> {\n    const [user] = await db\n      .insert(usersTable)\n      .values(userData)\n      .onConflictDoUpdate({\n        target: usersTable.id,\n        set: {\n          ...userData,\n          updatedAt: new Date(),\n        },\n      })\n      .returning();\n    return user;\n  }\n\n  async getUserProfile(userId: string): Promise<UserProfile> {\n    const [user] = await db.select().from(usersTable).where(eq(usersTable.id, userId));\n    if (!user) {\n      const [newUser] = await db.insert(usersTable).values({\n        id: userId,\n        achievements: ALL_ACHIEVEMENTS.map(a => ({ ...a })),\n        powerUps: { secondChance: 0, hints: 0, doubleXP: false },\n        masteredTopics: [],\n        needsPractice: [],\n      }).returning();\n      return dbUserToProfile(newUser);\n    }\n    return dbUserToProfile(user);\n  }\n\n  async updateUserProfile(userId: string, updates: Partial<UserProfile>): Promise<UserProfile> {\n    const [user] = await db.select().from(usersTable).where(eq(usersTable.id, userId));\n    if (!user) {\n      await this.getUserProfile(userId);\n    }\n    \n    const dbUpdates: Partial<DbUser> = {};\n    if (updates.level !== undefined) dbUpdates.level = updates.level;\n    if (updates.totalXP !== undefined) dbUpdates.totalXP = updates.totalXP;\n    if (updates.xpToNextLevel !== undefined) dbUpdates.xpToNextLevel = updates.xpToNextLevel;\n    if (updates.currentStreak !== undefined) dbUpdates.currentStreak = updates.currentStreak;\n    if (updates.longestStreak !== undefined) dbUpdates.longestStreak = updates.longestStreak;\n    if (updates.totalLectures !== undefined) dbUpdates.totalLectures = updates.totalLectures;\n    if (updates.averageConfidence !== undefined) dbUpdates.averageConfidence = updates.averageConfidence;\n    if (updates.achievements !== undefined) dbUpdates.achievements = updates.achievements;\n    if (updates.masteredTopics !== undefined) dbUpdates.masteredTopics = updates.masteredTopics;\n    if (updates.needsPractice !== undefined) dbUpdates.needsPractice = updates.needsPractice;\n    if (updates.powerUps !== undefined) dbUpdates.powerUps = updates.powerUps;\n    if (updates.lastActivityDate !== undefined) dbUpdates.lastActivityDate = updates.lastActivityDate;\n    \n    const [updated] = await db.update(usersTable)\n      .set(dbUpdates)\n      .where(eq(usersTable.id, userId))\n      .returning();\n    \n    return dbUserToProfile(updated);\n  }\n\n  async resetUserProfile(userId: string): Promise<UserProfile> {\n    await db.delete(lecturesTable).where(eq(lecturesTable.userId, userId));\n    await db.delete(topicReviewStatsTable).where(eq(topicReviewStatsTable.userId, userId));\n    await db.delete(reviewEventsTable).where(eq(reviewEventsTable.userId, userId));\n    await db.delete(dailyQuizPlansTable).where(eq(dailyQuizPlansTable.userId, userId));\n    await db.delete(cachedQuestionsTable).where(eq(cachedQuestionsTable.userId, userId));\n    await db.delete(calendarSettingsTable).where(eq(calendarSettingsTable.userId, userId));\n    await db.delete(calendarEventsTable).where(eq(calendarEventsTable.userId, userId));\n    \n    await db.update(usersTable).set({\n      level: 1,\n      totalXP: 0,\n      xpToNextLevel: 400,\n      currentStreak: 0,\n      longestStreak: 0,\n      totalLectures: 0,\n      averageConfidence: 0,\n      achievements: ALL_ACHIEVEMENTS.map(a => ({ ...a })),\n      masteredTopics: [],\n      needsPractice: [],\n      powerUps: { secondChance: 0, hints: 0, doubleXP: false },\n      lastActivityDate: null,\n    }).where(eq(usersTable.id, userId));\n    \n    return this.getUserProfile(userId);\n  }\n\n  async loadDemoData(userId: string): Promise<{ profile: UserProfile; lectures: Lecture[]; calendarSettings: CalendarSettings; calendarEvents: CalendarEvent[] }> {\n    await this.resetUserProfile(userId);\n    \n    const [user] = await db.update(usersTable).set({\n      level: DEMO_USER_PROFILE.level,\n      totalXP: DEMO_USER_PROFILE.totalXP,\n      xpToNextLevel: DEMO_USER_PROFILE.xpToNextLevel,\n      currentStreak: DEMO_USER_PROFILE.currentStreak,\n      longestStreak: DEMO_USER_PROFILE.longestStreak,\n      totalLectures: DEMO_USER_PROFILE.totalLectures,\n      averageConfidence: DEMO_USER_PROFILE.averageConfidence,\n      achievements: DEMO_USER_PROFILE.achievements,\n      masteredTopics: DEMO_USER_PROFILE.masteredTopics,\n      needsPractice: DEMO_USER_PROFILE.needsPractice,\n      powerUps: DEMO_USER_PROFILE.powerUps,\n      lastActivityDate: DEMO_USER_PROFILE.lastActivityDate,\n    }).where(eq(usersTable.id, userId)).returning();\n    \n    const insertedLectures: Lecture[] = [];\n    for (const lecture of DEMO_LECTURES) {\n      const [dbLecture] = await db.insert(lecturesTable).values({\n        userId,\n        title: lecture.title,\n        date: lecture.date,\n        content: lecture.content,\n        reviewScore: lecture.reviewScore,\n        xpEarned: lecture.xpEarned,\n        incorrectTopics: lecture.incorrectTopics,\n        confidenceRating: lecture.confidenceRating,\n        dailyQuizzes: lecture.dailyQuizzes,\n        needsReview: lecture.needsReview,\n        lastReviewed: lecture.lastReviewed,\n        identifiedSkills: lecture.identifiedSkills,\n        questionsAnswered: lecture.questionsAnswered,\n      }).returning();\n      insertedLectures.push(dbLectureToLecture(dbLecture));\n    }\n    \n    const [calSettings] = await db.insert(calendarSettingsTable).values({\n      userId,\n      url: DEMO_CALENDAR_SETTINGS.url,\n      lastSync: DEMO_CALENDAR_SETTINGS.lastSync,\n      lastSyncStatus: DEMO_CALENDAR_SETTINGS.lastSyncStatus,\n    }).returning();\n    \n    const insertedEvents: CalendarEvent[] = [];\n    for (const event of DEMO_CALENDAR_EVENTS) {\n      const [dbEvent] = await db.insert(calendarEventsTable).values({\n        userId,\n        uid: event.uid,\n        title: event.title,\n        eventType: event.eventType,\n        startsAt: event.startsAt,\n        endsAt: event.endsAt,\n        location: event.location,\n        description: event.description,\n      }).returning();\n      insertedEvents.push(dbCalendarEventToEvent(dbEvent));\n    }\n    \n    const today = new Date();\n    const demoTopics = [\n      { topic: \"Recursive Function Call Stack\", lectureId: 3, lectureTitle: \"Functions & Modular Design\", lastScore: 65, daysAgo: 5, dueDaysAgo: 2 },\n      { topic: \"Binary Tree Traversal Algorithms\", lectureId: 6, lectureTitle: \"Data Structures Fundamentals\", lastScore: 58, daysAgo: 4, dueDaysAgo: 3 },\n      { topic: \"Method Overriding & Dynamic Dispatch\", lectureId: 5, lectureTitle: \"Object-Oriented Programming\", lastScore: 72, daysAgo: 7, dueDaysAgo: 0 },\n      { topic: \"Loop Complexity & Big-O Analysis\", lectureId: 2, lectureTitle: \"Control Flow & Loops\", lastScore: 85, daysAgo: 10, dueDaysAgo: 3 },\n      { topic: \"Abstract Classes vs Interfaces\", lectureId: 5, lectureTitle: \"Object-Oriented Programming\", lastScore: 60, daysAgo: 6, dueDaysAgo: 5 },\n    ];\n    \n    for (const t of demoTopics) {\n      await db.insert(topicReviewStatsTable).values({\n        userId,\n        topic: t.topic,\n        lectureId: t.lectureId,\n        lectureTitle: t.lectureTitle,\n        lastReviewed: new Date(today.getTime() - t.daysAgo * 24 * 60 * 60 * 1000).toISOString().split('T')[0],\n        lastScore: t.lastScore,\n        reviewCount: 2,\n        easeFactor: 2.3,\n        interval: 3,\n        nextDue: new Date(today.getTime() - t.dueDaysAgo * 24 * 60 * 60 * 1000).toISOString().split('T')[0],\n        streak: t.lastScore >= 70 ? 1 : 0,\n      });\n    }\n    \n    return {\n      profile: dbUserToProfile(user),\n      lectures: insertedLectures,\n      calendarSettings: dbCalendarSettingsToSettings(calSettings),\n      calendarEvents: insertedEvents,\n    };\n  }\n\n  async getLectures(userId: string): Promise<Lecture[]> {\n    const dbLectures = await db.select().from(lecturesTable)\n      .where(eq(lecturesTable.userId, userId))\n      .orderBy(desc(lecturesTable.createdAt));\n    return dbLectures.map(dbLectureToLecture);\n  }\n\n  async getLecture(userId: string, id: string): Promise<Lecture | undefined> {\n    const [dbLecture] = await db.select().from(lecturesTable)\n      .where(and(eq(lecturesTable.id, parseInt(id)), eq(lecturesTable.userId, userId)));\n    return dbLecture ? dbLectureToLecture(dbLecture) : undefined;\n  }\n\n  async addLecture(userId: string, lectureData: Omit<Lecture, \"id\">): Promise<Lecture> {\n    const [dbLecture] = await db.insert(lecturesTable).values({\n      userId,\n      title: lectureData.title,\n      date: lectureData.date,\n      content: lectureData.content,\n      reviewScore: lectureData.reviewScore,\n      xpEarned: lectureData.xpEarned,\n      incorrectTopics: lectureData.incorrectTopics,\n      confidenceRating: lectureData.confidenceRating,\n      dailyQuizzes: lectureData.dailyQuizzes,\n      needsReview: lectureData.needsReview,\n      lastReviewed: lectureData.lastReviewed,\n      identifiedSkills: lectureData.identifiedSkills,\n      questionsAnswered: lectureData.questionsAnswered,\n    }).returning();\n    \n    const lectures = await db.select().from(lecturesTable).where(eq(lecturesTable.userId, userId));\n    await this.updateUserProfile(userId, { totalLectures: lectures.length });\n    \n    return dbLectureToLecture(dbLecture);\n  }\n\n  async updateLecture(userId: string, id: string, updates: Partial<Lecture>): Promise<Lecture | undefined> {\n    const dbUpdates: any = {};\n    if (updates.title !== undefined) dbUpdates.title = updates.title;\n    if (updates.date !== undefined) dbUpdates.date = updates.date;\n    if (updates.content !== undefined) dbUpdates.content = updates.content;\n    if (updates.reviewScore !== undefined) dbUpdates.reviewScore = updates.reviewScore;\n    if (updates.xpEarned !== undefined) dbUpdates.xpEarned = updates.xpEarned;\n    if (updates.incorrectTopics !== undefined) dbUpdates.incorrectTopics = updates.incorrectTopics;\n    if (updates.confidenceRating !== undefined) dbUpdates.confidenceRating = updates.confidenceRating;\n    if (updates.dailyQuizzes !== undefined) dbUpdates.dailyQuizzes = updates.dailyQuizzes;\n    if (updates.needsReview !== undefined) dbUpdates.needsReview = updates.needsReview;\n    if (updates.lastReviewed !== undefined) dbUpdates.lastReviewed = updates.lastReviewed;\n    if (updates.identifiedSkills !== undefined) dbUpdates.identifiedSkills = updates.identifiedSkills;\n    if (updates.questionsAnswered !== undefined) dbUpdates.questionsAnswered = updates.questionsAnswered;\n    \n    const [updated] = await db.update(lecturesTable)\n      .set(dbUpdates)\n      .where(and(eq(lecturesTable.id, parseInt(id)), eq(lecturesTable.userId, userId)))\n      .returning();\n    \n    return updated ? dbLectureToLecture(updated) : undefined;\n  }\n\n  async deleteLecture(userId: string, id: string): Promise<boolean> {\n    await db.delete(lecturesTable).where(and(eq(lecturesTable.id, parseInt(id)), eq(lecturesTable.userId, userId)));\n    const lectures = await db.select().from(lecturesTable).where(eq(lecturesTable.userId, userId));\n    await this.updateUserProfile(userId, { totalLectures: lectures.length });\n    return true;\n  }\n\n  async getLectureContent(userId: string, id: string): Promise<string | undefined> {\n    const [lecture] = await db.select({ content: lecturesTable.content })\n      .from(lecturesTable)\n      .where(and(eq(lecturesTable.id, parseInt(id)), eq(lecturesTable.userId, userId)));\n    return lecture?.content;\n  }\n\n  async getWeakTopics(userId: string): Promise<string[]> {\n    const stats = await db.select().from(topicReviewStatsTable)\n      .where(and(eq(topicReviewStatsTable.userId, userId), lte(topicReviewStatsTable.lastScore, 70)))\n      .orderBy(topicReviewStatsTable.lastScore)\n      .limit(10);\n    return stats.map(s => s.topic);\n  }\n\n  async getCalendarSettings(userId: string): Promise<CalendarSettings | null> {\n    const [settings] = await db.select().from(calendarSettingsTable)\n      .where(eq(calendarSettingsTable.userId, userId))\n      .limit(1);\n    return settings ? dbCalendarSettingsToSettings(settings) : null;\n  }\n\n  async setCalendarSettings(userId: string, settings: CalendarSettings): Promise<CalendarSettings> {\n    await db.delete(calendarSettingsTable).where(eq(calendarSettingsTable.userId, userId));\n    const [inserted] = await db.insert(calendarSettingsTable).values({\n      userId,\n      url: settings.url,\n      lastSync: settings.lastSync,\n      lastSyncStatus: settings.lastSyncStatus,\n      lastSyncError: settings.lastSyncError,\n    }).returning();\n    return dbCalendarSettingsToSettings(inserted);\n  }\n\n  async clearCalendarSettings(userId: string): Promise<void> {\n    await db.delete(calendarSettingsTable).where(eq(calendarSettingsTable.userId, userId));\n    await db.delete(calendarEventsTable).where(eq(calendarEventsTable.userId, userId));\n  }\n\n  async getCalendarEvents(userId: string): Promise<CalendarEvent[]> {\n    const events = await db.select().from(calendarEventsTable)\n      .where(eq(calendarEventsTable.userId, userId));\n    return events.map(dbCalendarEventToEvent);\n  }\n\n  async setCalendarEvents(userId: string, events: CalendarEvent[]): Promise<CalendarEvent[]> {\n    await db.delete(calendarEventsTable).where(eq(calendarEventsTable.userId, userId));\n    const insertedEvents: CalendarEvent[] = [];\n    for (const event of events) {\n      const [inserted] = await db.insert(calendarEventsTable).values({\n        userId,\n        uid: event.uid,\n        title: event.title,\n        eventType: event.eventType,\n        startsAt: event.startsAt,\n        endsAt: event.endsAt,\n        location: event.location,\n        description: event.description,\n        matchedLectureId: event.matchedLectureId ? parseInt(event.matchedLectureId) : null,\n      }).returning();\n      insertedEvents.push(dbCalendarEventToEvent(inserted));\n    }\n    return insertedEvents;\n  }\n\n  async updateCalendarEventMatch(userId: string, eventId: string, lectureId: string | null): Promise<CalendarEvent | undefined> {\n    const [updated] = await db.update(calendarEventsTable)\n      .set({ matchedLectureId: lectureId ? parseInt(lectureId) : null })\n      .where(and(eq(calendarEventsTable.id, parseInt(eventId)), eq(calendarEventsTable.userId, userId)))\n      .returning();\n    return updated ? dbCalendarEventToEvent(updated) : undefined;\n  }\n\n  async getTopicReviewStats(userId: string): Promise<TopicReviewStats[]> {\n    const stats = await db.select().from(topicReviewStatsTable)\n      .where(eq(topicReviewStatsTable.userId, userId));\n    return stats.map(dbTopicStatsToTopicStats);\n  }\n\n  async getTopicReviewStat(userId: string, topic: string): Promise<TopicReviewStats | undefined> {\n    const [stat] = await db.select().from(topicReviewStatsTable)\n      .where(and(eq(topicReviewStatsTable.topic, topic), eq(topicReviewStatsTable.userId, userId)));\n    return stat ? dbTopicStatsToTopicStats(stat) : undefined;\n  }\n\n  async updateTopicReviewStats(userId: string, topic: string, lectureId: string, lectureTitle: string, score: number): Promise<TopicReviewStats> {\n    const existing = await this.getTopicReviewStat(userId, topic);\n    const today = new Date().toISOString().split('T')[0];\n    \n    if (existing) {\n      const wasSuccessful = score >= 70;\n      const newStreak = wasSuccessful ? existing.streak + 1 : 0;\n      \n      const { easeFactor, interval, nextDue } = calculateNextReview(\n        existing.easeFactor,\n        existing.interval,\n        score,\n        newStreak\n      );\n      \n      const [updated] = await db.update(topicReviewStatsTable)\n        .set({\n          lastReviewed: today,\n          lastScore: score,\n          reviewCount: existing.reviewCount + 1,\n          easeFactor,\n          interval,\n          nextDue,\n          streak: newStreak,\n        })\n        .where(and(eq(topicReviewStatsTable.topic, topic), eq(topicReviewStatsTable.userId, userId)))\n        .returning();\n      \n      return dbTopicStatsToTopicStats(updated);\n    } else {\n      const { easeFactor, interval, nextDue } = calculateNextReview(2.5, 1, score, 0);\n      \n      const [inserted] = await db.insert(topicReviewStatsTable).values({\n        userId,\n        topic,\n        lectureId: parseInt(lectureId),\n        lectureTitle,\n        lastReviewed: today,\n        lastScore: score,\n        reviewCount: 1,\n        easeFactor,\n        interval,\n        nextDue,\n        streak: score >= 70 ? 1 : 0,\n      }).returning();\n      \n      return dbTopicStatsToTopicStats(inserted);\n    }\n  }\n\n  async initializeTopicsFromLecture(userId: string, lectureId: string, topics: string[]): Promise<void> {\n    const lecture = await this.getLecture(userId, lectureId);\n    if (!lecture) return;\n    \n    const today = new Date().toISOString().split('T')[0];\n    \n    for (const topic of topics) {\n      const existing = await this.getTopicReviewStat(userId, topic);\n      if (!existing) {\n        await db.insert(topicReviewStatsTable).values({\n          userId,\n          topic,\n          lectureId: parseInt(lectureId),\n          lectureTitle: lecture.title,\n          lastReviewed: today,\n          lastScore: lecture.reviewScore,\n          reviewCount: 1,\n          easeFactor: 2.5,\n          interval: 1,\n          nextDue: today,\n          streak: lecture.reviewScore >= 70 ? 1 : 0,\n        });\n      }\n    }\n  }\n\n  async getDueTopics(userId: string, limit: number = 10): Promise<TopicReviewStats[]> {\n    const allStats = await this.getTopicReviewStats(userId);\n    const today = new Date();\n    \n    const scoredTopics = allStats\n      .map(stats => ({\n        stats,\n        priority: calculateTopicPriority(stats),\n        isDue: new Date(stats.nextDue) <= today,\n      }))\n      .filter(t => t.isDue || t.priority > 50)\n      .sort((a, b) => b.priority - a.priority);\n    \n    return scoredTopics.slice(0, limit).map(t => t.stats);\n  }\n\n  async getCurrentDailyQuizPlan(userId: string): Promise<DailyQuizPlan | null> {\n    const [plan] = await db.select().from(dailyQuizPlansTable)\n      .where(and(eq(dailyQuizPlansTable.completed, false), eq(dailyQuizPlansTable.userId, userId)))\n      .orderBy(desc(dailyQuizPlansTable.createdAt))\n      .limit(1);\n    return plan ? dbDailyQuizPlanToPlan(plan) : null;\n  }\n\n  async setCurrentDailyQuizPlan(userId: string, plan: DailyQuizPlan): Promise<DailyQuizPlan> {\n    await db.delete(dailyQuizPlansTable).where(and(eq(dailyQuizPlansTable.completed, false), eq(dailyQuizPlansTable.userId, userId)));\n    \n    const [inserted] = await db.insert(dailyQuizPlansTable).values({\n      userId,\n      generatedAt: plan.generatedAt,\n      topics: plan.topics,\n      lectureExcerpts: plan.lectureExcerpts,\n      completed: false,\n    }).returning();\n    \n    return dbDailyQuizPlanToPlan(inserted);\n  }\n\n  async completeDailyQuizPlan(userId: string, score: number): Promise<DailyQuizPlan | null> {\n    const currentPlan = await this.getCurrentDailyQuizPlan(userId);\n    if (!currentPlan) return null;\n    \n    const [updated] = await db.update(dailyQuizPlansTable)\n      .set({\n        completed: true,\n        completedAt: new Date().toISOString(),\n        score,\n      })\n      .where(and(eq(dailyQuizPlansTable.id, parseInt(currentPlan.id)), eq(dailyQuizPlansTable.userId, userId)))\n      .returning();\n    \n    return updated ? dbDailyQuizPlanToPlan(updated) : null;\n  }\n\n  async addReviewEvent(userId: string, eventData: Omit<ReviewEvent, \"id\">): Promise<ReviewEvent> {\n    const [inserted] = await db.insert(reviewEventsTable).values({\n      userId,\n      topicId: eventData.topicId,\n      topic: eventData.topic,\n      lectureId: parseInt(eventData.lectureId),\n      date: eventData.date,\n      score: eventData.score,\n      responseTime: eventData.responseTime,\n      wasCorrect: eventData.wasCorrect,\n    }).returning();\n    \n    return {\n      id: String(inserted.id),\n      topicId: inserted.topicId,\n      topic: inserted.topic,\n      lectureId: String(inserted.lectureId),\n      date: inserted.date,\n      score: inserted.score,\n      responseTime: inserted.responseTime || undefined,\n      wasCorrect: inserted.wasCorrect,\n    };\n  }\n\n  async getReviewHistory(userId: string, limit: number = 50): Promise<ReviewEvent[]> {\n    const events = await db.select().from(reviewEventsTable)\n      .where(eq(reviewEventsTable.userId, userId))\n      .orderBy(desc(reviewEventsTable.createdAt))\n      .limit(limit);\n    \n    return events.map(e => ({\n      id: String(e.id),\n      topicId: e.topicId,\n      topic: e.topic,\n      lectureId: String(e.lectureId),\n      date: e.date,\n      score: e.score,\n      responseTime: e.responseTime || undefined,\n      wasCorrect: e.wasCorrect,\n    }));\n  }\n\n  async getCachedQuestions(userId: string, topic: string, lectureId: string): Promise<Question[]> {\n    const questions = await db.select().from(cachedQuestionsTable)\n      .where(and(\n        eq(cachedQuestionsTable.topic, topic),\n        eq(cachedQuestionsTable.lectureId, parseInt(lectureId)),\n        eq(cachedQuestionsTable.userId, userId)\n      ))\n      .orderBy(cachedQuestionsTable.timesUsed)\n      .limit(5);\n    \n    return questions.map(q => ({\n      question: q.question,\n      options: q.options as string[],\n      correct: q.correct,\n      explanation: q.explanation,\n      topic: q.topic,\n    }));\n  }\n\n  async cacheQuestions(userId: string, topic: string, lectureId: string, questions: Question[]): Promise<void> {\n    const today = new Date().toISOString().split('T')[0];\n    \n    for (const q of questions) {\n      await db.insert(cachedQuestionsTable).values({\n        userId,\n        topic,\n        lectureId: parseInt(lectureId),\n        question: q.question,\n        options: q.options,\n        correct: q.correct,\n        explanation: q.explanation,\n        lastUsed: today,\n      });\n    }\n  }\n\n  async createBatchUpload(userId: string, batchId: string, items: { filename: string | null }[]): Promise<LectureUpload[]> {\n    const uploads: LectureUpload[] = [];\n    for (const item of items) {\n      const [inserted] = await db.insert(lectureUploadsTable).values({\n        userId,\n        batchId,\n        filename: item.filename,\n        status: \"pending\",\n      }).returning();\n      uploads.push(dbLectureUploadToUpload(inserted));\n    }\n    return uploads;\n  }\n\n  async updateBatchUploadStatus(userId: string, uploadId: string, status: \"pending\" | \"processing\" | \"completed\" | \"error\", lectureId?: string, error?: string): Promise<LectureUpload | undefined> {\n    const [updated] = await db.update(lectureUploadsTable)\n      .set({\n        status,\n        lectureId: lectureId ? parseInt(lectureId) : null,\n        error: error || null,\n      })\n      .where(and(eq(lectureUploadsTable.id, parseInt(uploadId)), eq(lectureUploadsTable.userId, userId)))\n      .returning();\n    return updated ? dbLectureUploadToUpload(updated) : undefined;\n  }\n\n  async getBatchUploads(userId: string, batchId: string): Promise<LectureUpload[]> {\n    const uploads = await db.select().from(lectureUploadsTable)\n      .where(and(eq(lectureUploadsTable.batchId, batchId), eq(lectureUploadsTable.userId, userId)));\n    return uploads.map(dbLectureUploadToUpload);\n  }\n\n  async getDismissedLectures(userId: string): Promise<DismissedLecture[]> {\n    const dismissed = await db.select().from(dismissedLecturesTable)\n      .where(eq(dismissedLecturesTable.userId, userId));\n    return dismissed.map(d => ({\n      id: String(d.id),\n      userId: d.userId,\n      calendarEventId: d.calendarEventId,\n      dismissedAt: d.dismissedAt?.toISOString() || new Date().toISOString(),\n      reason: d.reason || undefined,\n    }));\n  }\n\n  async dismissLecture(userId: string, calendarEventId: string, reason?: string): Promise<void> {\n    await db.insert(dismissedLecturesTable).values({\n      userId,\n      calendarEventId,\n      reason: reason || null,\n    });\n  }\n\n  async undismissLecture(userId: string, calendarEventId: string): Promise<void> {\n    await db.delete(dismissedLecturesTable)\n      .where(and(\n        eq(dismissedLecturesTable.userId, userId),\n        eq(dismissedLecturesTable.calendarEventId, calendarEventId)\n      ));\n  }\n\n  async getUserByUsername(username: string): Promise<User | undefined> {\n    const normalizedUsername = username.toLowerCase().trim();\n    const users = await db.select().from(usersTable);\n    const user = users.find(u => \n      (u.username && u.username.toLowerCase() === normalizedUsername) ||\n      (u.email && u.email.toLowerCase() === normalizedUsername)\n    );\n    return user;\n  }\n\n  async sendFriendRequest(userId: string, friendUsername: string): Promise<Friendship> {\n    const friendUser = await this.getUserByUsername(friendUsername);\n    if (!friendUser) {\n      throw new Error(\"User not found\");\n    }\n    \n    if (friendUser.id === userId) {\n      throw new Error(\"Cannot send friend request to yourself\");\n    }\n    \n    const existingFriendship = await db.select().from(friendshipsTable)\n      .where(or(\n        and(\n          eq(friendshipsTable.userId, userId),\n          eq(friendshipsTable.friendId, friendUser.id)\n        ),\n        and(\n          eq(friendshipsTable.userId, friendUser.id),\n          eq(friendshipsTable.friendId, userId)\n        )\n      ));\n    \n    if (existingFriendship.length > 0) {\n      const existing = existingFriendship[0];\n      if (existing.status === \"accepted\") {\n        throw new Error(\"Already friends with this user\");\n      }\n      if (existing.status === \"pending\") {\n        throw new Error(\"Friend request already pending\");\n      }\n    }\n    \n    const [inserted] = await db.insert(friendshipsTable).values({\n      userId,\n      friendId: friendUser.id,\n      status: \"pending\",\n    }).returning();\n    \n    return {\n      id: String(inserted.id),\n      userId: inserted.userId,\n      friendId: inserted.friendId,\n      status: inserted.status as \"pending\" | \"accepted\" | \"declined\",\n      createdAt: inserted.createdAt?.toISOString() || new Date().toISOString(),\n      acceptedAt: inserted.acceptedAt?.toISOString(),\n    };\n  }\n\n  async acceptFriendRequest(userId: string, requestId: string): Promise<void> {\n    const [request] = await db.select().from(friendshipsTable)\n      .where(and(\n        eq(friendshipsTable.id, parseInt(requestId)),\n        eq(friendshipsTable.friendId, userId),\n        eq(friendshipsTable.status, \"pending\")\n      ));\n    \n    if (!request) {\n      throw new Error(\"Friend request not found\");\n    }\n    \n    await db.update(friendshipsTable)\n      .set({\n        status: \"accepted\",\n        acceptedAt: new Date(),\n      })\n      .where(eq(friendshipsTable.id, parseInt(requestId)));\n  }\n\n  async declineFriendRequest(userId: string, requestId: string): Promise<void> {\n    const [request] = await db.select().from(friendshipsTable)\n      .where(and(\n        eq(friendshipsTable.id, parseInt(requestId)),\n        eq(friendshipsTable.friendId, userId),\n        eq(friendshipsTable.status, \"pending\")\n      ));\n    \n    if (!request) {\n      throw new Error(\"Friend request not found\");\n    }\n    \n    await db.update(friendshipsTable)\n      .set({\n        status: \"declined\",\n      })\n      .where(eq(friendshipsTable.id, parseInt(requestId)));\n  }\n\n  async removeFriend(userId: string, friendId: string): Promise<void> {\n    await db.delete(friendshipsTable)\n      .where(or(\n        and(\n          eq(friendshipsTable.userId, userId),\n          eq(friendshipsTable.friendId, friendId),\n          eq(friendshipsTable.status, \"accepted\")\n        ),\n        and(\n          eq(friendshipsTable.userId, friendId),\n          eq(friendshipsTable.friendId, userId),\n          eq(friendshipsTable.status, \"accepted\")\n        )\n      ));\n  }\n\n  async getFriends(userId: string): Promise<{friend: User, status: string}[]> {\n    const friendships = await db.select().from(friendshipsTable)\n      .where(or(\n        and(eq(friendshipsTable.userId, userId), eq(friendshipsTable.status, \"accepted\")),\n        and(eq(friendshipsTable.friendId, userId), eq(friendshipsTable.status, \"accepted\"))\n      ));\n    \n    const friends: {friend: User, status: string}[] = [];\n    \n    for (const f of friendships) {\n      const friendUserId = f.userId === userId ? f.friendId : f.userId;\n      const [friendUser] = await db.select().from(usersTable)\n        .where(eq(usersTable.id, friendUserId));\n      \n      if (friendUser) {\n        friends.push({\n          friend: friendUser,\n          status: f.status || \"accepted\",\n        });\n      }\n    }\n    \n    return friends;\n  }\n\n  async getPendingRequests(userId: string): Promise<{from: User, request: Friendship}[]> {\n    const requests = await db.select().from(friendshipsTable)\n      .where(and(\n        eq(friendshipsTable.friendId, userId),\n        eq(friendshipsTable.status, \"pending\")\n      ));\n    \n    const pendingRequests: {from: User, request: Friendship}[] = [];\n    \n    for (const r of requests) {\n      const [fromUser] = await db.select().from(usersTable)\n        .where(eq(usersTable.id, r.userId));\n      \n      if (fromUser) {\n        pendingRequests.push({\n          from: fromUser,\n          request: {\n            id: String(r.id),\n            userId: r.userId,\n            friendId: r.friendId,\n            status: r.status as \"pending\" | \"accepted\" | \"declined\",\n            createdAt: r.createdAt?.toISOString() || new Date().toISOString(),\n            acceptedAt: r.acceptedAt?.toISOString(),\n          },\n        });\n      }\n    }\n    \n    return pendingRequests;\n  }\n\n  private getWeekStart(): Date {\n    const now = new Date();\n    const dayOfWeek = now.getDay();\n    const diff = dayOfWeek === 0 ? 6 : dayOfWeek - 1;\n    const monday = new Date(now);\n    monday.setDate(now.getDate() - diff);\n    monday.setHours(0, 0, 0, 0);\n    return monday;\n  }\n\n  async getLeaderboard(userId: string): Promise<{user: User, weeklyXp: number, rank: number}[]> {\n    const weekStart = this.getWeekStart();\n    \n    const friends = await this.getFriends(userId);\n    const friendIds = friends.map(f => f.friend.id);\n    \n    const allUserIds = [userId, ...friendIds];\n    \n    const weeklyXpData = await db.select().from(weeklyXpLogsTable)\n      .where(and(\n        inArray(weeklyXpLogsTable.userId, allUserIds),\n        gte(weeklyXpLogsTable.weekStart, weekStart)\n      ));\n    \n    const xpMap = new Map<string, number>();\n    for (const log of weeklyXpData) {\n      xpMap.set(log.userId, (xpMap.get(log.userId) || 0) + (log.xpEarned || 0));\n    }\n    \n    const allUsers = await db.select().from(usersTable)\n      .where(inArray(usersTable.id, allUserIds));\n    \n    const leaderboard = allUsers.map(user => ({\n      user,\n      weeklyXp: xpMap.get(user.id) || 0,\n      rank: 0,\n    }));\n    \n    leaderboard.sort((a, b) => b.weeklyXp - a.weeklyXp);\n    \n    leaderboard.forEach((entry, index) => {\n      entry.rank = index + 1;\n    });\n    \n    return leaderboard;\n  }\n\n  async logXpEarned(userId: string, amount: number): Promise<void> {\n    if (amount <= 0) return;\n    \n    const weekStart = this.getWeekStart();\n    \n    const [existing] = await db.select().from(weeklyXpLogsTable)\n      .where(and(\n        eq(weeklyXpLogsTable.userId, userId),\n        eq(weeklyXpLogsTable.weekStart, weekStart)\n      ));\n    \n    if (existing) {\n      await db.update(weeklyXpLogsTable)\n        .set({\n          xpEarned: (existing.xpEarned || 0) + amount,\n          updatedAt: new Date(),\n        })\n        .where(eq(weeklyXpLogsTable.id, existing.id));\n    } else {\n      await db.insert(weeklyXpLogsTable).values({\n        userId,\n        weekStart,\n        xpEarned: amount,\n      });\n    }\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","path":null,"size_bytes":40417,"size_tokens":null},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","path":null,"size_bytes":4420,"size_tokens":null},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","path":null,"size_bytes":80,"size_tokens":null},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { createRequire } from \"module\";\nimport { promises as dns } from \"dns\";\nimport https from \"https\";\nimport Anthropic from \"@anthropic-ai/sdk\";\nimport { z } from \"zod\";\nimport { storage } from \"./storage\";\nimport { randomUUID } from \"crypto\";\nimport type { CalendarEvent, CalendarSettings } from \"@shared/schema\";\nimport { calendarSettingsSchema } from \"@shared/schema\";\nimport type { VEvent } from \"node-ical\";\nimport { setupAuth, isAuthenticated } from \"./replitAuth\";\n\nconst require = createRequire(import.meta.url);\nconst nodeIcalModule = require(\"node-ical\");\n\nasync function parsePdf(buffer: Buffer): Promise<{ text: string }> {\n  const pdfjsLib = await import(\"pdfjs-dist/legacy/build/pdf.mjs\");\n  \n  const data = new Uint8Array(buffer);\n  const pdf = await pdfjsLib.getDocument({ data }).promise;\n  \n  let fullText = \"\";\n  \n  for (let i = 1; i <= pdf.numPages; i++) {\n    const page = await pdf.getPage(i);\n    const textContent = await page.getTextContent();\n    \n    let lastY: number | null = null;\n    const lines: string[] = [];\n    let currentLine = \"\";\n    \n    for (const item of textContent.items) {\n      if (!('str' in item) || !item.str) continue;\n      \n      const itemAny = item as any;\n      const y = itemAny.transform ? itemAny.transform[5] : null;\n      \n      if (lastY !== null && y !== null && Math.abs(y - lastY) > 5) {\n        if (currentLine.trim()) {\n          lines.push(currentLine.trim());\n        }\n        currentLine = item.str;\n      } else {\n        currentLine += (currentLine ? \" \" : \"\") + item.str;\n      }\n      \n      lastY = y;\n    }\n    \n    if (currentLine.trim()) {\n      lines.push(currentLine.trim());\n    }\n    \n    fullText += lines.join(\"\\n\") + \"\\n\";\n  }\n  \n  return { text: fullText };\n}\n\nconst anthropic = new Anthropic({\n  apiKey: process.env.ANTHROPIC_API_KEY,\n});\n\nconst DEFAULT_MODEL = \"claude-sonnet-4-20250514\";\n\nconst generateQuizRequestSchema = z.object({\n  content: z.string().min(50, \"Lecture content must be at least 50 characters\").optional(),\n  lectureId: z.string().optional(),\n  title: z.string().optional(),\n}).refine(\n  (data) => data.content || data.lectureId,\n  { message: \"Either content or lectureId must be provided\" }\n);\n\nconst generateDailyQuizRequestSchema = z.object({\n  weakTopics: z.array(z.string()),\n  previousScore: z.number(),\n  confidenceLevel: z.number().min(1).max(5),\n});\n\nconst achievementSchema = z.object({\n  id: z.string(),\n  name: z.string(),\n  description: z.string(),\n  icon: z.string(),\n  unlocked: z.boolean(),\n  unlockedDate: z.string().optional(),\n  progress: z.number().optional(),\n  maxProgress: z.number().optional(),\n});\n\nconst powerUpsSchema = z.object({\n  secondChance: z.number().min(0),\n  hints: z.number().min(0),\n  doubleXP: z.boolean(),\n});\n\nconst updateProfileSchema = z.object({\n  level: z.number().min(1).optional(),\n  totalXP: z.number().min(0).optional(),\n  xpToNextLevel: z.number().min(0).optional(),\n  currentStreak: z.number().min(0).optional(),\n  longestStreak: z.number().min(0).optional(),\n  totalLectures: z.number().min(0).optional(),\n  averageConfidence: z.number().min(0).max(5).optional(),\n  achievements: z.array(achievementSchema).optional(),\n  masteredTopics: z.array(z.string()).optional(),\n  needsPractice: z.array(z.string()).optional(),\n  powerUps: powerUpsSchema.optional(),\n  lastActivityDate: z.string().optional(),\n}).strict();\n\nconst addLectureSchema = z.object({\n  title: z.string(),\n  date: z.string(),\n  content: z.string(),\n  reviewScore: z.number(),\n  xpEarned: z.number(),\n  incorrectTopics: z.array(z.string()),\n  confidenceRating: z.number(),\n  dailyQuizzes: z.array(z.object({\n    date: z.string(),\n    score: z.number(),\n    xpEarned: z.number(),\n    improvement: z.number(),\n  })),\n  needsReview: z.boolean(),\n  lastReviewed: z.string().optional(),\n});\n\nconst transferableSkillSchema = z.object({\n  name: z.string(),\n  description: z.string(),\n  category: z.enum([\"cognitive\", \"technical\", \"communication\", \"interpersonal\", \"organizational\"]),\n  relevantCareers: z.array(z.string()),\n  proficiencyLevel: z.enum([\"developing\", \"intermediate\", \"proficient\"]),\n});\n\nconst updateLectureSchema = z.object({\n  title: z.string().optional(),\n  reviewScore: z.number().optional(),\n  xpEarned: z.number().optional(),\n  incorrectTopics: z.array(z.string()).optional(),\n  confidenceRating: z.number().optional(),\n  needsReview: z.boolean().optional(),\n  lastReviewed: z.string().optional(),\n  identifiedSkills: z.array(transferableSkillSchema).optional(),\n  questionsAnswered: z.number().optional(),\n});\n\nfunction cleanJsonResponse(text: string): string {\n  return text\n    .replace(/```json\\n?/g, \"\")\n    .replace(/```\\n?/g, \"\")\n    .trim();\n}\n\nfunction classifyEventType(summary: string, description?: string): \"lecture\" | \"workshop\" | \"tutorial\" | \"exam\" | \"other\" {\n  const text = `${summary} ${description || \"\"}`.toLowerCase();\n  \n  if (text.includes(\"quiz\") || text.includes(\"exam\") || text.includes(\"test\") || text.includes(\"assessment\")) return \"exam\";\n  if (text.includes(\"workshop\")) return \"workshop\";\n  if (text.includes(\"tutorial\") || text.includes(\"seminar\")) return \"tutorial\";\n  if (text.includes(\"lab\") || text.includes(\"practical\")) return \"other\";\n  if (text.includes(\"lecture\") || text.includes(\"lec\")) return \"lecture\";\n  \n  const examPatterns = /\\b(quiz|exam|test|midterm|final|assessment)\\b/i;\n  const workshopPatterns = /\\b(wkshp|works?hop)\\b/i;\n  const tutorialPatterns = /\\b(tut|tutorial|sem|seminar)\\b/i;\n  \n  if (examPatterns.test(text)) return \"exam\";\n  if (workshopPatterns.test(text)) return \"workshop\";\n  if (tutorialPatterns.test(text)) return \"tutorial\";\n  \n  return \"lecture\";\n}\n\nfunction isPrivateIP(ip: string): boolean {\n  const ipv4Private = [\n    /^127\\./,\n    /^10\\./,\n    /^172\\.(1[6-9]|2\\d|3[01])\\./,\n    /^192\\.168\\./,\n    /^169\\.254\\./,\n    /^0\\./,\n    /^100\\.(6[4-9]|[7-9]\\d|1[01]\\d|12[0-7])\\./,\n    /^192\\.0\\.0\\./,\n    /^192\\.0\\.2\\./,\n    /^198\\.18\\./,\n    /^198\\.19\\./,\n    /^198\\.51\\.100\\./,\n    /^203\\.0\\.113\\./,\n    /^22[4-9]\\./,\n    /^23\\d\\./,\n    /^24\\d\\./,\n    /^25[0-5]\\./,\n  ];\n  \n  const ipv6Private = [\n    /^::1$/i,\n    /^::$/,\n    /^fc00:/i,\n    /^fd00:/i,\n    /^fe80:/i,\n    /^ff/i,\n    /^::ffff:127\\./i,\n    /^::ffff:10\\./i,\n    /^::ffff:172\\.(1[6-9]|2\\d|3[01])\\./i,\n    /^::ffff:192\\.168\\./i,\n    /^::ffff:169\\.254\\./i,\n    /^::ffff:0\\./i,\n    /^::ffff:100\\.(6[4-9]|[7-9]\\d|1[01]\\d|12[0-7])\\./i,\n    /^::ffff:192\\.0\\.0\\./i,\n    /^::ffff:192\\.0\\.2\\./i,\n    /^::ffff:198\\.18\\./i,\n    /^::ffff:198\\.19\\./i,\n    /^::ffff:198\\.51\\.100\\./i,\n    /^::ffff:203\\.0\\.113\\./i,\n    /^::ffff:22[4-9]\\./i,\n    /^::ffff:23\\d\\./i,\n    /^::ffff:24\\d\\./i,\n    /^::ffff:25[0-5]\\./i,\n  ];\n  \n  return ipv4Private.some(p => p.test(ip)) || ipv6Private.some(p => p.test(ip));\n}\n\nfunction validateCalendarUrlBasic(urlString: string): { valid: boolean; error?: string } {\n  try {\n    const url = new URL(urlString);\n    \n    if (url.protocol !== \"https:\") {\n      return { valid: false, error: \"Only HTTPS URLs are allowed for security\" };\n    }\n    \n    if (url.username || url.password) {\n      return { valid: false, error: \"URLs with credentials are not allowed\" };\n    }\n    \n    const pathname = url.pathname.toLowerCase();\n    const fullUrl = urlString.toLowerCase();\n    const isIcsFile = pathname.includes(\".ics\") || fullUrl.includes(\".ics\");\n    const isIcalEndpoint = pathname.includes(\"/ical\") || pathname.includes(\"/calendar\");\n    if (!isIcsFile && !isIcalEndpoint) {\n      return { valid: false, error: \"URL must be an ICS calendar feed\" };\n    }\n    \n    const hostname = url.hostname.toLowerCase();\n    \n    const blockedHosts = [\"localhost\", \"127.0.0.1\", \"0.0.0.0\", \"[::1]\", \"internal\", \"intranet\", \"local\"];\n    if (blockedHosts.some(h => hostname === h || hostname.endsWith(\".\" + h))) {\n      return { valid: false, error: \"Internal addresses are not allowed\" };\n    }\n    \n    if (hostname.endsWith(\".local\") || hostname.endsWith(\".internal\") || hostname.endsWith(\".localhost\")) {\n      return { valid: false, error: \"Local domain suffixes are not allowed\" };\n    }\n    \n    if (/^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$/.test(hostname)) {\n      return { valid: false, error: \"Direct IP addresses are not allowed. Please use a domain name.\" };\n    }\n    \n    if (/^\\[.*\\]$/.test(hostname)) {\n      return { valid: false, error: \"IPv6 addresses are not allowed. Please use a domain name.\" };\n    }\n    \n    const suspiciousDomains = [\".nip.io\", \".sslip.io\", \".xip.io\", \".localtest.me\"];\n    if (suspiciousDomains.some(d => hostname.endsWith(d))) {\n      return { valid: false, error: \"This domain type is not allowed\" };\n    }\n    \n    return { valid: true };\n  } catch {\n    return { valid: false, error: \"Invalid URL format\" };\n  }\n}\n\nasync function validateCalendarUrlWithDns(urlString: string): Promise<{ valid: boolean; error?: string }> {\n  const basicValidation = validateCalendarUrlBasic(urlString);\n  if (!basicValidation.valid) {\n    return basicValidation;\n  }\n  \n  try {\n    const url = new URL(urlString);\n    const hostname = url.hostname;\n    \n    const addresses = await dns.lookup(hostname, { all: true });\n    \n    for (const addr of addresses) {\n      if (isPrivateIP(addr.address)) {\n        return { valid: false, error: \"Calendar URL resolves to a private network address\" };\n      }\n    }\n    \n    return { valid: true };\n  } catch (error: any) {\n    if (error.code === \"ENOTFOUND\" || error.code === \"ENODATA\") {\n      return { valid: false, error: \"Could not resolve calendar domain name\" };\n    }\n    return { valid: false, error: \"Failed to validate calendar URL\" };\n  }\n}\n\nasync function validateAndResolveUrl(urlString: string): Promise<{ valid: boolean; error?: string; address?: string; family?: number }> {\n  const basicValidation = validateCalendarUrlBasic(urlString);\n  if (!basicValidation.valid) {\n    return basicValidation;\n  }\n  \n  try {\n    const url = new URL(urlString);\n    const hostname = url.hostname;\n    \n    const addresses = await dns.lookup(hostname, { all: true });\n    \n    for (const addr of addresses) {\n      if (!isPrivateIP(addr.address)) {\n        return { valid: true, address: addr.address, family: addr.family };\n      }\n    }\n    \n    return { valid: false, error: \"All resolved IPs are private/reserved\" };\n  } catch (error: any) {\n    if (error.code === \"ENOTFOUND\" || error.code === \"ENODATA\") {\n      return { valid: false, error: \"Could not resolve calendar domain name\" };\n    }\n    return { valid: false, error: \"Failed to validate calendar URL\" };\n  }\n}\n\nasync function safeFetchIcsContent(urlString: string, maxRedirects = 5): Promise<{ content: string; error?: string }> {\n  let currentUrl = urlString;\n  let redirectCount = 0;\n  \n  while (redirectCount < maxRedirects) {\n    const validation = await validateAndResolveUrl(currentUrl);\n    if (!validation.valid) {\n      return { content: \"\", error: validation.error };\n    }\n    \n    const validatedAddress = validation.address!;\n    const validatedFamily = validation.family!;\n    \n    const result = await new Promise<{ content: string; redirect?: string; error?: string }>((resolve) => {\n      const url = new URL(currentUrl);\n      \n      const customLookup: typeof dns.lookup = (\n        _hostname: string,\n        options: any,\n        callback: (err: NodeJS.ErrnoException | null, address: string | dns.LookupAddress[], family?: number) => void\n      ) => {\n        if (typeof options === \"function\") {\n          callback = options;\n          options = {};\n        }\n        if (options && options.all) {\n          callback(null, [{ address: validatedAddress, family: validatedFamily }]);\n        } else {\n          callback(null, validatedAddress, validatedFamily);\n        }\n      };\n      \n      const options: https.RequestOptions = {\n        hostname: url.hostname,\n        port: url.port || 443,\n        path: url.pathname + url.search,\n        method: \"GET\",\n        headers: {\n          \"User-Agent\": \"LectureQuest/1.0\",\n          \"Accept\": \"text/calendar, */*\",\n        },\n        timeout: 30000,\n        lookup: customLookup as any,\n      };\n      \n      const req = https.request(options, (res) => {\n        if (res.statusCode && res.statusCode >= 300 && res.statusCode < 400 && res.headers.location) {\n          resolve({ content: \"\", redirect: res.headers.location });\n          return;\n        }\n        \n        if (res.statusCode && res.statusCode >= 400) {\n          resolve({ content: \"\", error: `HTTP error: ${res.statusCode}` });\n          return;\n        }\n        \n        const chunks: Buffer[] = [];\n        res.on(\"data\", (chunk) => chunks.push(chunk));\n        res.on(\"end\", () => {\n          const content = Buffer.concat(chunks).toString(\"utf-8\");\n          resolve({ content });\n        });\n        res.on(\"error\", (err) => resolve({ content: \"\", error: err.message }));\n      });\n      \n      req.on(\"error\", (err) => resolve({ content: \"\", error: err.message }));\n      req.on(\"timeout\", () => {\n        req.destroy();\n        resolve({ content: \"\", error: \"Request timeout\" });\n      });\n      \n      req.end();\n    });\n    \n    if (result.error) {\n      return { content: \"\", error: result.error };\n    }\n    \n    if (result.redirect) {\n      const absoluteUrl = new URL(result.redirect, currentUrl).toString();\n      currentUrl = absoluteUrl;\n      redirectCount++;\n      continue;\n    }\n    \n    return { content: result.content };\n  }\n  \n  return { content: \"\", error: \"Too many redirects\" };\n}\n\nasync function fetchAndParseCalendar(url: string): Promise<{ events: CalendarEvent[]; error?: string }> {\n  try {\n    const { content, error: fetchError } = await safeFetchIcsContent(url);\n    if (fetchError) {\n      return { events: [], error: fetchError };\n    }\n    \n    const events = nodeIcalModule.parseICS(content);\n    const calendarEvents: CalendarEvent[] = [];\n    \n    for (const [key, event] of Object.entries(events)) {\n      const eventAny = event as any;\n      if (eventAny.type !== \"VEVENT\") continue;\n      \n      const vevent = event as VEvent;\n      const summary = vevent.summary || \"Untitled Event\";\n      const description = vevent.description || \"\";\n      \n      const eventType = classifyEventType(summary, description);\n      \n      const startDate = vevent.start;\n      const endDate = vevent.end;\n      \n      if (!startDate) continue;\n      \n      const calEvent: CalendarEvent = {\n        id: randomUUID(),\n        uid: vevent.uid || key,\n        title: summary,\n        eventType,\n        startsAt: startDate instanceof Date ? startDate.toISOString() : String(startDate),\n        endsAt: endDate instanceof Date ? endDate.toISOString() : (startDate instanceof Date ? startDate.toISOString() : String(startDate)),\n        location: vevent.location,\n        description: description.substring(0, 500),\n      };\n      \n      calendarEvents.push(calEvent);\n    }\n    \n    calendarEvents.sort((a, b) => new Date(a.startsAt).getTime() - new Date(b.startsAt).getTime());\n    \n    return { events: calendarEvents };\n  } catch (error: any) {\n    console.error(\"Calendar fetch error:\", error);\n    return { events: [], error: error.message || \"Failed to fetch calendar\" };\n  }\n}\n\nfunction extractTitleFromText(text: string): string | null {\n  const lines = text.split(/[\\n\\r]+/).map(line => line.trim()).filter(line => line.length > 0);\n  \n  let subjectTitle: string | null = null;\n  const fallbackCandidates: string[] = [];\n  \n  for (let i = 0; i < Math.min(30, lines.length); i++) {\n    const line = lines[i];\n    const lowerLine = line.toLowerCase();\n    \n    if (line.startsWith(\"#\")) {\n      const title = line.replace(/^#+\\s*/, \"\").trim();\n      if (title.length >= 5 && title.length <= 80) {\n        return title;\n      }\n    }\n    \n    if (\n      lowerLine.includes(\"\") ||\n      lowerLine.includes(\"copyright\") ||\n      lowerLine.includes(\"all rights reserved\") ||\n      lowerLine.includes(\"confidential\") ||\n      lowerLine.includes(\"cisco\") ||\n      /^\\d+$/.test(lowerLine) ||\n      /^page\\s+\\d+/.test(lowerLine) ||\n      line.length < 5 ||\n      line.length > 80\n    ) {\n      continue;\n    }\n    \n    if (\n      lowerLine.includes(\"objective\") ||\n      lowerLine.includes(\"description\") ||\n      lowerLine.includes(\"topic title\") ||\n      lowerLine.includes(\"topic objective\") ||\n      lowerLine.startsWith(\"module title:\") ||\n      lowerLine.startsWith(\"chapter title:\") ||\n      lowerLine.startsWith(\"lecture title:\")\n    ) {\n      continue;\n    }\n    \n    const moduleMatch = line.match(/^(?:Module|Chapter|Unit|Lecture)\\s+\\d+\\s*[:\\-]\\s*(.+)/i);\n    if (moduleMatch && moduleMatch[1]) {\n      const extracted = moduleMatch[1].trim();\n      if (extracted.length >= 5 && extracted.length <= 80) {\n        subjectTitle = extracted;\n        continue;\n      }\n    }\n    \n    if (!subjectTitle && line.length >= 8 && line.length <= 60) {\n      if (!lowerLine.includes(\":\") && !lowerLine.match(/^[\\d.]+\\s/)) {\n        fallbackCandidates.push(line);\n      }\n    }\n  }\n  \n  if (subjectTitle) {\n    return subjectTitle;\n  }\n  \n  if (fallbackCandidates.length > 0) {\n    return fallbackCandidates[0];\n  }\n  \n  return null;\n}\n\nexport async function registerRoutes(\n  httpServer: Server,\n  app: Express\n): Promise<Server> {\n  \n  await setupAuth(app);\n\n  app.get('/api/auth/user', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      res.json(user);\n    } catch (error) {\n      console.error(\"Error fetching user:\", error);\n      res.status(500).json({ message: \"Failed to fetch user\" });\n    }\n  });\n\n  app.post(\"/api/generate-quiz\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const parsed = generateQuizRequestSchema.safeParse(req.body);\n      if (!parsed.success) {\n        return res.status(400).json({ \n          error: \"Invalid request\", \n          details: parsed.error.issues \n        });\n      }\n\n      const { content: providedContent, lectureId, title } = parsed.data;\n\n      let content = providedContent;\n      \n      if (lectureId && !content) {\n        const lectureContent = await storage.getLectureContent(userId, lectureId);\n        if (!lectureContent) {\n          return res.status(404).json({\n            error: \"Lecture not found\",\n            message: `No lecture content found for lectureId: ${lectureId}`\n          });\n        }\n        content = lectureContent;\n      }\n\n      if (!content) {\n        return res.status(400).json({\n          error: \"No content available\",\n          message: \"Either provide content directly or a valid lectureId\"\n        });\n      }\n\n      const prompt = `Analyze this lecture content and generate a quiz with transferable skills identification.\n\nLECTURE CONTENT:\n${content}\n\nReturn ONLY valid JSON in this exact format:\n{\n  \"questions\": [\n    {\n      \"question\": \"string\",\n      \"options\": [\"string\", \"string\", \"string\", \"string\"],\n      \"correct\": number (0-3),\n      \"explanation\": \"string\",\n      \"topic\": \"string (specific concept being tested)\"\n    }\n  ],\n  \"skills\": [\n    {\n      \"name\": \"string (e.g. 'Analytical Thinking', 'Problem Solving', 'Systems Design')\",\n      \"description\": \"string (1 sentence explaining how this lecture develops this skill)\",\n      \"category\": \"cognitive|technical|communication|interpersonal|organizational\",\n      \"relevantCareers\": [\"string\", \"string\", \"string\"]\n    }\n  ]\n}\n\nRequirements:\n- Generate exactly 10 questions\n- Each question must have exactly 4 options\n- \"correct\" must be an index from 0 to 3\n- Questions should test understanding, not just memorization\n- The \"topic\" field must be a specific, descriptive concept name (not generic words)\n- Identify 3-5 transferable skills that students develop by mastering this content\n- Skills should be career-relevant (e.g., \"Critical Analysis\", \"Data Interpretation\", \"Logical Reasoning\", \"Technical Communication\")\n- Map each skill to 2-3 relevant career paths\n- DO NOT include any text outside the JSON object`;\n\n      const message = await anthropic.messages.create({\n        model: DEFAULT_MODEL,\n        max_tokens: 2048,\n        messages: [{ role: \"user\", content: prompt }],\n      });\n\n      const responseText = message.content[0].type === \"text\" \n        ? message.content[0].text \n        : \"\";\n      \n      const cleanedResponse = cleanJsonResponse(responseText);\n      \n      let quizResponse;\n      try {\n        quizResponse = JSON.parse(cleanedResponse);\n      } catch (parseError) {\n        console.error(\"Failed to parse quiz response:\", cleanedResponse);\n        return res.status(500).json({ \n          error: \"Failed to generate quiz. Please try again.\",\n          details: \"Invalid JSON response from AI\"\n        });\n      }\n\n      // Handle both old array format and new object format\n      const questions = Array.isArray(quizResponse) ? quizResponse : quizResponse.questions;\n      const skills = Array.isArray(quizResponse) ? [] : (quizResponse.skills || []);\n\n      if (!Array.isArray(questions) || questions.length === 0) {\n        return res.status(500).json({ \n          error: \"Failed to generate quiz questions. Please try again.\" \n        });\n      }\n\n      const validatedQuestions = questions.map((q: any, index: number) => ({\n        question: String(q.question || `Question ${index + 1}`),\n        options: Array.isArray(q.options) && q.options.length === 4 \n          ? q.options.map(String) \n          : [\"Option A\", \"Option B\", \"Option C\", \"Option D\"],\n        correct: typeof q.correct === \"number\" && q.correct >= 0 && q.correct <= 3 \n          ? q.correct \n          : 0,\n        explanation: String(q.explanation || \"Great attempt! Keep learning.\"),\n        topic: String(q.topic || \"General Concept\"),\n      }));\n\n      const validatedSkills = skills.map((s: any) => ({\n        name: String(s.name || \"General Skill\"),\n        description: String(s.description || \"Developed through this lecture\"),\n        category: [\"cognitive\", \"technical\", \"communication\", \"interpersonal\", \"organizational\"].includes(s.category) \n          ? s.category \n          : \"cognitive\",\n        relevantCareers: Array.isArray(s.relevantCareers) \n          ? s.relevantCareers.map(String).slice(0, 5)\n          : [\"Various Industries\"],\n        proficiencyLevel: \"developing\" as const,\n      }));\n\n      res.json({ \n        questions: validatedQuestions,\n        skills: validatedSkills,\n        title: title || \"Lecture Review\"\n      });\n\n    } catch (error: any) {\n      console.error(\"Quiz generation error:\", error);\n      \n      if (error.status === 401) {\n        return res.status(500).json({ \n          error: \"API configuration error. Please check your settings.\" \n        });\n      }\n      \n      if (error.status === 429) {\n        return res.status(429).json({ \n          error: \"Too many requests. Please wait a moment and try again.\" \n        });\n      }\n\n      res.status(500).json({ \n        error: \"Failed to generate quiz. Please try again.\",\n        details: error.message \n      });\n    }\n  });\n\n  // Get daily quiz status - shows due topics using active recall algorithm\n  app.get(\"/api/daily-quiz/status\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const dueTopics = await storage.getDueTopics(userId, 10);\n      const currentPlan = await storage.getCurrentDailyQuizPlan(userId);\n      const lectures = await storage.getLectures(userId);\n      const profile = await storage.getUserProfile(userId);\n      \n      // Get topic count from all lectures\n      const allTopics = new Set<string>();\n      lectures.forEach(lecture => {\n        lecture.incorrectTopics.forEach(topic => allTopics.add(topic));\n      });\n      \n      // Determine reason for each topic\n      const topicsWithReasons = dueTopics.map(t => {\n        const daysSinceReview = Math.floor((new Date().getTime() - new Date(t.lastReviewed).getTime()) / (1000 * 60 * 60 * 24));\n        const isOverdue = new Date(t.nextDue) < new Date();\n        const isWeak = t.lastScore < 70;\n        const isNew = t.reviewCount <= 1;\n        \n        let reason: \"overdue\" | \"weak\" | \"new\" | \"due\" = \"due\";\n        if (isOverdue) reason = \"overdue\";\n        else if (isWeak) reason = \"weak\";\n        else if (isNew) reason = \"new\";\n        \n        return {\n          topic: t.topic,\n          lectureTitle: t.lectureTitle,\n          lastScore: t.lastScore,\n          daysSinceReview,\n          streak: t.streak,\n          isOverdue,\n          reason,\n          reviewCount: t.reviewCount,\n        };\n      });\n      \n      res.json({\n        hasDueTopics: dueTopics.length > 0,\n        dueTopicsCount: dueTopics.length,\n        totalTopicsTracked: allTopics.size,\n        dueTopics: topicsWithReasons,\n        currentPlan: currentPlan ? {\n          id: currentPlan.id,\n          topicsCount: currentPlan.topics.length,\n          generatedAt: currentPlan.generatedAt,\n          completed: currentPlan.completed,\n          topics: currentPlan.topics.map(t => ({\n            topic: t.topic,\n            lectureTitle: t.lectureTitle,\n            reason: t.reason,\n          })),\n        } : null,\n        weeklyStreak: profile.currentStreak,\n      });\n    } catch (error: any) {\n      console.error(\"Daily quiz status error:\", error);\n      res.status(500).json({ error: \"Failed to get daily quiz status\" });\n    }\n  });\n\n  // Generate daily quiz using server-side active recall topic selection\n  app.post(\"/api/generate-daily-quiz\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      // Get due topics from spaced repetition algorithm\n      const dueTopics = await storage.getDueTopics(userId, 10);\n      const lectures = await storage.getLectures(userId);\n      const profile = await storage.getUserProfile(userId);\n      \n      // If no tracked topics yet, use weak topics from lectures\n      let topicsToReview: { topic: string; lectureId: string; lectureTitle: string; priority: number; reason: \"due\" | \"weak\" | \"overdue\" | \"new\"; daysSinceReview: number }[] = [];\n      \n      if (dueTopics.length > 0) {\n        // Use spaced repetition algorithm results\n        const today = new Date();\n        topicsToReview = dueTopics.map(t => {\n          const nextDue = new Date(t.nextDue);\n          const daysSinceDue = Math.floor((today.getTime() - nextDue.getTime()) / (1000 * 60 * 60 * 24));\n          const daysSinceReview = Math.floor((today.getTime() - new Date(t.lastReviewed).getTime()) / (1000 * 60 * 60 * 24));\n          \n          let reason: \"due\" | \"weak\" | \"overdue\" | \"new\" = \"due\";\n          if (daysSinceDue > 3) reason = \"overdue\";\n          else if (t.lastScore < 70) reason = \"weak\";\n          else if (t.reviewCount <= 1) reason = \"new\";\n          \n          return {\n            topic: t.topic,\n            lectureId: t.lectureId,\n            lectureTitle: t.lectureTitle,\n            priority: t.lastScore < 70 ? 100 - t.lastScore : 50 + daysSinceDue * 5,\n            reason,\n            daysSinceReview,\n          };\n        });\n      } else {\n        // Fallback: Use incorrect topics from lectures for first-time users\n        const weakTopicsSet = new Map<string, { lectureId: string; lectureTitle: string; score: number }>();\n        \n        lectures.forEach(lecture => {\n          lecture.incorrectTopics.forEach(topic => {\n            if (!weakTopicsSet.has(topic) || weakTopicsSet.get(topic)!.score > lecture.reviewScore) {\n              weakTopicsSet.set(topic, {\n                lectureId: lecture.id,\n                lectureTitle: lecture.title,\n                score: lecture.reviewScore,\n              });\n            }\n          });\n        });\n        \n        topicsToReview = Array.from(weakTopicsSet.entries()).map(([topic, data]) => ({\n          topic,\n          lectureId: data.lectureId,\n          lectureTitle: data.lectureTitle,\n          priority: 100 - data.score,\n          reason: \"weak\" as const,\n          daysSinceReview: 0,\n        }));\n      }\n      \n      if (topicsToReview.length === 0) {\n        return res.status(400).json({\n          error: \"No topics to review\",\n          message: \"Complete some lecture quizzes first to build your review schedule.\"\n        });\n      }\n      \n      // Sort by priority and take top topics\n      topicsToReview.sort((a, b) => b.priority - a.priority);\n      const selectedTopics = topicsToReview.slice(0, 10);\n      \n      // Get full lecture content for context (use actual content from database)\n      const lectureExcerpts: { lectureId: string; excerpt: string }[] = [];\n      const seenLectures = new Set<string>();\n      for (const t of selectedTopics) {\n        if (!seenLectures.has(t.lectureId)) {\n          const lectureContent = await storage.getLectureContent(userId, t.lectureId);\n          const lecture = lectures.find(l => l.id === t.lectureId);\n          if (lecture && lectureContent) {\n            lectureExcerpts.push({\n              lectureId: t.lectureId,\n              excerpt: lectureContent.substring(0, 2000) + (lectureContent.length > 2000 ? \"...\" : \"\"),\n            });\n            seenLectures.add(t.lectureId);\n          }\n        }\n      }\n      \n      // Build prompt with active recall focus\n      const topicsList = selectedTopics.map(t => {\n        const reasonText = t.reason === \"overdue\" ? \"(overdue)\" :\n                          t.reason === \"weak\" ? \"(needs practice)\" :\n                          t.reason === \"new\" ? \"(recently learned)\" : \"\";\n        return `- ${t.topic} from \"${t.lectureTitle}\" ${reasonText}`;\n      }).join(\"\\n\");\n      \n      const excerptContext = lectureExcerpts.map(e => {\n        const lecture = lectures.find(l => l.id === e.lectureId);\n        return `Lecture: ${lecture?.title || \"Unknown\"}\\nContent: ${e.excerpt}`;\n      }).join(\"\\n\\n\");\n\n      const prompt = `Generate exactly 10 targeted multiple-choice questions using active recall principles for these topics that need review:\n\n${topicsList}\n\nContext from the student's lectures:\n${excerptContext}\n\nStudent Progress:\n- Current streak: ${profile.currentStreak} days\n- Average confidence: ${profile.averageConfidence.toFixed(1)}/5\n\nActive Recall Instructions:\n1. Questions should test RETRIEVAL of knowledge, not recognition\n2. Include questions that require connecting concepts across topics\n3. Use varied question formats (application, analysis, comparison)\n4. Focus on the \"why\" and \"how\" not just the \"what\"\n5. Include some questions that require recalling specific details\n6. Base questions on the actual lecture content provided above\n\nReturn ONLY valid JSON in this exact format:\n[\n  {\n    \"question\": \"string\",\n    \"options\": [\"string\", \"string\", \"string\", \"string\"],\n    \"correct\": number (0-3),\n    \"explanation\": \"string\",\n    \"topic\": \"string (which topic this tests)\"\n  }\n]\n\nImportant:\n- Generate exactly 10 questions\n- Each question must have exactly 4 options\n- \"correct\" must be an index from 0 to 3\n- Explanations should reinforce learning and encourage spaced repetition\n- Include the topic field to track which topic each question tests\n- DO NOT include any text outside the JSON array`;\n\n      const message = await anthropic.messages.create({\n        model: DEFAULT_MODEL,\n        max_tokens: 2048,\n        messages: [{ role: \"user\", content: prompt }],\n      });\n\n      const responseText = message.content[0].type === \"text\" \n        ? message.content[0].text \n        : \"\";\n      \n      const cleanedResponse = cleanJsonResponse(responseText);\n      \n      let questions;\n      try {\n        questions = JSON.parse(cleanedResponse);\n      } catch (parseError) {\n        console.error(\"Failed to parse daily quiz response:\", cleanedResponse);\n        return res.status(500).json({ \n          error: \"Failed to generate daily quiz. Please try again.\",\n          details: \"Invalid JSON response from AI\"\n        });\n      }\n\n      if (!Array.isArray(questions) || questions.length === 0) {\n        return res.status(500).json({ \n          error: \"Failed to generate quiz questions. Please try again.\" \n        });\n      }\n\n      const validatedQuestions = questions.map((q: any, index: number) => ({\n        question: String(q.question || `Question ${index + 1}`),\n        options: Array.isArray(q.options) && q.options.length === 4 \n          ? q.options.map(String) \n          : [\"Option A\", \"Option B\", \"Option C\", \"Option D\"],\n        correct: typeof q.correct === \"number\" && q.correct >= 0 && q.correct <= 3 \n          ? q.correct \n          : 0,\n        explanation: String(q.explanation || \"Keep practicing! You're making progress.\"),\n        topic: String(q.topic || selectedTopics[index % selectedTopics.length]?.topic || \"General\"),\n      }));\n\n      // Create and store the daily quiz plan\n      const planId = `plan-${Date.now()}`;\n      const plan = await storage.setCurrentDailyQuizPlan(userId, {\n        id: planId,\n        generatedAt: new Date().toISOString(),\n        topics: selectedTopics,\n        lectureExcerpts,\n        completed: false,\n      });\n\n      res.json({ \n        questions: validatedQuestions,\n        planId: plan.id,\n        focusTopics: selectedTopics.map(t => ({\n          topic: t.topic,\n          lectureTitle: t.lectureTitle,\n          reason: t.reason,\n          daysSinceReview: t.daysSinceReview,\n        })),\n        spacedRepetitionInfo: {\n          totalDueTopics: dueTopics.length,\n          selectedCount: selectedTopics.length,\n          overdueCount: selectedTopics.filter(t => t.reason === \"overdue\").length,\n          weakCount: selectedTopics.filter(t => t.reason === \"weak\").length,\n        }\n      });\n\n    } catch (error: any) {\n      console.error(\"Daily quiz generation error:\", error);\n      \n      if (error.status === 401) {\n        return res.status(500).json({ \n          error: \"API configuration error. Please check your settings.\" \n        });\n      }\n      \n      if (error.status === 429) {\n        return res.status(429).json({ \n          error: \"Too many requests. Please wait a moment and try again.\" \n        });\n      }\n\n      res.status(500).json({ \n        error: \"Failed to generate daily quiz. Please try again.\",\n        details: error.message \n      });\n    }\n  });\n\n  // Complete daily quiz and update spaced repetition stats\n  app.post(\"/api/daily-quiz/complete\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { planId, score, topicScores } = req.body;\n      \n      if (typeof score !== \"number\" || score < 0 || score > 100) {\n        return res.status(400).json({ error: \"Invalid score\" });\n      }\n      \n      const currentPlan = await storage.getCurrentDailyQuizPlan(userId);\n      if (!currentPlan || currentPlan.id !== planId) {\n        return res.status(400).json({ error: \"Invalid or expired quiz plan\" });\n      }\n      \n      // Update spaced repetition stats for each topic\n      if (Array.isArray(topicScores)) {\n        for (const ts of topicScores as { topic: string; correct: boolean; lectureId?: string }[]) {\n          const topicScore = ts.correct ? 100 : 0;\n          const topicData = currentPlan.topics.find(t => t.topic === ts.topic);\n          if (topicData) {\n            await storage.updateTopicReviewStats(\n              userId,\n              ts.topic,\n              topicData.lectureId,\n              topicData.lectureTitle,\n              topicScore\n            );\n            \n            // Add review event\n            await storage.addReviewEvent(userId, {\n              topicId: ts.topic,\n              topic: ts.topic,\n              lectureId: topicData.lectureId,\n              date: new Date().toISOString(),\n              score: topicScore,\n              wasCorrect: ts.correct,\n            });\n          }\n        }\n      }\n      \n      // Complete the plan\n      const completedPlan = await storage.completeDailyQuizPlan(userId, score);\n      \n      // Update user profile with activity\n      const profile = await storage.getUserProfile(userId);\n      const today = new Date().toISOString().split('T')[0];\n      const lastActivity = profile.lastActivityDate;\n      \n      let newStreak = profile.currentStreak;\n      if (lastActivity) {\n        const lastDate = new Date(lastActivity);\n        const todayDate = new Date(today);\n        const daysDiff = Math.floor((todayDate.getTime() - lastDate.getTime()) / (1000 * 60 * 60 * 24));\n        \n        if (daysDiff === 1) {\n          newStreak = profile.currentStreak + 1;\n        } else if (daysDiff > 1) {\n          newStreak = 1;\n        }\n      } else {\n        newStreak = 1;\n      }\n      \n      await storage.updateUserProfile(userId, {\n        lastActivityDate: today,\n        currentStreak: newStreak,\n        longestStreak: Math.max(profile.longestStreak, newStreak),\n      });\n      \n      const nextDueTopics = await storage.getDueTopics(userId, 5);\n      res.json({\n        success: true,\n        completedPlan,\n        newStreak,\n        nextReviewSummary: nextDueTopics.map(t => ({\n          topic: t.topic,\n          nextDue: t.nextDue,\n          interval: t.interval,\n        })),\n      });\n    } catch (error: any) {\n      console.error(\"Complete daily quiz error:\", error);\n      res.status(500).json({ error: \"Failed to complete daily quiz\" });\n    }\n  });\n\n  app.get(\"/api/health\", (req, res) => {\n    res.json({ status: \"ok\", timestamp: new Date().toISOString() });\n  });\n\n  app.post(\"/api/parse-file\", async (req, res) => {\n    try {\n      const { fileData, fileType, fileName } = req.body;\n      \n      if (!fileData || !fileType) {\n        return res.status(400).json({ error: \"Missing file data or type\" });\n      }\n\n      let extractedText = \"\";\n      let title = fileName?.replace(/\\.[^/.]+$/, \"\") || \"Untitled\";\n\n      if (fileType === \"application/pdf\" || fileName?.endsWith(\".pdf\")) {\n        try {\n          const buffer = Buffer.from(fileData, \"base64\");\n          const pdfData = await parsePdf(buffer);\n          const rawText = pdfData.text || \"\";\n          \n          const extractedTitle = extractTitleFromText(rawText);\n          if (extractedTitle) {\n            title = extractedTitle;\n          }\n          \n          extractedText = rawText\n            .replace(/\\x00/g, \"\")\n            .replace(/[^\\x20-\\x7E\\n\\r\\t]/g, \" \")\n            .replace(/\\s+/g, \" \")\n            .trim();\n          \n          if (!extractedText || extractedText.length < 50) {\n            return res.status(400).json({ \n              error: \"Could not extract enough text from PDF. The PDF might be image-based or encrypted. Please try copying the text manually.\" \n            });\n          }\n        } catch (pdfError: any) {\n          console.error(\"PDF parsing error:\", pdfError);\n          return res.status(400).json({ \n            error: \"Failed to parse PDF file. Please ensure it's a valid text-based PDF or try copying the content manually.\" \n          });\n        }\n      } else if (fileType === \"text/html\" || fileName?.endsWith(\".html\") || fileName?.endsWith(\".htm\")) {\n        try {\n          const htmlContent = Buffer.from(fileData, \"base64\").toString(\"utf-8\");\n          extractedText = htmlContent\n            .replace(/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi, \"\")\n            .replace(/<style\\b[^<]*(?:(?!<\\/style>)<[^<]*)*<\\/style>/gi, \"\")\n            .replace(/<[^>]+>/g, \" \")\n            .replace(/&nbsp;/g, \" \")\n            .replace(/&amp;/g, \"&\")\n            .replace(/&lt;/g, \"<\")\n            .replace(/&gt;/g, \">\")\n            .replace(/&quot;/g, '\"')\n            .replace(/&#39;/g, \"'\")\n            .replace(/\\s+/g, \" \")\n            .trim();\n          \n          const titleMatch = htmlContent.match(/<title[^>]*>([^<]+)<\\/title>/i);\n          if (titleMatch && titleMatch[1]) {\n            title = titleMatch[1].trim();\n          }\n        } catch (htmlError: any) {\n          console.error(\"HTML parsing error:\", htmlError);\n          return res.status(400).json({ error: \"Failed to parse HTML file\" });\n        }\n      } else if (fileType === \"text/plain\" || fileName?.endsWith(\".txt\")) {\n        extractedText = Buffer.from(fileData, \"base64\").toString(\"utf-8\");\n      } else {\n        return res.status(400).json({ \n          error: \"Unsupported file type. Please upload PDF, HTML, or TXT files.\" \n        });\n      }\n\n      if (!extractedText || extractedText.trim().length < 50) {\n        return res.status(400).json({ \n          error: \"Extracted text is too short (minimum 50 characters required)\" \n        });\n      }\n\n      res.json({ \n        text: extractedText.trim(),\n        title,\n        characterCount: extractedText.length\n      });\n\n    } catch (error: any) {\n      console.error(\"File parsing error:\", error);\n      res.status(500).json({ error: \"Failed to parse file\" });\n    }\n  });\n\n  app.get(\"/api/profile\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const profile = await storage.getUserProfile(userId);\n      res.json(profile);\n    } catch (error: any) {\n      console.error(\"Error fetching profile:\", error);\n      res.status(500).json({ error: \"Failed to fetch profile\" });\n    }\n  });\n\n  app.patch(\"/api/profile\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const parsed = updateProfileSchema.safeParse(req.body);\n      if (!parsed.success) {\n        return res.status(400).json({ \n          error: \"Invalid request\", \n          details: parsed.error.issues \n        });\n      }\n      const updatedProfile = await storage.updateUserProfile(userId, parsed.data);\n      res.json(updatedProfile);\n    } catch (error: any) {\n      console.error(\"Error updating profile:\", error);\n      res.status(500).json({ error: \"Failed to update profile\" });\n    }\n  });\n\n  app.post(\"/api/profile/reset\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const profile = await storage.resetUserProfile(userId);\n      res.json(profile);\n    } catch (error: any) {\n      console.error(\"Error resetting profile:\", error);\n      res.status(500).json({ error: \"Failed to reset profile\" });\n    }\n  });\n\n  app.post(\"/api/profile/demo\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const data = await storage.loadDemoData(userId);\n      res.json(data);\n    } catch (error: any) {\n      console.error(\"Error loading demo data:\", error);\n      res.status(500).json({ error: \"Failed to load demo data\" });\n    }\n  });\n\n  app.get(\"/api/lectures\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const lectures = await storage.getLectures(userId);\n      res.json(lectures);\n    } catch (error: any) {\n      console.error(\"Error fetching lectures:\", error);\n      res.status(500).json({ error: \"Failed to fetch lectures\" });\n    }\n  });\n\n  app.get(\"/api/lectures/:id\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const lecture = await storage.getLecture(userId, req.params.id);\n      if (!lecture) {\n        return res.status(404).json({ error: \"Lecture not found\" });\n      }\n      res.json(lecture);\n    } catch (error: any) {\n      console.error(\"Error fetching lecture:\", error);\n      res.status(500).json({ error: \"Failed to fetch lecture\" });\n    }\n  });\n\n  app.post(\"/api/lectures\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const parsed = addLectureSchema.safeParse(req.body);\n      if (!parsed.success) {\n        return res.status(400).json({ \n          error: \"Invalid request\", \n          details: parsed.error.issues \n        });\n      }\n      const lecture = await storage.addLecture(userId, parsed.data);\n      res.json(lecture);\n    } catch (error: any) {\n      console.error(\"Error adding lecture:\", error);\n      res.status(500).json({ error: \"Failed to add lecture\" });\n    }\n  });\n\n  // Batch upload endpoint for multiple lectures\n  app.post(\"/api/lectures/batch\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { lectures: lectureInputs } = req.body;\n      \n      if (!Array.isArray(lectureInputs) || lectureInputs.length === 0) {\n        return res.status(400).json({ error: \"Invalid request: lectures array required\" });\n      }\n      \n      if (lectureInputs.length > 20) {\n        return res.status(400).json({ error: \"Maximum 20 lectures per batch\" });\n      }\n      \n      const batchId = `batch-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n      \n      // Process lectures in parallel\n      const results = await Promise.allSettled(\n        lectureInputs.map(async (input: { title: string; content: string; filename?: string }, index: number) => {\n          const parsed = addLectureSchema.safeParse({\n            title: input.title,\n            content: input.content,\n          });\n          \n          if (!parsed.success) {\n            throw new Error(`Invalid lecture data at index ${index}: ${parsed.error.message}`);\n          }\n          \n          const lecture = await storage.addLecture(userId, parsed.data);\n          return { \n            index, \n            lectureId: lecture.id, \n            title: lecture.title, \n            status: \"completed\" as const \n          };\n        })\n      );\n      \n      const processedResults = results.map((result, index) => {\n        if (result.status === \"fulfilled\") {\n          return result.value;\n        } else {\n          return {\n            index,\n            lectureId: null,\n            title: lectureInputs[index]?.title || `Lecture ${index + 1}`,\n            status: \"error\" as const,\n            error: result.reason?.message || \"Unknown error\"\n          };\n        }\n      });\n      \n      const successCount = processedResults.filter(r => r.status === \"completed\").length;\n      const errorCount = processedResults.filter(r => r.status === \"error\").length;\n      \n      res.json({\n        batchId,\n        total: lectureInputs.length,\n        successCount,\n        errorCount,\n        results: processedResults\n      });\n    } catch (error: any) {\n      console.error(\"Error in batch upload:\", error);\n      res.status(500).json({ error: \"Failed to process batch upload\" });\n    }\n  });\n\n  app.patch(\"/api/lectures/:id\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { id } = req.params;\n      const parsed = updateLectureSchema.safeParse(req.body);\n      if (!parsed.success) {\n        return res.status(400).json({ \n          error: \"Invalid request\", \n          details: parsed.error.issues \n        });\n      }\n      const updatedLecture = await storage.updateLecture(userId, id, parsed.data);\n      if (!updatedLecture) {\n        return res.status(404).json({ error: \"Lecture not found\" });\n      }\n      res.json(updatedLecture);\n    } catch (error: any) {\n      console.error(\"Error updating lecture:\", error);\n      res.status(500).json({ error: \"Failed to update lecture\" });\n    }\n  });\n\n  app.delete(\"/api/lectures/:id\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { id } = req.params;\n      const deleted = await storage.deleteLecture(userId, id);\n      if (!deleted) {\n        return res.status(404).json({ error: \"Lecture not found\" });\n      }\n      res.json({ success: true, message: \"Lecture deleted\" });\n    } catch (error: any) {\n      console.error(\"Error deleting lecture:\", error);\n      res.status(500).json({ error: \"Failed to delete lecture\" });\n    }\n  });\n\n  app.get(\"/api/weak-topics\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const topics = await storage.getWeakTopics(userId);\n      res.json(topics);\n    } catch (error: any) {\n      console.error(\"Error fetching weak topics:\", error);\n      res.status(500).json({ error: \"Failed to fetch weak topics\" });\n    }\n  });\n\n  app.get(\"/api/skills\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const lectures = await storage.getLectures(userId);\n      \n      const skillsMap = new Map<string, {\n        name: string;\n        description: string;\n        category: \"cognitive\" | \"technical\" | \"communication\" | \"interpersonal\" | \"organizational\";\n        relevantCareers: string[];\n        highestProficiency: \"developing\" | \"intermediate\" | \"proficient\";\n        occurrenceCount: number;\n      }>();\n      \n      const proficiencyOrder = { developing: 0, intermediate: 1, proficient: 2 };\n      \n      lectures.forEach(lecture => {\n        if (lecture.identifiedSkills && Array.isArray(lecture.identifiedSkills)) {\n          lecture.identifiedSkills.forEach(skill => {\n            const existing = skillsMap.get(skill.name);\n            \n            if (existing) {\n              existing.occurrenceCount += 1;\n              if (proficiencyOrder[skill.proficiencyLevel] > proficiencyOrder[existing.highestProficiency]) {\n                existing.highestProficiency = skill.proficiencyLevel;\n              }\n              skill.relevantCareers.forEach(career => {\n                if (!existing.relevantCareers.includes(career)) {\n                  existing.relevantCareers.push(career);\n                }\n              });\n            } else {\n              skillsMap.set(skill.name, {\n                name: skill.name,\n                description: skill.description,\n                category: skill.category,\n                relevantCareers: [...skill.relevantCareers],\n                highestProficiency: skill.proficiencyLevel,\n                occurrenceCount: 1,\n              });\n            }\n          });\n        }\n      });\n      \n      const aggregatedSkills = Array.from(skillsMap.values())\n        .sort((a, b) => {\n          const profDiff = proficiencyOrder[b.highestProficiency] - proficiencyOrder[a.highestProficiency];\n          if (profDiff !== 0) return profDiff;\n          return b.occurrenceCount - a.occurrenceCount;\n        });\n      \n      res.json({\n        skills: aggregatedSkills,\n        totalSkills: aggregatedSkills.length,\n        proficientCount: aggregatedSkills.filter(s => s.highestProficiency === \"proficient\").length,\n        intermediateCount: aggregatedSkills.filter(s => s.highestProficiency === \"intermediate\").length,\n        developingCount: aggregatedSkills.filter(s => s.highestProficiency === \"developing\").length,\n      });\n    } catch (error: any) {\n      console.error(\"Error fetching skills:\", error);\n      res.status(500).json({ error: \"Failed to fetch skills\" });\n    }\n  });\n\n  app.get(\"/api/calendar\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const settings = await storage.getCalendarSettings(userId);\n      const events = await storage.getCalendarEvents(userId);\n      const lectures = await storage.getLectures(userId);\n      const dismissedLectures = await storage.getDismissedLectures(userId);\n      \n      const dismissedEventIds = new Set(dismissedLectures.map(d => d.calendarEventId));\n      \n      const lecturesOnly = events.filter(e => e.eventType === \"lecture\");\n      const examsOnly = events.filter(e => e.eventType === \"exam\");\n      \n      const now = new Date();\n      const sevenDaysFromNow = new Date(now.getTime() + 7 * 24 * 60 * 60 * 1000);\n      const fourteenDaysAgo = new Date(now.getTime() - 14 * 24 * 60 * 60 * 1000);\n      \n      const upcomingLectures = lecturesOnly.filter(e => {\n        const eventDate = new Date(e.startsAt);\n        return eventDate >= now && eventDate <= sevenDaysFromNow;\n      });\n      \n      const upcomingExams = examsOnly.filter(e => {\n        const eventDate = new Date(e.startsAt);\n        return eventDate >= now && eventDate <= sevenDaysFromNow;\n      });\n      \n      const allMissingLectures = lecturesOnly.filter(e => {\n        const eventDate = new Date(e.startsAt);\n        if (eventDate >= now || eventDate < fourteenDaysAgo) return false;\n        \n        const eventDateStr = eventDate.toISOString().split(\"T\")[0];\n        const matchingLecture = lectures.find(l => {\n          const lectureDate = l.date;\n          const titleWords = e.title.toLowerCase().split(/\\s+/);\n          const lectureWords = l.title.toLowerCase().split(/\\s+/);\n          const hasMatchingWords = titleWords.some(tw => \n            lectureWords.some(lw => lw.includes(tw) || tw.includes(lw))\n          );\n          return lectureDate === eventDateStr || hasMatchingWords;\n        });\n        \n        return !matchingLecture && !e.matchedLectureId;\n      });\n      \n      const missingLectures = allMissingLectures.filter(e => !dismissedEventIds.has(e.id));\n      const totalMissed = allMissingLectures.length;\n      const activeMissed = missingLectures.length;\n      const dismissedCount = totalMissed - activeMissed;\n      \n      res.json({\n        settings,\n        events: lecturesOnly,\n        upcomingLectures,\n        upcomingExams,\n        missingLectures,\n        totalMissed,\n        activeMissed,\n        dismissedCount,\n        totalEvents: events.length,\n        lectureCount: lecturesOnly.length,\n        examCount: examsOnly.length,\n      });\n    } catch (error: any) {\n      console.error(\"Error fetching calendar:\", error);\n      res.status(500).json({ error: \"Failed to fetch calendar\" });\n    }\n  });\n\n  app.post(\"/api/calendar/dismiss/:eventId\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { eventId } = req.params;\n      const { reason } = req.body;\n      \n      await storage.dismissLecture(userId, eventId, reason);\n      \n      res.json({ success: true, message: \"Lecture dismissed\" });\n    } catch (error: any) {\n      console.error(\"Error dismissing lecture:\", error);\n      res.status(500).json({ error: \"Failed to dismiss lecture\" });\n    }\n  });\n\n  app.delete(\"/api/calendar/dismiss/:eventId\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { eventId } = req.params;\n      \n      await storage.undismissLecture(userId, eventId);\n      \n      res.json({ success: true, message: \"Lecture restored\" });\n    } catch (error: any) {\n      console.error(\"Error undismissing lecture:\", error);\n      res.status(500).json({ error: \"Failed to restore lecture\" });\n    }\n  });\n\n  app.post(\"/api/calendar\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const parsed = calendarSettingsSchema.safeParse(req.body);\n      if (!parsed.success) {\n        return res.status(400).json({ \n          error: \"Invalid calendar URL\", \n          details: parsed.error.issues \n        });\n      }\n      \n      const { url } = parsed.data;\n      \n      const urlValidation = await validateCalendarUrlWithDns(url);\n      if (!urlValidation.valid) {\n        return res.status(400).json({ \n          error: urlValidation.error || \"Invalid calendar URL\"\n        });\n      }\n      \n      const { events, error } = await fetchAndParseCalendar(url);\n      \n      if (error) {\n        return res.status(400).json({ \n          error: \"Failed to fetch calendar\",\n          details: error\n        });\n      }\n      \n      const settings: CalendarSettings = {\n        url,\n        lastSync: new Date().toISOString(),\n        lastSyncStatus: \"success\",\n      };\n      \n      await storage.setCalendarSettings(userId, settings);\n      await storage.setCalendarEvents(userId, events);\n      \n      const lecturesOnly = events.filter(e => e.eventType === \"lecture\");\n      \n      res.json({\n        success: true,\n        settings,\n        totalEvents: events.length,\n        lectureCount: lecturesOnly.length,\n        message: `Found ${lecturesOnly.length} lectures out of ${events.length} total events`,\n      });\n    } catch (error: any) {\n      console.error(\"Error setting calendar:\", error);\n      res.status(500).json({ error: \"Failed to set calendar\" });\n    }\n  });\n\n  app.post(\"/api/calendar/refresh\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const settings = await storage.getCalendarSettings(userId);\n      if (!settings) {\n        return res.status(400).json({ error: \"No calendar configured\" });\n      }\n      \n      const urlValidation = await validateCalendarUrlWithDns(settings.url);\n      if (!urlValidation.valid) {\n        await storage.clearCalendarSettings(userId);\n        return res.status(400).json({ \n          error: \"Stored calendar URL is invalid. Please reconnect your calendar.\"\n        });\n      }\n      \n      const { events, error } = await fetchAndParseCalendar(settings.url);\n      \n      if (error) {\n        const updatedSettings: CalendarSettings = {\n          ...settings,\n          lastSync: new Date().toISOString(),\n          lastSyncStatus: \"error\",\n          lastSyncError: error,\n        };\n        await storage.setCalendarSettings(userId, updatedSettings);\n        \n        return res.status(400).json({ \n          error: \"Failed to refresh calendar\",\n          details: error\n        });\n      }\n      \n      const updatedSettings: CalendarSettings = {\n        ...settings,\n        lastSync: new Date().toISOString(),\n        lastSyncStatus: \"success\",\n        lastSyncError: undefined,\n      };\n      \n      await storage.setCalendarSettings(userId, updatedSettings);\n      await storage.setCalendarEvents(userId, events);\n      \n      const lecturesOnly = events.filter(e => e.eventType === \"lecture\");\n      \n      res.json({\n        success: true,\n        settings: updatedSettings,\n        totalEvents: events.length,\n        lectureCount: lecturesOnly.length,\n      });\n    } catch (error: any) {\n      console.error(\"Error refreshing calendar:\", error);\n      res.status(500).json({ error: \"Failed to refresh calendar\" });\n    }\n  });\n\n  app.delete(\"/api/calendar\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      await storage.clearCalendarSettings(userId);\n      res.json({ success: true, message: \"Calendar removed\" });\n    } catch (error: any) {\n      console.error(\"Error removing calendar:\", error);\n      res.status(500).json({ error: \"Failed to remove calendar\" });\n    }\n  });\n\n  // Friends API endpoints\n  app.get(\"/api/friends\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const friends = await storage.getFriends(userId);\n      res.json(friends);\n    } catch (error: any) {\n      console.error(\"Error fetching friends:\", error);\n      res.status(500).json({ error: \"Failed to fetch friends\" });\n    }\n  });\n\n  app.get(\"/api/friends/requests\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const requests = await storage.getPendingRequests(userId);\n      res.json(requests);\n    } catch (error: any) {\n      console.error(\"Error fetching friend requests:\", error);\n      res.status(500).json({ error: \"Failed to fetch friend requests\" });\n    }\n  });\n\n  app.post(\"/api/friends/request\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { username } = req.body;\n      \n      if (!username || typeof username !== \"string\") {\n        return res.status(400).json({ error: \"Username is required\" });\n      }\n      \n      const friendship = await storage.sendFriendRequest(userId, username.trim());\n      res.json({ success: true, friendship });\n    } catch (error: any) {\n      console.error(\"Error sending friend request:\", error);\n      res.status(400).json({ error: error.message || \"Failed to send friend request\" });\n    }\n  });\n\n  app.post(\"/api/friends/accept/:requestId\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { requestId } = req.params;\n      \n      await storage.acceptFriendRequest(userId, requestId);\n      res.json({ success: true, message: \"Friend request accepted\" });\n    } catch (error: any) {\n      console.error(\"Error accepting friend request:\", error);\n      res.status(400).json({ error: error.message || \"Failed to accept friend request\" });\n    }\n  });\n\n  app.post(\"/api/friends/decline/:requestId\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { requestId } = req.params;\n      \n      await storage.declineFriendRequest(userId, requestId);\n      res.json({ success: true, message: \"Friend request declined\" });\n    } catch (error: any) {\n      console.error(\"Error declining friend request:\", error);\n      res.status(400).json({ error: error.message || \"Failed to decline friend request\" });\n    }\n  });\n\n  app.delete(\"/api/friends/:friendId\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { friendId } = req.params;\n      \n      await storage.removeFriend(userId, friendId);\n      res.json({ success: true, message: \"Friend removed\" });\n    } catch (error: any) {\n      console.error(\"Error removing friend:\", error);\n      res.status(400).json({ error: error.message || \"Failed to remove friend\" });\n    }\n  });\n\n  app.get(\"/api/friends/leaderboard\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const leaderboard = await storage.getLeaderboard(userId);\n      res.json(leaderboard);\n    } catch (error: any) {\n      console.error(\"Error fetching leaderboard:\", error);\n      res.status(500).json({ error: \"Failed to fetch leaderboard\" });\n    }\n  });\n\n  return httpServer;\n}\n","path":null,"size_bytes":61746,"size_tokens":null},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","path":null,"size_bytes":1642,"size_tokens":null},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","path":null,"size_bytes":689,"size_tokens":null},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","path":null,"size_bytes":756,"size_tokens":null},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","path":null,"size_bytes":1883,"size_tokens":null},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","path":null,"size_bytes":1467,"size_tokens":null},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","path":null,"size_bytes":4120,"size_tokens":null},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","path":null,"size_bytes":21846,"size_tokens":null},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","path":null,"size_bytes":157,"size_tokens":null},"client/src/components/quiz-view.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Check, X, Lightbulb, RotateCcw, Zap, ArrowRight } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport type { Question, UserProfile } from \"@shared/schema\";\n\ninterface QuizViewProps {\n  questions: Question[];\n  lectureTitle: string;\n  userProfile: UserProfile;\n  onComplete: (answers: { questionIndex: number; selectedAnswer: number; isCorrect: boolean }[]) => void;\n  onUseHint: () => void;\n  onUseSecondChance: () => void;\n  isDaily?: boolean;\n}\n\nexport function QuizView({\n  questions,\n  lectureTitle,\n  userProfile,\n  onComplete,\n  onUseHint,\n  onUseSecondChance,\n  isDaily = false,\n}: QuizViewProps) {\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [answers, setAnswers] = useState<{ questionIndex: number; selectedAnswer: number; isCorrect: boolean }[]>([]);\n  const [selectedAnswer, setSelectedAnswer] = useState<number | null>(null);\n  const [showFeedback, setShowFeedback] = useState(false);\n  const [xpEarned, setXpEarned] = useState(0);\n  const [floatingXP, setFloatingXP] = useState<{ id: number; amount: number } | null>(null);\n  const [eliminatedOptions, setEliminatedOptions] = useState<number[]>([]);\n  const [usedSecondChance, setUsedSecondChance] = useState(false);\n  const [shakeWrong, setShakeWrong] = useState(false);\n\n  const currentQuestion = questions[currentIndex];\n  const isLastQuestion = currentIndex === questions.length - 1;\n  const canUseHint = userProfile.powerUps.hints > 0 && eliminatedOptions.length === 0;\n  const canUseSecondChance = userProfile.powerUps.secondChance > 0 && !usedSecondChance && showFeedback && selectedAnswer !== currentQuestion.correct;\n\n  const handleSelectAnswer = (index: number) => {\n    if (showFeedback || eliminatedOptions.includes(index)) return;\n    setSelectedAnswer(index);\n  };\n\n  const handleSubmitAnswer = () => {\n    if (selectedAnswer === null) return;\n\n    const isCorrect = selectedAnswer === currentQuestion.correct;\n    \n    if (!isCorrect) {\n      setShakeWrong(true);\n      setTimeout(() => setShakeWrong(false), 500);\n    } else {\n      const earnedXP = 10;\n      setXpEarned((prev) => prev + earnedXP);\n      setFloatingXP({ id: Date.now(), amount: earnedXP });\n      setTimeout(() => setFloatingXP(null), 1500);\n    }\n\n    setShowFeedback(true);\n    setAnswers((prev) => [...prev, { questionIndex: currentIndex, selectedAnswer, isCorrect }]);\n  };\n\n  const handleNextQuestion = () => {\n    if (isLastQuestion) {\n      onComplete(answers);\n    } else {\n      setCurrentIndex((prev) => prev + 1);\n      setSelectedAnswer(null);\n      setShowFeedback(false);\n      setEliminatedOptions([]);\n      setUsedSecondChance(false);\n    }\n  };\n\n  const handleUseHint = () => {\n    if (!canUseHint) return;\n    \n    const wrongOptions = currentQuestion.options\n      .map((_, i) => i)\n      .filter((i) => i !== currentQuestion.correct);\n    \n    const toEliminate = wrongOptions.slice(0, 2);\n    setEliminatedOptions(toEliminate);\n    onUseHint();\n  };\n\n  const handleUseSecondChance = () => {\n    if (!canUseSecondChance) return;\n    \n    setShowFeedback(false);\n    setSelectedAnswer(null);\n    setUsedSecondChance(true);\n    setEliminatedOptions([selectedAnswer!]);\n    setAnswers((prev) => prev.slice(0, -1));\n    onUseSecondChance();\n  };\n\n  useEffect(() => {\n    if (showFeedback) {\n      const timer = setTimeout(() => {\n        if (isLastQuestion) {\n          onComplete(answers);\n        }\n      }, 2500);\n      return () => clearTimeout(timer);\n    }\n  }, [showFeedback, answers, isLastQuestion, onComplete]);\n\n  const progressPercent = ((currentIndex + 1) / questions.length) * 100;\n\n  return (\n    <div className=\"min-h-screen\">\n      <div className=\"max-w-2xl mx-auto px-6 py-16 animate-fade-in\">\n        <div className=\"mb-10 space-y-4\">\n          <div className=\"flex items-center justify-between\">\n            <span className=\"text-muted-foreground\">\n              {isDaily ? \"Daily Quiz\" : lectureTitle}\n            </span>\n            <div \n              className=\"flex items-center gap-2 text-gold font-medium relative\"\n              role=\"status\"\n              aria-label={`${xpEarned} XP earned`}\n            >\n              <Zap className=\"h-4 w-4\" aria-hidden=\"true\" />\n              <span className=\"tabular-nums\" aria-hidden=\"true\">{xpEarned} XP</span>\n              {floatingXP && (\n                <span\n                  key={floatingXP.id}\n                  className=\"absolute -top-6 right-0 animate-float-up text-gold font-bold\"\n                  aria-live=\"polite\"\n                >\n                  +{floatingXP.amount}\n                </span>\n              )}\n            </div>\n          </div>\n          \n          <div className=\"space-y-3\">\n            <div className=\"flex items-center justify-between\">\n              <span className=\"font-medium\">Question {currentIndex + 1} of {questions.length}</span>\n              <span className=\"text-muted-foreground tabular-nums\">{Math.round(progressPercent)}%</span>\n            </div>\n            <Progress \n              value={progressPercent} \n              className=\"h-2\"\n              aria-label={`Progress: ${currentIndex + 1} of ${questions.length} questions`}\n            />\n          </div>\n        </div>\n\n        <div className={`space-y-8 ${shakeWrong ? \"animate-shake\" : \"\"}`}>\n          <h2 className=\"font-serif text-2xl leading-relaxed\">\n            {currentQuestion.question}\n          </h2>\n\n          <div className=\"space-y-3\" role=\"radiogroup\" aria-label=\"Answer options\">\n            {currentQuestion.options.map((option, index) => {\n              const isSelected = selectedAnswer === index;\n              const isCorrect = index === currentQuestion.correct;\n              const isEliminated = eliminatedOptions.includes(index);\n              const showCorrect = showFeedback && isCorrect;\n              const showWrong = showFeedback && isSelected && !isCorrect;\n\n              return (\n                <button\n                  key={index}\n                  onClick={() => handleSelectAnswer(index)}\n                  disabled={showFeedback || isEliminated}\n                  className={`w-full p-5 rounded-xl border text-left transition-all duration-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-ring ${\n                    isEliminated\n                      ? \"opacity-30 cursor-not-allowed border-border bg-muted line-through\"\n                      : showCorrect\n                      ? \"border-primary bg-primary/5\"\n                      : showWrong\n                      ? \"border-destructive bg-destructive/5\"\n                      : isSelected\n                      ? \"border-primary bg-primary/5\"\n                      : \"border-border hover:border-primary/50 hover:bg-muted/30\"\n                  }`}\n                  role=\"radio\"\n                  aria-checked={isSelected}\n                  aria-disabled={showFeedback || isEliminated}\n                  data-testid={`option-${index}`}\n                >\n                  <div className=\"flex items-center gap-4\">\n                    <div\n                      className={`flex h-8 w-8 items-center justify-center rounded-full border-2 text-sm font-medium transition-colors ${\n                        showCorrect\n                          ? \"border-primary bg-primary text-primary-foreground\"\n                          : showWrong\n                          ? \"border-destructive bg-destructive text-destructive-foreground\"\n                          : isSelected\n                          ? \"border-primary bg-primary text-primary-foreground\"\n                          : \"border-muted-foreground/30\"\n                      }`}\n                    >\n                      {showCorrect ? (\n                        <Check className=\"h-4 w-4\" aria-hidden=\"true\" />\n                      ) : showWrong ? (\n                        <X className=\"h-4 w-4\" aria-hidden=\"true\" />\n                      ) : (\n                        String.fromCharCode(65 + index)\n                      )}\n                    </div>\n                    <span className={`flex-1 ${showWrong ? \"text-muted-foreground\" : \"\"}`}>\n                      {option}\n                    </span>\n                  </div>\n                </button>\n              );\n            })}\n          </div>\n\n          {showFeedback && (\n            <Card \n              className={`rounded-xl ${selectedAnswer === currentQuestion.correct ? \"border-primary/30 bg-primary/5\" : \"\"}`}\n              role=\"status\"\n              aria-live=\"polite\"\n            >\n              <CardContent className=\"p-5\">\n                <div className=\"flex items-start gap-4\">\n                  <div className={`flex h-9 w-9 items-center justify-center rounded-lg flex-shrink-0 ${\n                    selectedAnswer === currentQuestion.correct ? \"bg-primary/10\" : \"bg-gold/10\"\n                  }`}>\n                    <Lightbulb className={`h-5 w-5 ${\n                      selectedAnswer === currentQuestion.correct ? \"text-primary\" : \"text-gold\"\n                    }`} aria-hidden=\"true\" />\n                  </div>\n                  <div>\n                    <p className=\"font-medium mb-1\">\n                      {selectedAnswer === currentQuestion.correct ? \"Correct!\" : \"Not quite right\"}\n                    </p>\n                    <p className=\"text-muted-foreground leading-relaxed\">\n                      {currentQuestion.explanation}\n                    </p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          <div className=\"flex items-center gap-3 pt-2\">\n            {!showFeedback && canUseHint && (\n              <Button\n                variant=\"outline\"\n                onClick={handleUseHint}\n                className=\"gap-2 rounded-xl\"\n                data-testid=\"button-hint\"\n              >\n                <Lightbulb className=\"h-4 w-4\" aria-hidden=\"true\" />\n                Use Hint ({userProfile.powerUps.hints})\n              </Button>\n            )}\n\n            {showFeedback && canUseSecondChance && (\n              <Button\n                variant=\"outline\"\n                onClick={handleUseSecondChance}\n                className=\"gap-2 rounded-xl\"\n                data-testid=\"button-second-chance\"\n              >\n                <RotateCcw className=\"h-4 w-4\" aria-hidden=\"true\" />\n                Try Again ({userProfile.powerUps.secondChance})\n              </Button>\n            )}\n\n            <div className=\"flex-1\" />\n\n            {!showFeedback ? (\n              <Button\n                onClick={handleSubmitAnswer}\n                disabled={selectedAnswer === null}\n                className=\"rounded-xl px-6\"\n                data-testid=\"button-submit-answer\"\n              >\n                Submit Answer\n              </Button>\n            ) : (\n              <Button\n                onClick={handleNextQuestion}\n                className=\"gap-2 rounded-xl px-6\"\n                data-testid=\"button-next-question\"\n              >\n                {isLastQuestion ? \"View Results\" : \"Next Question\"}\n                <ArrowRight className=\"h-4 w-4\" aria-hidden=\"true\" />\n              </Button>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":11430,"size_tokens":null},"client/src/pages/home.tsx":{"content":"import { useState, useCallback } from \"react\";\nimport { useMutation, useQuery } from \"@tanstack/react-query\";\nimport { Header } from \"@/components/header\";\nimport { Dashboard } from \"@/components/dashboard\";\nimport { UploadView } from \"@/components/upload-view\";\nimport { QuizView } from \"@/components/quiz-view\";\nimport { QuizResults } from \"@/components/quiz-results\";\nimport { ConfidenceRating } from \"@/components/confidence-rating\";\nimport { AchievementsView } from \"@/components/achievements-view\";\nimport { LevelUpOverlay } from \"@/components/level-up-overlay\";\nimport { AchievementToastStack } from \"@/components/achievement-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport {\n  calculateXP,\n  calculateLevel,\n  xpForNextLevel,\n  checkAchievements,\n  extractTopics,\n} from \"@/lib/game-utils\";\nimport type { \n  UserProfile, \n  Lecture, \n  Question, \n  QuizResult, \n  Achievement,\n  TransferableSkill \n} from \"@shared/schema\";\nimport { INITIAL_USER_PROFILE } from \"@shared/schema\";\n\ntype ViewType = \"dashboard\" | \"upload\" | \"quiz\" | \"results\" | \"confidence\" | \"achievements\" | \"loading\";\n\nexport default function Home() {\n  const [currentView, setCurrentView] = useState<ViewType>(\"dashboard\");\n  const [currentQuiz, setCurrentQuiz] = useState<Question[]>([]);\n  const [currentLectureId, setCurrentLectureId] = useState<string | null>(null);\n  const [currentLectureTitle, setCurrentLectureTitle] = useState(\"\");\n  const [currentLectureContent, setCurrentLectureContent] = useState(\"\");\n  const [quizResult, setQuizResult] = useState<QuizResult | null>(null);\n  const [weakTopics, setWeakTopics] = useState<string[]>([]);\n  const [showLevelUp, setShowLevelUp] = useState(false);\n  const [newLevel, setNewLevel] = useState(1);\n  const [levelUpRewards, setLevelUpRewards] = useState<string[]>([]);\n  const [pendingAchievements, setPendingAchievements] = useState<Achievement[]>([]);\n  const [newAchievements, setNewAchievements] = useState<Achievement[]>([]);\n  const [perfectScoresCount, setPerfectScoresCount] = useState(0);\n  const [isDailyQuiz, setIsDailyQuiz] = useState(false);\n  const [dailyQuizPlanId, setDailyQuizPlanId] = useState<string | null>(null);\n  const [dailyQuizTopics, setDailyQuizTopics] = useState<{ topic: string; lectureTitle: string; reason: string }[]>([]);\n  const [currentSkills, setCurrentSkills] = useState<TransferableSkill[]>([]);\n\n  const { data: userProfile = INITIAL_USER_PROFILE } = useQuery<UserProfile>({\n    queryKey: [\"/api/profile\"],\n  });\n\n  const { data: lectureHistory = [] } = useQuery<Lecture[]>({\n    queryKey: [\"/api/lectures\"],\n  });\n\n  const updateProfileMutation = useMutation({\n    mutationFn: async (profile: Partial<UserProfile>) => {\n      const response = await apiRequest(\"PATCH\", \"/api/profile\", profile);\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/profile\"] });\n    },\n  });\n\n  const addLectureMutation = useMutation({\n    mutationFn: async (lecture: Omit<Lecture, \"id\">) => {\n      const response = await apiRequest(\"POST\", \"/api/lectures\", lecture);\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/lectures\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/profile\"] });\n    },\n  });\n\n  const updateLectureMutation = useMutation({\n    mutationFn: async ({ id, data }: { id: string; data: Partial<Lecture> }) => {\n      const response = await apiRequest(\"PATCH\", `/api/lectures/${id}`, data);\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/lectures\"] });\n    },\n  });\n\n  const deleteLectureMutation = useMutation({\n    mutationFn: async (lectureId: string) => {\n      const response = await apiRequest(\"DELETE\", `/api/lectures/${lectureId}`);\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/lectures\"] });\n    },\n  });\n\n  const generateQuizMutation = useMutation({\n    mutationFn: async ({ content, title }: { content: string; title: string }) => {\n      const response = await apiRequest(\"POST\", \"/api/generate-quiz\", { content, title });\n      return response.json();\n    },\n    onSuccess: (data) => {\n      setCurrentQuiz(data.questions);\n      setCurrentSkills(data.skills || []);\n      setCurrentView(\"quiz\");\n    },\n    onError: () => {\n      setCurrentView(\"dashboard\");\n    },\n  });\n\n  const generateDailyQuizMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest(\"POST\", \"/api/generate-daily-quiz\", {});\n      return response.json();\n    },\n    onSuccess: (data) => {\n      setCurrentQuiz(data.questions);\n      setDailyQuizPlanId(data.planId);\n      setDailyQuizTopics(data.focusTopics || []);\n      setIsDailyQuiz(true);\n      setCurrentLectureId(null);\n      setCurrentLectureTitle(\"Daily Quiz\");\n      setCurrentView(\"quiz\");\n    },\n    onError: () => {\n      setCurrentView(\"dashboard\");\n      setIsDailyQuiz(false);\n    },\n  });\n\n  const completeDailyQuizMutation = useMutation({\n    mutationFn: async ({ planId, score, topicScores }: { planId: string; score: number; topicScores: { topic: string; correct: boolean }[] }) => {\n      const response = await apiRequest(\"POST\", \"/api/daily-quiz/complete\", { planId, score, topicScores });\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/daily-quiz/status\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/profile\"] });\n    },\n  });\n\n  const handleSaveLecture = useCallback((content: string, title: string) => {\n    const lecture: Omit<Lecture, \"id\"> = {\n      title,\n      date: new Date().toISOString().split(\"T\")[0],\n      content,\n      reviewScore: 0,\n      xpEarned: 0,\n      incorrectTopics: [],\n      confidenceRating: 0,\n      dailyQuizzes: [],\n      needsReview: true,\n      lastReviewed: undefined,\n    };\n\n    addLectureMutation.mutate(lecture, {\n      onSuccess: () => {\n        setCurrentView(\"dashboard\");\n      },\n    });\n  }, [addLectureMutation]);\n\n  const handleStartReview = useCallback((lectureId: string) => {\n    const lecture = lectureHistory.find((l) => l.id === lectureId);\n    if (!lecture) return;\n\n    setIsDailyQuiz(false);\n    setDailyQuizPlanId(null);\n    setCurrentLectureId(lectureId);\n    setCurrentLectureTitle(lecture.title);\n    setCurrentLectureContent(lecture.content);\n    setCurrentView(\"loading\");\n    generateQuizMutation.mutate({ content: lecture.content, title: lecture.title });\n  }, [lectureHistory, generateQuizMutation]);\n\n  const handleStartDailyQuiz = useCallback(() => {\n    setIsDailyQuiz(true);\n    setCurrentLectureId(null);\n    setCurrentLectureTitle(\"Daily Quiz\");\n    setCurrentView(\"loading\");\n    generateDailyQuizMutation.mutate();\n  }, [generateDailyQuizMutation]);\n\n  const handleQuizComplete = useCallback((answers: { questionIndex: number; selectedAnswer: number; isCorrect: boolean }[]) => {\n    const correctCount = answers.filter((a) => a.isCorrect).length;\n    const totalQuestions = currentQuiz.length;\n    const isPerfect = correctCount === totalQuestions;\n    const accuracyPercent = Math.round((correctCount / totalQuestions) * 100);\n\n    const incorrectAnswers = answers.filter((a) => !a.isCorrect);\n    const incorrectTopics: string[] = [];\n    incorrectAnswers.forEach((answer) => {\n      const question = currentQuiz[answer.questionIndex];\n      // Use AI-generated topic if available, otherwise fall back to extraction\n      if (question.topic) {\n        incorrectTopics.push(question.topic);\n      } else {\n        const topics = extractTopics(question.question);\n        incorrectTopics.push(...topics);\n      }\n    });\n    const uniqueIncorrectTopics = Array.from(new Set(incorrectTopics)).slice(0, 5);\n\n    const existingLecture = currentLectureId ? lectureHistory.find((l) => l.id === currentLectureId) : null;\n    const previousScore = existingLecture?.reviewScore || 0;\n    const isImprovement = previousScore > 0 && accuracyPercent > previousScore;\n    \n    const xpEarned = calculateXP(\n      correctCount,\n      totalQuestions,\n      isPerfect,\n      0,\n      isImprovement,\n      userProfile.currentStreak,\n      userProfile.powerUps.doubleXP\n    );\n\n    const result: QuizResult = {\n      score: correctCount,\n      total: totalQuestions,\n      xpEarned,\n      accuracyPercent,\n      incorrectTopics: uniqueIncorrectTopics,\n    };\n\n    setQuizResult(result);\n    setWeakTopics(uniqueIncorrectTopics);\n\n    if (isPerfect) {\n      setPerfectScoresCount((prev) => prev + 1);\n    }\n\n    const oldLevel = userProfile.level;\n    const newTotalXP = userProfile.totalXP + xpEarned;\n    const calculatedNewLevel = calculateLevel(newTotalXP);\n\n    const newNeedsPractice = userProfile.needsPractice.slice();\n    uniqueIncorrectTopics.forEach((topic) => {\n      if (!newNeedsPractice.includes(topic)) {\n        newNeedsPractice.push(topic);\n      }\n    });\n\n    const newMasteredTopics = userProfile.masteredTopics.slice();\n    const filteredNeedsPractice = newNeedsPractice.slice();\n    if (accuracyPercent >= 80) {\n      uniqueIncorrectTopics.forEach((topic) => {\n        const topicScores = lectureHistory\n          .filter((l) => l.content.toLowerCase().includes(topic.toLowerCase()))\n          .map((l) => l.reviewScore);\n        \n        if (topicScores.filter((s) => s >= 80).length >= 2) {\n          if (!newMasteredTopics.includes(topic)) {\n            newMasteredTopics.push(topic);\n          }\n          const idx = filteredNeedsPractice.indexOf(topic);\n          if (idx > -1) {\n            filteredNeedsPractice.splice(idx, 1);\n          }\n        }\n      });\n    }\n\n    let newPowerUps = { ...userProfile.powerUps };\n    if (userProfile.powerUps.doubleXP) {\n      newPowerUps = { ...newPowerUps, doubleXP: false };\n    }\n    if (isPerfect && userProfile.powerUps.secondChance < 10) {\n      newPowerUps = { ...newPowerUps, secondChance: userProfile.powerUps.secondChance + 1 };\n    }\n\n    const tempProfile: UserProfile = {\n      ...userProfile,\n      totalXP: newTotalXP,\n      level: calculatedNewLevel,\n      xpToNextLevel: xpForNextLevel(calculatedNewLevel),\n      needsPractice: filteredNeedsPractice,\n      masteredTopics: newMasteredTopics,\n      powerUps: newPowerUps,\n    };\n\n    const unlockedAchievements = checkAchievements(\n      tempProfile,\n      lectureHistory,\n      new Date().getHours(),\n      perfectScoresCount + (isPerfect ? 1 : 0)\n    );\n\n    setNewAchievements(unlockedAchievements);\n    if (unlockedAchievements.length > 0) {\n      setPendingAchievements((prev) => [...prev, ...unlockedAchievements]);\n    }\n\n    const profileUpdate: Partial<UserProfile> = {\n      totalXP: newTotalXP,\n      level: calculatedNewLevel,\n      xpToNextLevel: xpForNextLevel(calculatedNewLevel),\n      needsPractice: filteredNeedsPractice,\n      masteredTopics: newMasteredTopics,\n      powerUps: newPowerUps,\n    };\n\n    if (unlockedAchievements.length > 0) {\n      profileUpdate.achievements = tempProfile.achievements;\n    }\n\n    updateProfileMutation.mutate(profileUpdate);\n\n    if (calculatedNewLevel > oldLevel) {\n      setNewLevel(calculatedNewLevel);\n      const rewards: string[] = [];\n      if (calculatedNewLevel === 5) rewards.push(\"Streak Freeze Power-Up\");\n      if (calculatedNewLevel % 3 === 0) rewards.push(\"+1 Hint Power-Up\");\n      if (Math.random() < 0.2) rewards.push(\"Double XP (Next Quiz)\");\n      setLevelUpRewards(rewards);\n\n      if (rewards.length > 0) {\n        const rewardPowerUps = { ...newPowerUps };\n        if (rewards.includes(\"Double XP (Next Quiz)\")) {\n          rewardPowerUps.doubleXP = true;\n        }\n        if (rewards.includes(\"+1 Hint Power-Up\")) {\n          rewardPowerUps.hints = rewardPowerUps.hints + 1;\n        }\n        updateProfileMutation.mutate({ powerUps: rewardPowerUps });\n      }\n    }\n\n    // Complete daily quiz if applicable\n    if (isDailyQuiz && dailyQuizPlanId) {\n      const topicScores = currentQuiz.map((q: any, idx: number) => {\n        const answer = answers.find(a => a.questionIndex === idx);\n        return {\n          topic: q.topic || \"General\",\n          correct: answer?.isCorrect || false,\n        };\n      });\n      completeDailyQuizMutation.mutate({\n        planId: dailyQuizPlanId,\n        score: accuracyPercent,\n        topicScores,\n      });\n    }\n\n    setCurrentView(\"results\");\n\n    if (calculatedNewLevel > oldLevel) {\n      setTimeout(() => setShowLevelUp(true), 500);\n    }\n  }, [currentQuiz, currentLectureId, userProfile, lectureHistory, perfectScoresCount, updateProfileMutation, isDailyQuiz, dailyQuizPlanId, completeDailyQuizMutation]);\n\n  const handleConfidenceSubmit = useCallback((rating: number) => {\n    const confidenceXP = rating * 5;\n\n    if (currentLectureId) {\n      const accuracy = quizResult?.accuracyPercent || 0;\n      let calculatedProficiency: \"developing\" | \"intermediate\" | \"proficient\" = \"developing\";\n      if (accuracy >= 85) {\n        calculatedProficiency = \"proficient\";\n      } else if (accuracy >= 60) {\n        calculatedProficiency = \"intermediate\";\n      }\n\n      const skillsWithProficiency = currentSkills.map(skill => ({\n        ...skill,\n        proficiencyLevel: calculatedProficiency,\n      }));\n\n      updateLectureMutation.mutate({\n        id: currentLectureId,\n        data: {\n          reviewScore: accuracy,\n          xpEarned: (quizResult?.xpEarned || 0) + confidenceXP,\n          incorrectTopics: weakTopics.slice(),\n          confidenceRating: rating,\n          needsReview: false,\n          lastReviewed: new Date().toISOString(),\n          identifiedSkills: skillsWithProficiency,\n          questionsAnswered: currentQuiz.length,\n        },\n      });\n    }\n\n    const newTotalXP = userProfile.totalXP + confidenceXP;\n    const newLevelCalc = calculateLevel(newTotalXP);\n    \n    const totalConfidence = userProfile.averageConfidence * userProfile.totalLectures + rating;\n    const newTotalLectures = userProfile.totalLectures + 1;\n\n    const profileUpdate: Partial<UserProfile> = {\n      totalXP: newTotalXP,\n      level: newLevelCalc,\n      xpToNextLevel: xpForNextLevel(newLevelCalc),\n      totalLectures: newTotalLectures,\n      averageConfidence: totalConfidence / newTotalLectures,\n      currentStreak: userProfile.currentStreak + 1,\n      longestStreak: Math.max(userProfile.longestStreak, userProfile.currentStreak + 1),\n      lastActivityDate: new Date().toISOString(),\n    };\n\n    updateProfileMutation.mutate(profileUpdate);\n\n    const tempProfile: UserProfile = { ...userProfile, ...profileUpdate };\n    const unlockedAchievements = checkAchievements(\n      tempProfile,\n      lectureHistory,\n      new Date().getHours(),\n      perfectScoresCount\n    );\n\n    if (unlockedAchievements.length > 0) {\n      setPendingAchievements((prev) => [...prev, ...unlockedAchievements]);\n    }\n\n    setCurrentView(\"dashboard\");\n    setQuizResult(null);\n    setCurrentQuiz([]);\n    setWeakTopics([]);\n    setCurrentLectureId(null);\n    setCurrentLectureTitle(\"\");\n    setCurrentLectureContent(\"\");\n    setIsDailyQuiz(false);\n    setDailyQuizPlanId(null);\n    setDailyQuizTopics([]);\n    setCurrentSkills([]);\n  }, [currentLectureId, quizResult, weakTopics, userProfile, lectureHistory, perfectScoresCount, updateLectureMutation, updateProfileMutation, currentSkills]);\n\n  const handleUseHint = useCallback(() => {\n    const updatedPowerUps = {\n      ...userProfile.powerUps,\n      hints: Math.max(0, userProfile.powerUps.hints - 1),\n    };\n    updateProfileMutation.mutate({ powerUps: updatedPowerUps });\n  }, [userProfile.powerUps, updateProfileMutation]);\n\n  const handleUseSecondChance = useCallback(() => {\n    const updatedPowerUps = {\n      ...userProfile.powerUps,\n      secondChance: Math.max(0, userProfile.powerUps.secondChance - 1),\n    };\n    updateProfileMutation.mutate({ powerUps: updatedPowerUps });\n  }, [userProfile.powerUps, updateProfileMutation]);\n\n  const handleDismissAchievement = useCallback((id: string) => {\n    setPendingAchievements((prev) => prev.filter((a) => a.id !== id));\n  }, []);\n\n  const handleNavigate = useCallback((view: \"dashboard\" | \"upload\" | \"achievements\") => {\n    setCurrentView(view);\n  }, []);\n\n  const renderView = () => {\n    switch (currentView) {\n      case \"upload\":\n        return (\n          <UploadView\n            onSave={handleSaveLecture}\n            onBack={() => setCurrentView(\"dashboard\")}\n            isSaving={addLectureMutation.isPending}\n            error={addLectureMutation.error?.message || null}\n          />\n        );\n\n      case \"quiz\":\n        return (\n          <QuizView\n            questions={currentQuiz}\n            lectureTitle={currentLectureTitle}\n            userProfile={userProfile}\n            onComplete={handleQuizComplete}\n            onUseHint={handleUseHint}\n            onUseSecondChance={handleUseSecondChance}\n            isDaily={false}\n          />\n        );\n\n      case \"results\":\n        return quizResult ? (\n          <QuizResults\n            result={quizResult}\n            newAchievements={newAchievements}\n            skills={currentSkills}\n            onContinue={() => setCurrentView(\"confidence\")}\n            isDaily={false}\n          />\n        ) : null;\n\n      case \"confidence\":\n        return (\n          <ConfidenceRating\n            weakTopics={weakTopics}\n            onSubmit={handleConfidenceSubmit}\n          />\n        );\n\n      case \"achievements\":\n        return (\n          <AchievementsView\n            achievements={userProfile.achievements}\n            onBack={() => setCurrentView(\"dashboard\")}\n          />\n        );\n\n      case \"loading\":\n        return (\n          <div \n            className=\"flex flex-col items-center justify-center min-h-[60vh] gap-6\" \n            data-testid=\"view-loading\"\n            role=\"status\"\n            aria-live=\"polite\"\n            aria-label=\"Generating quiz\"\n          >\n            <div className=\"relative\" aria-hidden=\"true\">\n              <div className=\"w-16 h-16 border-4 border-primary/20 rounded-full\" />\n              <div className=\"absolute top-0 left-0 w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin\" />\n            </div>\n            <div className=\"text-center space-y-2\">\n              <h2 className=\"text-xl font-serif text-foreground\">Generating Your Quiz</h2>\n              <p className=\"text-muted-foreground\">Our AI is crafting personalized questions from your lecture...</p>\n            </div>\n          </div>\n        );\n\n      case \"dashboard\":\n      default:\n        return (\n          <Dashboard\n            userProfile={userProfile}\n            lectureHistory={lectureHistory}\n            onStartUpload={() => setCurrentView(\"upload\")}\n            onStartReview={handleStartReview}\n            onViewAchievements={() => setCurrentView(\"achievements\")}\n            onDeleteLecture={(id) => deleteLectureMutation.mutate(id)}\n            onStartDailyQuiz={handleStartDailyQuiz}\n          />\n        );\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Header \n        userProfile={userProfile} \n        onNavigate={handleNavigate}\n        currentView={currentView}\n      />\n      \n      <main>\n        {renderView()}\n      </main>\n\n      {showLevelUp && (\n        <LevelUpOverlay\n          newLevel={newLevel}\n          rewards={levelUpRewards}\n          onContinue={() => setShowLevelUp(false)}\n        />\n      )}\n\n      {pendingAchievements.length > 0 && (\n        <AchievementToastStack\n          achievements={pendingAchievements}\n          onDismiss={handleDismissAchievement}\n        />\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":19661,"size_tokens":null},"client/src/components/achievement-toast.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { Trophy, X } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport type { Achievement } from \"@shared/schema\";\n\ninterface AchievementToastProps {\n  achievement: Achievement;\n  onDismiss: () => void;\n}\n\nexport function AchievementToast({ achievement, onDismiss }: AchievementToastProps) {\n  const [isVisible, setIsVisible] = useState(false);\n\n  useEffect(() => {\n    requestAnimationFrame(() => setIsVisible(true));\n\n    const timer = setTimeout(() => {\n      setIsVisible(false);\n      setTimeout(onDismiss, 300);\n    }, 4000);\n\n    return () => clearTimeout(timer);\n  }, [onDismiss]);\n\n  return (\n    <div\n      className={`fixed top-4 right-4 z-50 max-w-sm transition-all duration-300 ${\n        isVisible ? \"translate-x-0 opacity-100\" : \"translate-x-full opacity-0\"\n      }`}\n      role=\"alert\"\n      aria-live=\"assertive\"\n    >\n      <div className=\"flex items-start gap-4 p-4 rounded-lg bg-card border border-gold/30 shadow-xl achievement-glow\">\n        <div className=\"flex h-12 w-12 items-center justify-center rounded-lg bg-gold/20 text-2xl flex-shrink-0\">\n          {getAchievementIcon(achievement.icon)}\n        </div>\n        \n        <div className=\"flex-1 min-w-0\">\n          <div className=\"flex items-center gap-2 mb-1\">\n            <Trophy className=\"h-4 w-4 text-gold\" aria-hidden=\"true\" />\n            <span className=\"text-xs font-medium text-gold uppercase tracking-wide\">\n              Achievement Unlocked!\n            </span>\n          </div>\n          <p className=\"font-semibold\">{achievement.name}</p>\n          <p className=\"text-sm text-muted-foreground\">\n            {achievement.description}\n          </p>\n        </div>\n\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          onClick={() => {\n            setIsVisible(false);\n            setTimeout(onDismiss, 300);\n          }}\n          className=\"flex-shrink-0 h-8 w-8\"\n          aria-label=\"Dismiss notification\"\n        >\n          <X className=\"h-4 w-4\" aria-hidden=\"true\" />\n        </Button>\n      </div>\n    </div>\n  );\n}\n\ninterface AchievementToastStackProps {\n  achievements: Achievement[];\n  onDismiss: (id: string) => void;\n}\n\nexport function AchievementToastStack({ achievements, onDismiss }: AchievementToastStackProps) {\n  return (\n    <div className=\"fixed top-4 right-4 z-50 space-y-3\">\n      {achievements.map((achievement, index) => (\n        <div\n          key={achievement.id}\n          style={{ transform: `translateY(${index * 8}px)` }}\n        >\n          <AchievementToast\n            achievement={achievement}\n            onDismiss={() => onDismiss(achievement.id)}\n          />\n        </div>\n      ))}\n    </div>\n  );\n}\n\nfunction getAchievementIcon(iconName: string): string {\n  const icons: Record<string, string> = {\n    footprints: \"\",\n    zap: \"\",\n    \"book-open\": \"\",\n    \"trending-up\": \"\",\n    star: \"\",\n    flame: \"\",\n    crown: \"\",\n    moon: \"\",\n    sunrise: \"\",\n    target: \"\",\n    search: \"\",\n  };\n  return icons[iconName] || \"\";\n}\n","path":null,"size_bytes":3094,"size_tokens":null},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","path":null,"size_bytes":844,"size_tokens":null},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","path":null,"size_bytes":1251,"size_tokens":null},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","path":null,"size_bytes":1383,"size_tokens":null},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { ThemeProvider } from \"@/components/theme-provider\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport Home from \"@/pages/home\";\nimport Landing from \"@/pages/landing\";\nimport NotFound from \"@/pages/not-found\";\n\nfunction Router() {\n  const { isAuthenticated, isLoading } = useAuth();\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"animate-pulse text-muted-foreground\">Loading...</div>\n      </div>\n    );\n  }\n\n  if (!isAuthenticated) {\n    return <Landing />;\n  }\n\n  return (\n    <Switch>\n      <Route path=\"/\" component={Home} />\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <ThemeProvider defaultTheme=\"dark\">\n        <TooltipProvider>\n          <Router />\n          <Toaster />\n        </TooltipProvider>\n      </ThemeProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","path":null,"size_bytes":1242,"size_tokens":null},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","path":null,"size_bytes":1592,"size_tokens":null},"client/src/lib/game-utils.ts":{"content":"import type { UserProfile, Achievement, Lecture } from \"@shared/schema\";\nimport { LEVEL_TITLES } from \"@shared/schema\";\n\n// Calculate level from total XP\n// Formula: Level = floor(sqrt(totalXP / 100))\nexport function calculateLevel(totalXP: number): number {\n  return Math.max(1, Math.floor(Math.sqrt(totalXP / 100)));\n}\n\n// Calculate XP needed for next level\n// Formula: ((level + 1)^2) * 100\nexport function xpForNextLevel(level: number): number {\n  return Math.pow(level + 1, 2) * 100;\n}\n\n// Calculate XP progress within current level\nexport function xpProgressInLevel(totalXP: number, level: number): number {\n  const currentLevelXP = Math.pow(level, 2) * 100;\n  const nextLevelXP = xpForNextLevel(level);\n  return totalXP - currentLevelXP;\n}\n\n// Calculate XP needed to reach next level from current position\nexport function xpToNextLevel(totalXP: number, level: number): number {\n  const nextLevelXP = xpForNextLevel(level);\n  return nextLevelXP - totalXP;\n}\n\n// Get level title\nexport function getLevelTitle(level: number): string {\n  return LEVEL_TITLES[Math.min(level, 15)] || LEVEL_TITLES[15];\n}\n\n// Calculate XP for quiz completion\nexport function calculateXP(\n  correctAnswers: number,\n  totalQuestions: number,\n  isPerfect: boolean,\n  confidenceRating: number,\n  isImprovement: boolean,\n  currentStreak: number,\n  isDoubleXP: boolean = false\n): number {\n  let xp = 50; // base XP\n  xp += correctAnswers * 10; // per correct answer\n  if (isPerfect) xp += 50; // perfect score bonus\n  xp += confidenceRating * 5; // confidence bonus\n  if (isImprovement) xp += 20; // improvement bonus\n  xp += currentStreak * 5; // streak bonus\n\n  // Apply streak multiplier\n  if (currentStreak >= 30) xp *= 2;\n  else if (currentStreak >= 7) xp *= 1.5;\n\n  // Apply double XP power-up\n  if (isDoubleXP) xp *= 2;\n\n  return Math.floor(xp);\n}\n\n// Get streak multiplier text\nexport function getStreakMultiplier(streak: number): string {\n  if (streak >= 30) return \"2x XP\";\n  if (streak >= 7) return \"1.5x XP\";\n  return \"\";\n}\n\n// Get performance message based on score\nexport function getPerformanceMessage(\n  score: number,\n  total: number,\n  isImprovement: boolean = false,\n  improvementPercent: number = 0\n): { message: string; type: \"perfect\" | \"good\" | \"struggling\" | \"improvement\" } {\n  const percent = (score / total) * 100;\n\n  if (isImprovement && improvementPercent >= 15) {\n    return {\n      message: `+${Math.round(improvementPercent)}% improvement! You're leveling up!`,\n      type: \"improvement\",\n    };\n  }\n\n  if (percent === 100) {\n    return { message: \"FLAWLESS! You're unstoppable!\", type: \"perfect\" };\n  }\n\n  if (percent >= 70) {\n    return { message: \"Solid work! Keep pushing!\", type: \"good\" };\n  }\n\n  return {\n    message: \"Growth happens outside comfort zones!\",\n    type: \"struggling\",\n  };\n}\n\n// Get confidence message\nexport function getConfidenceMessage(rating: number): { message: string; xp: number } {\n  if (rating <= 2) {\n    return { message: \"Honesty is the first step to mastery!\", xp: 10 };\n  }\n  if (rating === 3) {\n    return { message: \"You're on your way!\", xp: 15 };\n  }\n  return { message: \"Confidence is key!\", xp: 25 };\n}\n\n// Get motivational quote\nexport function getMotivationalQuote(): string {\n  const quotes = [\n    \"You're crushing it!\",\n    \"Consistency is your superpower!\",\n    \"Every question makes you stronger!\",\n    \"Building your knowledge empire!\",\n    \"Leveling up your brain!\",\n    \"Knowledge is power!\",\n    \"One step closer to mastery!\",\n    \"Your dedication is showing!\",\n  ];\n  return quotes[Math.floor(Math.random() * quotes.length)];\n}\n\n// Check all achievements\nexport function checkAchievements(\n  userProfile: UserProfile,\n  lectureHistory: Lecture[],\n  currentHour: number = new Date().getHours(),\n  perfectScores: number = 0\n): Achievement[] {\n  const newlyUnlocked: Achievement[] = [];\n  const now = new Date().toISOString().split(\"T\")[0];\n\n  userProfile.achievements.forEach((achievement) => {\n    if (achievement.unlocked) return;\n\n    let shouldUnlock = false;\n    let newProgress = achievement.progress || 0;\n\n    switch (achievement.id) {\n      case \"first_steps\":\n        shouldUnlock = lectureHistory.length >= 1;\n        newProgress = Math.min(1, lectureHistory.length);\n        break;\n\n      case \"quick_learner\":\n        shouldUnlock = lectureHistory.some((l) => l.reviewScore === 100);\n        newProgress = lectureHistory.some((l) => l.reviewScore === 100) ? 1 : 0;\n        break;\n\n      case \"dedicated_student\":\n        shouldUnlock = lectureHistory.length >= 5;\n        newProgress = Math.min(5, lectureHistory.length);\n        break;\n\n      case \"comeback_kid\":\n        const hasImprovement = lectureHistory.some((lecture) =>\n          lecture.dailyQuizzes.some((dq) => dq.improvement >= 30)\n        );\n        shouldUnlock = hasImprovement;\n        newProgress = hasImprovement ? 1 : 0;\n        break;\n\n      case \"confident_scholar\":\n        shouldUnlock = lectureHistory.some((l) => l.confidenceRating === 5);\n        newProgress = lectureHistory.some((l) => l.confidenceRating === 5) ? 1 : 0;\n        break;\n\n      case \"week_warrior\":\n        shouldUnlock = userProfile.currentStreak >= 7;\n        newProgress = Math.min(7, userProfile.currentStreak);\n        break;\n\n      case \"topic_master\":\n        const masteredCount = userProfile.masteredTopics.length;\n        shouldUnlock = masteredCount >= 3;\n        newProgress = Math.min(3, masteredCount);\n        break;\n\n      case \"night_owl\":\n        shouldUnlock = currentHour >= 20;\n        newProgress = currentHour >= 20 ? 1 : 0;\n        break;\n\n      case \"early_bird\":\n        shouldUnlock = currentHour < 12;\n        newProgress = currentHour < 12 ? 1 : 0;\n        break;\n\n      case \"perfectionist\":\n        shouldUnlock = perfectScores >= 10;\n        newProgress = Math.min(10, perfectScores);\n        break;\n\n      case \"knowledge_seeker\":\n        shouldUnlock = lectureHistory.length >= 10;\n        newProgress = Math.min(10, lectureHistory.length);\n        break;\n    }\n\n    achievement.progress = newProgress;\n\n    if (shouldUnlock && !achievement.unlocked) {\n      achievement.unlocked = true;\n      achievement.unlockedDate = now;\n      newlyUnlocked.push(achievement);\n    }\n  });\n\n  return newlyUnlocked;\n}\n\n// Extract topics from question text for weakness identification\nexport function extractTopics(questionText: string): string[] {\n  const topics: string[] = [];\n  \n  // Look for capitalized terms (potential technical terms)\n  const capitalizedWords = questionText.match(/\\b[A-Z][a-zA-Z]+(?:\\s+[A-Z][a-zA-Z]+)*/g);\n  if (capitalizedWords) {\n    topics.push(...capitalizedWords.filter(w => w.length > 3));\n  }\n\n  // Look for quoted terms\n  const quotedTerms = questionText.match(/\"([^\"]+)\"/g) || questionText.match(/'([^']+)'/g);\n  if (quotedTerms) {\n    topics.push(...quotedTerms.map(t => t.replace(/['\"]/g, '')));\n  }\n\n  // Common CS/academic keywords\n  const keywords = [\n    \"array\", \"linked list\", \"stack\", \"queue\", \"tree\", \"graph\", \"hash\",\n    \"sort\", \"search\", \"recursion\", \"iteration\", \"loop\", \"function\",\n    \"variable\", \"pointer\", \"memory\", \"algorithm\", \"complexity\",\n    \"data structure\", \"object\", \"class\", \"inheritance\", \"polymorphism\"\n  ];\n  \n  const lowerText = questionText.toLowerCase();\n  keywords.forEach(keyword => {\n    if (lowerText.includes(keyword)) {\n      topics.push(keyword.split(' ').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' '));\n    }\n  });\n\n  // Deduplicate and limit\n  return Array.from(new Set(topics)).slice(0, 5);\n}\n\n// Get topic mastery color based on progress percentage\nexport function getTopicMasteryColor(progress: number): {\n  bg: string;\n  text: string;\n  label: string;\n} {\n  if (progress >= 71) {\n    return { bg: \"bg-success\", text: \"text-success\", label: \"Mastered\" };\n  }\n  if (progress >= 41) {\n    return { bg: \"bg-gold\", text: \"text-gold\", label: \"Developing\" };\n  }\n  return { bg: \"bg-destructive\", text: \"text-destructive\", label: \"Learning\" };\n}\n\n// Calculate topic mastery percentage\nexport function calculateTopicMastery(\n  topic: string,\n  lectureHistory: Lecture[]\n): number {\n  const relatedLectures = lectureHistory.filter(\n    (l) =>\n      l.incorrectTopics.includes(topic) ||\n      l.content.toLowerCase().includes(topic.toLowerCase())\n  );\n\n  if (relatedLectures.length === 0) return 0;\n\n  const avgScore =\n    relatedLectures.reduce((sum, l) => sum + l.reviewScore, 0) /\n    relatedLectures.length;\n\n  return Math.round(avgScore);\n}\n\n// Check if streak should be broken (more than 24 hours since last activity)\nexport function shouldBreakStreak(lastActivityDate?: string): boolean {\n  if (!lastActivityDate) return false;\n  \n  const last = new Date(lastActivityDate);\n  const now = new Date();\n  const hoursDiff = (now.getTime() - last.getTime()) / (1000 * 60 * 60);\n  \n  return hoursDiff > 48; // Break streak if more than 48 hours\n}\n\n// Format date for display\nexport function formatDate(dateString: string): string {\n  const date = new Date(dateString);\n  const now = new Date();\n  const diff = now.getTime() - date.getTime();\n  const days = Math.floor(diff / (1000 * 60 * 60 * 24));\n\n  if (days === 0) return \"Today\";\n  if (days === 1) return \"Yesterday\";\n  if (days < 7) return `${days} days ago`;\n\n  return date.toLocaleDateString(\"en-US\", {\n    month: \"short\",\n    day: \"numeric\",\n  });\n}\n\n// Generate unique ID\nexport function generateId(): string {\n  return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n}\n","path":null,"size_bytes":9461,"size_tokens":null},"client/src/components/theme-provider.tsx":{"content":"import { createContext, useContext, useEffect, useState } from \"react\";\n\ntype Theme = \"dark\" | \"light\";\n\ntype ThemeProviderContextType = {\n  theme: Theme;\n  setTheme: (theme: Theme) => void;\n  toggleTheme: () => void;\n};\n\nconst ThemeProviderContext = createContext<ThemeProviderContextType | undefined>(undefined);\n\ninterface ThemeProviderProps {\n  children: React.ReactNode;\n  defaultTheme?: Theme;\n}\n\nexport function ThemeProvider({ children, defaultTheme = \"dark\" }: ThemeProviderProps) {\n  const [theme, setThemeState] = useState<Theme>(() => {\n    if (typeof window !== \"undefined\") {\n      const stored = localStorage.getItem(\"lecturequest-theme\") as Theme;\n      return stored || defaultTheme;\n    }\n    return defaultTheme;\n  });\n\n  useEffect(() => {\n    const root = document.documentElement;\n    root.classList.remove(\"light\", \"dark\");\n    root.classList.add(theme);\n    localStorage.setItem(\"lecturequest-theme\", theme);\n  }, [theme]);\n\n  const setTheme = (newTheme: Theme) => {\n    setThemeState(newTheme);\n  };\n\n  const toggleTheme = () => {\n    setThemeState((prev) => (prev === \"dark\" ? \"light\" : \"dark\"));\n  };\n\n  return (\n    <ThemeProviderContext.Provider value={{ theme, setTheme, toggleTheme }}>\n      {children}\n    </ThemeProviderContext.Provider>\n  );\n}\n\nexport function useTheme() {\n  const context = useContext(ThemeProviderContext);\n  if (!context) {\n    throw new Error(\"useTheme must be used within a ThemeProvider\");\n  }\n  return context;\n}\n","path":null,"size_bytes":1470,"size_tokens":null},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","path":null,"size_bytes":325,"size_tokens":null},"client/src/components/confidence-rating.tsx":{"content":"import { useState } from \"react\";\nimport { Star, Zap, ArrowRight } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { getConfidenceMessage } from \"@/lib/game-utils\";\n\ninterface ConfidenceRatingProps {\n  weakTopics: string[];\n  onSubmit: (rating: number) => void;\n}\n\nexport function ConfidenceRating({ weakTopics, onSubmit }: ConfidenceRatingProps) {\n  const [rating, setRating] = useState(0);\n  const [hoveredRating, setHoveredRating] = useState(0);\n\n  const displayRating = hoveredRating || rating;\n  const confidenceInfo = getConfidenceMessage(displayRating || 3);\n\n  const handleSubmit = () => {\n    if (rating > 0) {\n      onSubmit(rating);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen\">\n      <div className=\"max-w-md mx-auto px-6 py-16 animate-fade-in\">\n        <div className=\"text-center mb-12\">\n          <h1 className=\"font-serif text-display-sm tracking-tight mb-3\">\n            Rate Your Confidence\n          </h1>\n          <p className=\"text-lg text-muted-foreground leading-relaxed\">\n            How well do you understand this material?\n          </p>\n        </div>\n\n        <div className=\"space-y-8\">\n          <div \n            className=\"flex justify-center gap-2\"\n            role=\"radiogroup\"\n            aria-label=\"Confidence rating from 1 to 5 stars\"\n          >\n            {[1, 2, 3, 4, 5].map((value) => (\n              <button\n                key={value}\n                onClick={() => setRating(value)}\n                onMouseEnter={() => setHoveredRating(value)}\n                onMouseLeave={() => setHoveredRating(0)}\n                onFocus={() => setHoveredRating(value)}\n                onBlur={() => setHoveredRating(0)}\n                className=\"p-3 rounded-xl focus:outline-none focus-visible:ring-2 focus-visible:ring-ring transition-colors duration-200\"\n                role=\"radio\"\n                aria-checked={rating === value}\n                aria-label={`${value} star${value > 1 ? \"s\" : \"\"}`}\n                data-testid={`star-${value}`}\n              >\n                <Star\n                  className={`h-10 w-10 transition-all duration-200 ${\n                    value <= displayRating\n                      ? \"fill-gold text-gold\"\n                      : \"text-muted-foreground/30\"\n                  }`}\n                  aria-hidden=\"true\"\n                />\n              </button>\n            ))}\n          </div>\n\n          <div className=\"min-h-[80px] text-center\">\n            {displayRating > 0 && (\n              <div className=\"space-y-2 animate-fade-in\">\n                <p className=\"font-serif text-xl\">{confidenceInfo.message}</p>\n                <p className=\"text-gold flex items-center justify-center gap-1.5 font-medium\">\n                  <Zap className=\"h-4 w-4\" aria-hidden=\"true\" />\n                  +{confidenceInfo.xp} XP bonus\n                </p>\n              </div>\n            )}\n          </div>\n\n          {weakTopics.length > 0 && (\n            <Card>\n              <CardContent className=\"p-5\">\n                <p className=\"font-medium mb-3\">Topics to review:</p>\n                <ul className=\"space-y-2\">\n                  {weakTopics.map((topic, i) => (\n                    <li \n                      key={i}\n                      className=\"text-muted-foreground flex items-center gap-3\"\n                    >\n                      <span className=\"h-1.5 w-1.5 rounded-full bg-primary flex-shrink-0\" />\n                      {topic}\n                    </li>\n                  ))}\n                </ul>\n              </CardContent>\n            </Card>\n          )}\n\n          <Button\n            onClick={handleSubmit}\n            disabled={rating === 0}\n            className=\"w-full gap-2 rounded-xl\"\n            size=\"lg\"\n            data-testid=\"button-submit-rating\"\n          >\n            Continue to Dashboard\n            <ArrowRight className=\"h-4 w-4\" aria-hidden=\"true\" />\n          </Button>\n\n          <p className=\"text-center text-muted-foreground\">\n            Higher confidence ratings earn bonus XP\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":4168,"size_tokens":null},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".75rem\",\n        md: \".5rem\",\n        sm: \".25rem\",\n      },\n      colors: {\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        gold: {\n          DEFAULT: \"hsl(var(--gold) / <alpha-value>)\",\n          foreground: \"hsl(var(--gold-foreground) / <alpha-value>)\",\n        },\n        success: {\n          DEFAULT: \"hsl(var(--success) / <alpha-value>)\",\n          foreground: \"hsl(var(--success-foreground) / <alpha-value>)\",\n        },\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"'Figtree'\", \"system-ui\", \"sans-serif\"],\n        serif: [\"'EB Garamond'\", \"Georgia\", \"serif\"],\n        mono: [\"'JetBrains Mono'\", \"monospace\"],\n      },\n      fontSize: {\n        \"display-lg\": [\"4.5rem\", { lineHeight: \"1.1\", letterSpacing: \"-0.02em\" }],\n        \"display\": [\"3.5rem\", { lineHeight: \"1.15\", letterSpacing: \"-0.02em\" }],\n        \"display-sm\": [\"2.5rem\", { lineHeight: \"1.2\", letterSpacing: \"-0.01em\" }],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n        \"fade-in\": {\n          \"0%\": { opacity: \"0\", transform: \"translateY(8px)\" },\n          \"100%\": { opacity: \"1\", transform: \"translateY(0)\" },\n        },\n        \"float-up\": {\n          \"0%\": { opacity: \"1\", transform: \"translateY(0) scale(1)\" },\n          \"100%\": { opacity: \"0\", transform: \"translateY(-40px) scale(1.1)\" },\n        },\n        shake: {\n          \"0%, 100%\": { transform: \"translateX(0)\" },\n          \"10%, 30%, 50%, 70%, 90%\": { transform: \"translateX(-3px)\" },\n          \"20%, 40%, 60%, 80%\": { transform: \"translateX(3px)\" },\n        },\n        \"gold-pulse\": {\n          \"0%, 100%\": { boxShadow: \"0 0 8px hsl(var(--gold) / 0.3)\" },\n          \"50%\": { boxShadow: \"0 0 16px hsl(var(--gold) / 0.5)\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n        \"fade-in\": \"fade-in 0.4s ease-out\",\n        \"float-up\": \"float-up 1.2s ease-out forwards\",\n        shake: \"shake 0.4s ease-in-out\",\n        \"gold-pulse\": \"gold-pulse 2s ease-in-out infinite\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","path":null,"size_bytes":5536,"size_tokens":null},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","path":null,"size_bytes":2154,"size_tokens":null},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","path":null,"size_bytes":1723,"size_tokens":null},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","path":null,"size_bytes":1904,"size_tokens":null},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","path":null,"size_bytes":1202,"size_tokens":null},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","path":null,"size_bytes":1077,"size_tokens":null},"client/src/components/quiz-results.tsx":{"content":"import { TrendingUp, Award, ArrowRight, Zap, Target, Trophy, Briefcase, Brain, Lightbulb } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { getPerformanceMessage } from \"@/lib/game-utils\";\nimport type { QuizResult, Achievement, TransferableSkill } from \"@shared/schema\";\n\ninterface QuizResultsProps {\n  result: QuizResult;\n  newAchievements: Achievement[];\n  skills?: TransferableSkill[];\n  onContinue: () => void;\n  isDaily?: boolean;\n  previousScore?: number;\n}\n\nexport function QuizResults({\n  result,\n  newAchievements,\n  skills = [],\n  onContinue,\n  isDaily = false,\n  previousScore,\n}: QuizResultsProps) {\n  const isImprovement = isDaily && previousScore !== undefined && result.accuracyPercent > previousScore;\n  const improvementPercent = isImprovement ? result.accuracyPercent - previousScore : 0;\n  \n  const performanceInfo = getPerformanceMessage(\n    result.score,\n    result.total,\n    isImprovement,\n    improvementPercent\n  );\n\n  return (\n    <div className=\"min-h-screen\">\n      <div className=\"max-w-md mx-auto px-6 py-16 animate-fade-in\">\n        <div className=\"text-center mb-10\" role=\"status\" aria-live=\"polite\">\n          <h1 className=\"font-serif text-display-sm tracking-tight mb-3\">\n            {isDaily ? \"Daily Quiz Complete\" : \"Quiz Complete\"}\n          </h1>\n          <p className=\"text-lg text-muted-foreground leading-relaxed\">\n            {performanceInfo.message}\n          </p>\n        </div>\n\n        <div className=\"space-y-5\">\n          <div className=\"grid grid-cols-2 gap-4\" role=\"group\" aria-label=\"Quiz results summary\">\n            <Card className=\"card-hover\" aria-label={`${result.score} out of ${result.total} correct answers`}>\n              <CardContent className=\"p-6 text-center\">\n                <div className=\"flex items-center justify-center gap-2 mb-2\">\n                  <Target className=\"h-5 w-5 text-primary\" aria-hidden=\"true\" />\n                </div>\n                <p className=\"text-3xl font-semibold tabular-nums\">\n                  {result.score}/{result.total}\n                </p>\n                <p className=\"text-sm text-muted-foreground mt-1\">Correct Answers</p>\n              </CardContent>\n            </Card>\n            \n            <Card className=\"card-hover\" aria-label={`${result.accuracyPercent} percent accuracy`}>\n              <CardContent className=\"p-6 text-center\">\n                <div className=\"flex items-center justify-center gap-2 mb-2\">\n                  <Award className={`h-5 w-5 ${\n                    result.accuracyPercent >= 80 \n                      ? \"text-success\" \n                      : result.accuracyPercent >= 60 \n                      ? \"text-gold\" \n                      : \"text-muted-foreground\"\n                  }`} aria-hidden=\"true\" />\n                </div>\n                <p className={`text-3xl font-semibold tabular-nums ${\n                  result.accuracyPercent >= 80 \n                    ? \"text-success\" \n                    : result.accuracyPercent >= 60 \n                    ? \"text-gold\" \n                    : \"\"\n                }`}>\n                  {result.accuracyPercent}%\n                </p>\n                <p className=\"text-sm text-muted-foreground mt-1\">Accuracy</p>\n              </CardContent>\n            </Card>\n          </div>\n\n          <Card className=\"border-gold/30 bg-gold/5 gold-glow\" role=\"status\" aria-label={`${result.xpEarned} experience points earned`}>\n            <CardContent className=\"p-6 text-center\">\n              <div className=\"flex items-center justify-center gap-2 text-gold\">\n                <Zap className=\"h-6 w-6\" aria-hidden=\"true\" />\n                <span className=\"text-3xl font-bold tabular-nums\">+{result.xpEarned} XP</span>\n              </div>\n              <p className=\"text-sm text-muted-foreground mt-2\">Experience Earned</p>\n            </CardContent>\n          </Card>\n\n          {isImprovement && (\n            <Card className=\"border-primary/30 bg-primary/5\">\n              <CardContent className=\"p-5\">\n                <div className=\"flex items-center justify-center gap-3 text-primary\">\n                  <TrendingUp className=\"h-5 w-5\" aria-hidden=\"true\" />\n                  <span className=\"font-medium text-lg\">\n                    +{Math.round(improvementPercent)}% improvement!\n                  </span>\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          {result.incorrectTopics.length > 0 && (\n            <div className=\"space-y-3\" role=\"region\" aria-label=\"Topics to review\">\n              <h2 className=\"font-medium\">Topics to review:</h2>\n              <div className=\"flex flex-wrap gap-2\" role=\"list\">\n                {result.incorrectTopics.map((topic, i) => (\n                  <Badge \n                    key={i} \n                    variant=\"secondary\"\n                    className=\"font-normal px-3 py-1\"\n                    role=\"listitem\"\n                  >\n                    {topic}\n                  </Badge>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {skills.length > 0 && (\n            <Card className=\"border-primary/20 bg-primary/5\" data-testid=\"card-skills-developing\" role=\"region\" aria-label=\"Skills you're developing\">\n              <CardContent className=\"p-5\">\n                <h2 className=\"font-medium mb-4 flex items-center gap-2\">\n                  <Lightbulb className=\"h-5 w-5 text-primary\" aria-hidden=\"true\" />\n                  Skills You're Developing\n                </h2>\n                <div className=\"space-y-4\">\n                  {skills.slice(0, 4).map((skill, index) => (\n                    <div key={index} className=\"space-y-2\">\n                      <div className=\"flex items-start gap-3\">\n                        <div className=\"flex h-8 w-8 items-center justify-center rounded-lg bg-primary/10 flex-shrink-0\">\n                          <Brain className=\"h-4 w-4 text-primary\" aria-hidden=\"true\" />\n                        </div>\n                        <div className=\"flex-1 min-w-0\">\n                          <p className=\"font-medium text-sm\" data-testid={`text-skill-name-${index}`}>{skill.name}</p>\n                          <p className=\"text-xs text-muted-foreground mt-0.5\">{skill.description}</p>\n                        </div>\n                      </div>\n                      <div className=\"pl-11\">\n                        <div className=\"flex items-center gap-1.5 flex-wrap\" data-testid={`text-skill-careers-${index}`}>\n                          <Briefcase className=\"h-3 w-3 text-muted-foreground flex-shrink-0\" aria-hidden=\"true\" />\n                          <span className=\"text-xs text-muted-foreground\">Careers:</span>\n                          {skill.relevantCareers.slice(0, 3).map((career, i) => (\n                            <Badge key={i} variant=\"outline\" className=\"text-xs py-0 px-1.5 font-normal\">\n                              {career}\n                            </Badge>\n                          ))}\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          {newAchievements.length > 0 && (\n            <Card className=\"border-gold/30 bg-gold/5\" role=\"region\" aria-label=\"New achievements unlocked\">\n              <CardContent className=\"p-5\">\n                <h2 className=\"font-medium mb-4 flex items-center gap-2\">\n                  <Trophy className=\"h-5 w-5 text-gold\" aria-hidden=\"true\" />\n                  New Achievements Unlocked\n                </h2>\n                <div className=\"space-y-3\">\n                  {newAchievements.map((achievement) => (\n                    <div \n                      key={achievement.id}\n                      className=\"flex items-center gap-4 p-3 rounded-xl bg-background/50\"\n                    >\n                      <div className=\"flex h-10 w-10 items-center justify-center rounded-lg bg-gold/10\">\n                        <Trophy className=\"h-5 w-5 text-gold\" aria-hidden=\"true\" />\n                      </div>\n                      <div>\n                        <p className=\"font-medium\">{achievement.name}</p>\n                        <p className=\"text-sm text-muted-foreground\">\n                          {achievement.description}\n                        </p>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          <Button\n            onClick={onContinue}\n            className=\"w-full gap-2 rounded-xl\"\n            size=\"lg\"\n            data-testid=\"button-continue\"\n          >\n            {isDaily ? \"Back to Dashboard\" : \"Rate Your Confidence\"}\n            <ArrowRight className=\"h-4 w-4\" aria-hidden=\"true\" />\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":9013,"size_tokens":null},"shared/schema.ts":{"content":"import { z } from \"zod\";\nimport { sql } from \"drizzle-orm\";\nimport { pgTable, text, integer, real, boolean, timestamp, jsonb, serial, varchar, index } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\n\n// ==================== DATABASE TABLES ====================\n\n// Session storage table for Replit Auth\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: jsonb(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => [index(\"IDX_session_expire\").on(table.expire)],\n);\n\n// User profile table with Replit Auth integration\nexport const usersTable = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar(\"email\").unique(),\n  firstName: varchar(\"first_name\"),\n  lastName: varchar(\"last_name\"),\n  profileImageUrl: varchar(\"profile_image_url\"),\n  level: integer(\"level\").notNull().default(1),\n  totalXP: integer(\"total_xp\").notNull().default(0),\n  xpToNextLevel: integer(\"xp_to_next_level\").notNull().default(400),\n  currentStreak: integer(\"current_streak\").notNull().default(0),\n  longestStreak: integer(\"longest_streak\").notNull().default(0),\n  totalLectures: integer(\"total_lectures\").notNull().default(0),\n  averageConfidence: real(\"average_confidence\").notNull().default(0),\n  achievements: jsonb(\"achievements\").notNull().default([]),\n  masteredTopics: jsonb(\"mastered_topics\").notNull().default([]),\n  needsPractice: jsonb(\"needs_practice\").notNull().default([]),\n  powerUps: jsonb(\"power_ups\").notNull().default({}),\n  lastActivityDate: text(\"last_activity_date\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// Lectures table - stores uploaded lecture content\nexport const lecturesTable = pgTable(\"lectures\", {\n  id: serial(\"id\").primaryKey(),\n  userId: varchar(\"user_id\").notNull(),\n  title: text(\"title\").notNull(),\n  date: text(\"date\").notNull(),\n  content: text(\"content\").notNull(),\n  reviewScore: integer(\"review_score\").notNull().default(0),\n  xpEarned: integer(\"xp_earned\").notNull().default(0),\n  incorrectTopics: jsonb(\"incorrect_topics\").notNull().default([]),\n  confidenceRating: integer(\"confidence_rating\").notNull().default(0),\n  dailyQuizzes: jsonb(\"daily_quizzes\").notNull().default([]),\n  needsReview: boolean(\"needs_review\").notNull().default(true),\n  lastReviewed: text(\"last_reviewed\"),\n  identifiedSkills: jsonb(\"identified_skills\").notNull().default([]),\n  questionsAnswered: integer(\"questions_answered\").notNull().default(0),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Topic review stats for spaced repetition algorithm\nexport const topicReviewStatsTable = pgTable(\"topic_review_stats\", {\n  id: serial(\"id\").primaryKey(),\n  userId: varchar(\"user_id\").notNull(),\n  topic: text(\"topic\").notNull(),\n  lectureId: integer(\"lecture_id\").notNull(),\n  lectureTitle: text(\"lecture_title\").notNull(),\n  lastReviewed: text(\"last_reviewed\").notNull(),\n  lastScore: integer(\"last_score\").notNull().default(0),\n  reviewCount: integer(\"review_count\").notNull().default(1),\n  easeFactor: real(\"ease_factor\").notNull().default(2.5),\n  interval: integer(\"interval\").notNull().default(1),\n  nextDue: text(\"next_due\").notNull(),\n  streak: integer(\"streak\").notNull().default(0),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Review events history\nexport const reviewEventsTable = pgTable(\"review_events\", {\n  id: serial(\"id\").primaryKey(),\n  userId: varchar(\"user_id\").notNull(),\n  topicId: text(\"topic_id\").notNull(),\n  topic: text(\"topic\").notNull(),\n  lectureId: integer(\"lecture_id\").notNull(),\n  date: text(\"date\").notNull(),\n  score: integer(\"score\").notNull(),\n  responseTime: integer(\"response_time\"),\n  wasCorrect: boolean(\"was_correct\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Daily quiz plans\nexport const dailyQuizPlansTable = pgTable(\"daily_quiz_plans\", {\n  id: serial(\"id\").primaryKey(),\n  userId: varchar(\"user_id\").notNull(),\n  generatedAt: text(\"generated_at\").notNull(),\n  topics: jsonb(\"topics\").notNull().default([]),\n  lectureExcerpts: jsonb(\"lecture_excerpts\").notNull().default([]),\n  completed: boolean(\"completed\").notNull().default(false),\n  completedAt: text(\"completed_at\"),\n  score: integer(\"score\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Cached quiz questions for each topic (to avoid regenerating)\nexport const cachedQuestionsTable = pgTable(\"cached_questions\", {\n  id: serial(\"id\").primaryKey(),\n  userId: varchar(\"user_id\").notNull(),\n  topic: text(\"topic\").notNull(),\n  lectureId: integer(\"lecture_id\").notNull(),\n  question: text(\"question\").notNull(),\n  options: jsonb(\"options\").notNull(),\n  correct: integer(\"correct\").notNull(),\n  explanation: text(\"explanation\").notNull(),\n  timesUsed: integer(\"times_used\").notNull().default(0),\n  lastUsed: text(\"last_used\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Calendar settings\nexport const calendarSettingsTable = pgTable(\"calendar_settings\", {\n  id: serial(\"id\").primaryKey(),\n  userId: varchar(\"user_id\").notNull(),\n  url: text(\"url\").notNull(),\n  lastSync: text(\"last_sync\"),\n  lastSyncStatus: text(\"last_sync_status\"),\n  lastSyncError: text(\"last_sync_error\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Calendar events\nexport const calendarEventsTable = pgTable(\"calendar_events\", {\n  id: serial(\"id\").primaryKey(),\n  userId: varchar(\"user_id\").notNull(),\n  uid: text(\"uid\").notNull(),\n  title: text(\"title\").notNull(),\n  eventType: text(\"event_type\").notNull(),\n  startsAt: text(\"starts_at\").notNull(),\n  endsAt: text(\"ends_at\").notNull(),\n  location: text(\"location\"),\n  description: text(\"description\"),\n  matchedLectureId: integer(\"matched_lecture_id\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Lecture uploads for batch processing\nexport const lectureUploadsTable = pgTable(\"lecture_uploads\", {\n  id: serial(\"id\").primaryKey(),\n  batchId: varchar(\"batch_id\").notNull(),\n  userId: varchar(\"user_id\").notNull(),\n  filename: varchar(\"filename\"),\n  status: varchar(\"status\", { enum: [\"pending\", \"processing\", \"completed\", \"error\"] }).default(\"pending\"),\n  error: text(\"error\"),\n  lectureId: integer(\"lecture_id\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Dismissed lectures table for \"forget\" feature\nexport const dismissedLecturesTable = pgTable(\"dismissed_lectures\", {\n  id: serial(\"id\").primaryKey(),\n  userId: varchar(\"user_id\").notNull(),\n  calendarEventId: varchar(\"calendar_event_id\").notNull(),\n  dismissedAt: timestamp(\"dismissed_at\").defaultNow(),\n  reason: varchar(\"reason\"),\n});\n\n// Friendships table for social features\nexport const friendshipsTable = pgTable(\"friendships\", {\n  id: serial(\"id\").primaryKey(),\n  userId: varchar(\"user_id\").notNull(),\n  friendId: varchar(\"friend_id\").notNull(),\n  status: varchar(\"status\", { enum: [\"pending\", \"accepted\", \"declined\"] }).default(\"pending\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  acceptedAt: timestamp(\"accepted_at\"),\n});\n\n// Weekly XP logs for leaderboard tracking\nexport const weeklyXpLogsTable = pgTable(\"weekly_xp_logs\", {\n  id: serial(\"id\").primaryKey(),\n  userId: varchar(\"user_id\").notNull(),\n  weekStart: timestamp(\"week_start\").notNull(),\n  xpEarned: integer(\"xp_earned\").default(0),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// Insert schemas\nexport const insertUserSchema = createInsertSchema(usersTable).omit({ id: true, createdAt: true });\nexport const insertLectureSchema = createInsertSchema(lecturesTable).omit({ id: true, createdAt: true });\nexport const insertTopicReviewStatsSchema = createInsertSchema(topicReviewStatsTable).omit({ id: true, createdAt: true });\nexport const insertReviewEventSchema = createInsertSchema(reviewEventsTable).omit({ id: true, createdAt: true });\nexport const insertDailyQuizPlanSchema = createInsertSchema(dailyQuizPlansTable).omit({ id: true, createdAt: true });\nexport const insertCachedQuestionSchema = createInsertSchema(cachedQuestionsTable).omit({ id: true, createdAt: true });\nexport const insertCalendarSettingsSchema = createInsertSchema(calendarSettingsTable).omit({ id: true, createdAt: true });\nexport const insertCalendarEventSchema = createInsertSchema(calendarEventsTable).omit({ id: true, createdAt: true });\nexport const insertLectureUploadSchema = createInsertSchema(lectureUploadsTable).omit({ id: true, createdAt: true });\nexport const insertDismissedLectureSchema = createInsertSchema(dismissedLecturesTable).omit({ id: true, dismissedAt: true });\nexport const insertFriendshipSchema = createInsertSchema(friendshipsTable).omit({ id: true, createdAt: true });\nexport const insertWeeklyXpLogSchema = createInsertSchema(weeklyXpLogsTable).omit({ id: true, updatedAt: true });\n\n// Select types\nexport type DbUser = typeof usersTable.$inferSelect;\nexport type User = typeof usersTable.$inferSelect;\nexport type UpsertUser = typeof usersTable.$inferInsert;\nexport type DbLecture = typeof lecturesTable.$inferSelect;\nexport type DbTopicReviewStats = typeof topicReviewStatsTable.$inferSelect;\nexport type DbReviewEvent = typeof reviewEventsTable.$inferSelect;\nexport type DbDailyQuizPlan = typeof dailyQuizPlansTable.$inferSelect;\nexport type DbCachedQuestion = typeof cachedQuestionsTable.$inferSelect;\nexport type DbCalendarSettings = typeof calendarSettingsTable.$inferSelect;\nexport type DbCalendarEvent = typeof calendarEventsTable.$inferSelect;\nexport type DbLectureUpload = typeof lectureUploadsTable.$inferSelect;\nexport type DbDismissedLecture = typeof dismissedLecturesTable.$inferSelect;\nexport type DbFriendship = typeof friendshipsTable.$inferSelect;\nexport type DbWeeklyXpLog = typeof weeklyXpLogsTable.$inferSelect;\n\n// Insert types\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type InsertLecture = z.infer<typeof insertLectureSchema>;\nexport type InsertTopicReviewStats = z.infer<typeof insertTopicReviewStatsSchema>;\nexport type InsertReviewEvent = z.infer<typeof insertReviewEventSchema>;\nexport type InsertDailyQuizPlan = z.infer<typeof insertDailyQuizPlanSchema>;\nexport type InsertCachedQuestion = z.infer<typeof insertCachedQuestionSchema>;\nexport type InsertCalendarSettings = z.infer<typeof insertCalendarSettingsSchema>;\nexport type InsertCalendarEvent = z.infer<typeof insertCalendarEventSchema>;\nexport type InsertLectureUpload = z.infer<typeof insertLectureUploadSchema>;\nexport type InsertDismissedLecture = z.infer<typeof insertDismissedLectureSchema>;\nexport type InsertFriendship = z.infer<typeof insertFriendshipSchema>;\nexport type InsertWeeklyXpLog = z.infer<typeof insertWeeklyXpLogSchema>;\n\n// Dismissed lecture interface\nexport interface DismissedLecture {\n  id: string;\n  userId: string;\n  calendarEventId: string;\n  dismissedAt: string;\n  reason?: string;\n}\n\n// Friendship interface\nexport interface Friendship {\n  id: string;\n  userId: string;\n  friendId: string;\n  status: \"pending\" | \"accepted\" | \"declined\";\n  createdAt: string;\n  acceptedAt?: string;\n}\n\n// Weekly XP log interface\nexport interface WeeklyXpLog {\n  id: string;\n  userId: string;\n  weekStart: string;\n  xpEarned: number;\n  updatedAt: string;\n}\n\n// ==================== SHARED TYPES ====================\n\n// Transferable skill identified from lecture content\nexport interface TransferableSkill {\n  name: string; // e.g., \"Analytical Thinking\", \"Problem Solving\"\n  description: string; // Brief explanation of the skill\n  category: \"cognitive\" | \"technical\" | \"communication\" | \"interpersonal\" | \"organizational\";\n  relevantCareers: string[]; // Career paths where this skill is valuable\n  proficiencyLevel: \"developing\" | \"intermediate\" | \"proficient\"; // Based on quiz performance\n}\n\n// Question for quizzes\nexport interface Question {\n  question: string;\n  options: string[];\n  correct: number;\n  explanation: string;\n  topic?: string; // Specific concept being tested (AI-generated)\n}\n\n// Quiz result after completion\nexport interface QuizResult {\n  score: number;\n  total: number;\n  xpEarned: number;\n  accuracyPercent: number;\n  incorrectTopics: string[];\n}\n\n// Achievement/badge\nexport interface Achievement {\n  id: string;\n  name: string;\n  description: string;\n  icon: string;\n  unlocked: boolean;\n  unlockedDate?: string;\n  progress?: number;\n  maxProgress?: number;\n}\n\n// Daily quiz record\nexport interface DailyQuiz {\n  date: string;\n  score: number;\n  xpEarned: number;\n  improvement: number;\n}\n\n// Topic-level spaced repetition stats (SM-2 inspired algorithm)\nexport interface TopicReviewStats {\n  topic: string;\n  lectureId: string;\n  lectureTitle: string;\n  lastReviewed: string;\n  lastScore: number;\n  reviewCount: number;\n  easeFactor: number; // SM-2 ease factor (starts at 2.5)\n  interval: number; // Days until next review\n  nextDue: string; // ISO date when review is due\n  streak: number; // Consecutive successful reviews (score >= 70%)\n}\n\n// Review event for history tracking\nexport interface ReviewEvent {\n  id: string;\n  topicId: string;\n  topic: string;\n  lectureId: string;\n  date: string;\n  score: number;\n  responseTime?: number; // Seconds to answer\n  wasCorrect: boolean;\n}\n\n// Daily quiz plan generated by the server\nexport interface DailyQuizPlan {\n  id: string;\n  generatedAt: string;\n  topics: {\n    topic: string;\n    lectureId: string;\n    lectureTitle: string;\n    priority: number;\n    reason: \"due\" | \"weak\" | \"overdue\" | \"new\";\n    daysSinceReview: number;\n  }[];\n  lectureExcerpts: {\n    lectureId: string;\n    excerpt: string;\n  }[];\n  completed: boolean;\n  completedAt?: string;\n  score?: number;\n}\n\n// Spaced repetition intervals (in days) based on streak\nexport const SPACED_REPETITION_INTERVALS = [1, 3, 7, 14, 30, 60, 90];\n\n// Calculate next review date using SM-2 algorithm\nexport function calculateNextReview(\n  currentEaseFactor: number,\n  currentInterval: number,\n  score: number, // 0-100\n  streak: number\n): { easeFactor: number; interval: number; nextDue: string } {\n  // Convert score to quality (0-5 scale for SM-2)\n  const quality = Math.round((score / 100) * 5);\n  \n  // Update ease factor (minimum 1.3)\n  let newEaseFactor = currentEaseFactor + (0.1 - (5 - quality) * (0.08 + (5 - quality) * 0.02));\n  newEaseFactor = Math.max(1.3, newEaseFactor);\n  \n  // Calculate new interval\n  let newInterval: number;\n  if (quality < 3) {\n    // Failed - reset to beginning\n    newInterval = 1;\n  } else if (streak === 0) {\n    newInterval = 1;\n  } else if (streak === 1) {\n    newInterval = 3;\n  } else {\n    // Use interval ladder with ease factor\n    const baseInterval = SPACED_REPETITION_INTERVALS[Math.min(streak, SPACED_REPETITION_INTERVALS.length - 1)];\n    newInterval = Math.round(baseInterval * newEaseFactor);\n  }\n  \n  // Calculate next due date\n  const nextDue = new Date();\n  nextDue.setDate(nextDue.getDate() + newInterval);\n  \n  return {\n    easeFactor: newEaseFactor,\n    interval: newInterval,\n    nextDue: nextDue.toISOString().split('T')[0],\n  };\n}\n\n// Calculate topic priority for daily quiz selection\nexport function calculateTopicPriority(stats: TopicReviewStats): number {\n  const today = new Date();\n  const nextDue = new Date(stats.nextDue);\n  const daysSinceDue = Math.floor((today.getTime() - nextDue.getTime()) / (1000 * 60 * 60 * 24));\n  \n  let priority = 0;\n  \n  // Overdue topics get highest priority (more overdue = higher priority)\n  if (daysSinceDue > 0) {\n    priority += 100 + (daysSinceDue * 10);\n  }\n  \n  // Due today gets high priority\n  if (daysSinceDue === 0) {\n    priority += 80;\n  }\n  \n  // Low scores increase priority (inverse relationship)\n  priority += Math.max(0, 50 - (stats.lastScore / 2));\n  \n  // Lower ease factor increases priority (harder topics)\n  priority += Math.max(0, (2.5 - stats.easeFactor) * 20);\n  \n  // Lower streak increases priority\n  priority += Math.max(0, (5 - stats.streak) * 5);\n  \n  return priority;\n}\n\n// Lecture with review data\nexport interface Lecture {\n  id: string;\n  title: string;\n  date: string;\n  content: string;\n  reviewScore: number;\n  xpEarned: number;\n  incorrectTopics: string[];\n  confidenceRating: number;\n  dailyQuizzes: DailyQuiz[];\n  needsReview: boolean;\n  lastReviewed?: string;\n  identifiedSkills?: TransferableSkill[]; // Skills identified from this lecture\n  questionsAnswered?: number; // Number of questions answered in the last quiz\n}\n\n// User profile with gamification data\nexport interface UserProfile {\n  level: number;\n  totalXP: number;\n  xpToNextLevel: number;\n  currentStreak: number;\n  longestStreak: number;\n  totalLectures: number;\n  averageConfidence: number;\n  achievements: Achievement[];\n  masteredTopics: string[];\n  needsPractice: string[];\n  powerUps: {\n    secondChance: number;\n    hints: number;\n    doubleXP: boolean;\n  };\n  lastActivityDate?: string;\n}\n\n// Level titles based on level number\nexport const LEVEL_TITLES: Record<number, string> = {\n  1: \"Knowledge Novice\",\n  2: \"Study Starter\",\n  3: \"Learning Explorer\",\n  4: \"Quiz Challenger\",\n  5: \"Knowledge Apprentice\",\n  6: \"Study Scholar\",\n  7: \"Knowledge Warrior\",\n  8: \"Learning Champion\",\n  9: \"Quiz Master\",\n  10: \"Knowledge Master\",\n  11: \"Wisdom Seeker\",\n  12: \"Grand Scholar\",\n  13: \"Learning Legend\",\n  14: \"Knowledge Sage\",\n  15: \"Ultimate Master\",\n};\n\n// All available achievements\nexport const ALL_ACHIEVEMENTS: Achievement[] = [\n  {\n    id: \"first_steps\",\n    name: \"First Steps\",\n    description: \"Complete your first lecture review\",\n    icon: \"footprints\",\n    unlocked: false,\n    maxProgress: 1,\n    progress: 0,\n  },\n  {\n    id: \"quick_learner\",\n    name: \"Quick Learner\",\n    description: \"Score 100% on any quiz\",\n    icon: \"zap\",\n    unlocked: false,\n    maxProgress: 1,\n    progress: 0,\n  },\n  {\n    id: \"dedicated_student\",\n    name: \"Dedicated Student\",\n    description: \"Complete 5 lectures\",\n    icon: \"book-open\",\n    unlocked: false,\n    maxProgress: 5,\n    progress: 0,\n  },\n  {\n    id: \"comeback_kid\",\n    name: \"Comeback Kid\",\n    description: \"Improve score by 30%+ on daily quiz\",\n    icon: \"trending-up\",\n    unlocked: false,\n    maxProgress: 1,\n    progress: 0,\n  },\n  {\n    id: \"confident_scholar\",\n    name: \"Confident Scholar\",\n    description: \"Rate confidence 5/5\",\n    icon: \"star\",\n    unlocked: false,\n    maxProgress: 1,\n    progress: 0,\n  },\n  {\n    id: \"week_warrior\",\n    name: \"Week Warrior\",\n    description: \"7-day streak\",\n    icon: \"flame\",\n    unlocked: false,\n    maxProgress: 7,\n    progress: 0,\n  },\n  {\n    id: \"topic_master\",\n    name: \"Topic Master\",\n    description: \"Master 3 topics (score 80%+ twice)\",\n    icon: \"crown\",\n    unlocked: false,\n    maxProgress: 3,\n    progress: 0,\n  },\n  {\n    id: \"night_owl\",\n    name: \"Night Owl\",\n    description: \"Complete daily quiz after 8pm\",\n    icon: \"moon\",\n    unlocked: false,\n    maxProgress: 1,\n    progress: 0,\n  },\n  {\n    id: \"early_bird\",\n    name: \"Early Bird\",\n    description: \"Complete review before noon\",\n    icon: \"sunrise\",\n    unlocked: false,\n    maxProgress: 1,\n    progress: 0,\n  },\n  {\n    id: \"perfectionist\",\n    name: \"Perfectionist\",\n    description: \"Get 10 perfect scores\",\n    icon: \"target\",\n    unlocked: false,\n    maxProgress: 10,\n    progress: 0,\n  },\n  {\n    id: \"knowledge_seeker\",\n    name: \"Knowledge Seeker\",\n    description: \"Upload 10 lectures\",\n    icon: \"search\",\n    unlocked: false,\n    maxProgress: 10,\n    progress: 0,\n  },\n];\n\n// Initial user profile\nexport const INITIAL_USER_PROFILE: UserProfile = {\n  level: 1,\n  totalXP: 0,\n  xpToNextLevel: 400,\n  currentStreak: 0,\n  longestStreak: 0,\n  totalLectures: 0,\n  averageConfidence: 0,\n  achievements: ALL_ACHIEVEMENTS.map((a) => ({ ...a })),\n  masteredTopics: [],\n  needsPractice: [],\n  powerUps: {\n    secondChance: 0,\n    hints: 0,\n    doubleXP: false,\n  },\n};\n\n// Demo profile for testing - looks like an actively used account\nexport const DEMO_USER_PROFILE: UserProfile = {\n  level: 5,\n  totalXP: 2650,\n  xpToNextLevel: 3600,\n  currentStreak: 7,\n  longestStreak: 12,\n  totalLectures: 7,\n  averageConfidence: 3.8,\n  achievements: ALL_ACHIEVEMENTS.map((a) => {\n    if (a.id === \"first_steps\") {\n      return { ...a, unlocked: true, unlockedDate: \"2025-11-10\", progress: 1 };\n    }\n    if (a.id === \"quick_learner\") {\n      return { ...a, unlocked: true, unlockedDate: \"2025-11-12\", progress: 1 };\n    }\n    if (a.id === \"dedicated_student\") {\n      return { ...a, unlocked: true, unlockedDate: \"2025-11-20\", progress: 5 };\n    }\n    if (a.id === \"week_warrior\") {\n      return { ...a, unlocked: true, unlockedDate: \"2025-11-25\", progress: 7 };\n    }\n    if (a.id === \"early_bird\") {\n      return { ...a, unlocked: true, unlockedDate: \"2025-11-15\", progress: 1 };\n    }\n    if (a.id === \"perfectionist\") {\n      return { ...a, progress: 3 };\n    }\n    if (a.id === \"knowledge_seeker\") {\n      return { ...a, progress: 7 };\n    }\n    if (a.id === \"topic_master\") {\n      return { ...a, progress: 2 };\n    }\n    return { ...a };\n  }),\n  masteredTopics: [\"Variables\", \"Loops\", \"Functions\", \"Arrays\"],\n  needsPractice: [\"Recursion\", \"Binary Trees\"],\n  powerUps: {\n    secondChance: 3,\n    hints: 2,\n    doubleXP: true,\n  },\n  lastActivityDate: new Date().toISOString().split('T')[0],\n};\n\n// Demo lectures - variety of subjects and scores\nexport const DEMO_LECTURES: Lecture[] = [\n  {\n    id: \"demo-1\",\n    title: \"Introduction to Programming\",\n    date: \"2025-11-10\",\n    content: \"Variables, data types, operators, and basic input/output operations form the foundation of programming...\",\n    reviewScore: 92,\n    xpEarned: 145,\n    incorrectTopics: [],\n    confidenceRating: 5,\n    dailyQuizzes: [\n      { date: \"2025-11-11\", score: 95, xpEarned: 52, improvement: 3 },\n      { date: \"2025-11-15\", score: 100, xpEarned: 60, improvement: 5 },\n    ],\n    needsReview: false,\n    lastReviewed: \"2025-11-15\",\n    questionsAnswered: 10,\n    identifiedSkills: [\n      { name: \"Logical Reasoning\", description: \"Ability to follow step-by-step logical processes and understand cause-effect relationships\", category: \"cognitive\", relevantCareers: [\"Software Engineer\", \"Data Analyst\", \"Systems Architect\"], proficiencyLevel: \"proficient\" },\n      { name: \"Problem Decomposition\", description: \"Breaking complex problems into smaller, manageable components\", category: \"cognitive\", relevantCareers: [\"Software Developer\", \"Project Manager\", \"Consultant\"], proficiencyLevel: \"proficient\" },\n    ],\n  },\n  {\n    id: \"demo-2\",\n    title: \"Control Flow & Loops\",\n    date: \"2025-11-12\",\n    content: \"If statements, switch cases, for loops, while loops, and nested control structures...\",\n    reviewScore: 88,\n    xpEarned: 130,\n    incorrectTopics: [\"Nested Loops\"],\n    confidenceRating: 4,\n    dailyQuizzes: [\n      { date: \"2025-11-13\", score: 85, xpEarned: 48, improvement: -3 },\n      { date: \"2025-11-18\", score: 90, xpEarned: 55, improvement: 5 },\n    ],\n    needsReview: false,\n    lastReviewed: \"2025-11-18\",\n    questionsAnswered: 10,\n    identifiedSkills: [\n      { name: \"Algorithmic Thinking\", description: \"Designing systematic approaches to solve problems efficiently\", category: \"cognitive\", relevantCareers: [\"Software Engineer\", \"Machine Learning Engineer\", \"Quantitative Analyst\"], proficiencyLevel: \"proficient\" },\n      { name: \"Pattern Recognition\", description: \"Identifying recurring structures and optimizing repetitive processes\", category: \"cognitive\", relevantCareers: [\"Data Scientist\", \"Business Analyst\", \"UX Researcher\"], proficiencyLevel: \"intermediate\" },\n    ],\n  },\n  {\n    id: \"demo-3\",\n    title: \"Functions & Modular Design\",\n    date: \"2025-11-15\",\n    content: \"Function declarations, parameters, return values, scope, and modular programming principles...\",\n    reviewScore: 78,\n    xpEarned: 110,\n    incorrectTopics: [\"Recursion\", \"Scope\"],\n    confidenceRating: 3,\n    dailyQuizzes: [\n      { date: \"2025-11-16\", score: 72, xpEarned: 42, improvement: -6 },\n    ],\n    needsReview: true,\n    lastReviewed: \"2025-11-16\",\n    questionsAnswered: 5,\n    identifiedSkills: [\n      { name: \"Code Organization\", description: \"Structuring code for readability, maintainability, and reusability\", category: \"technical\", relevantCareers: [\"Software Engineer\", \"Tech Lead\", \"DevOps Engineer\"], proficiencyLevel: \"intermediate\" },\n      { name: \"Abstraction\", description: \"Hiding complexity and exposing only essential interfaces\", category: \"cognitive\", relevantCareers: [\"Systems Architect\", \"API Developer\", \"Product Engineer\"], proficiencyLevel: \"developing\" },\n    ],\n  },\n  {\n    id: \"demo-4\",\n    title: \"Arrays & Collections\",\n    date: \"2025-11-18\",\n    content: \"Array declaration, indexing, iteration, multi-dimensional arrays, and common array algorithms...\",\n    reviewScore: 85,\n    xpEarned: 125,\n    incorrectTopics: [\"2D Arrays\"],\n    confidenceRating: 4,\n    dailyQuizzes: [\n      { date: \"2025-11-20\", score: 88, xpEarned: 50, improvement: 3 },\n    ],\n    needsReview: false,\n    lastReviewed: \"2025-11-20\",\n    questionsAnswered: 10,\n    identifiedSkills: [\n      { name: \"Data Organization\", description: \"Efficiently structuring and accessing collections of information\", category: \"technical\", relevantCareers: [\"Database Administrator\", \"Backend Developer\", \"Data Engineer\"], proficiencyLevel: \"proficient\" },\n      { name: \"Optimization\", description: \"Improving algorithm efficiency and reducing computational complexity\", category: \"technical\", relevantCareers: [\"Performance Engineer\", \"Machine Learning Engineer\", \"Game Developer\"], proficiencyLevel: \"intermediate\" },\n    ],\n  },\n  {\n    id: \"demo-5\",\n    title: \"Object-Oriented Programming\",\n    date: \"2025-11-20\",\n    content: \"Classes, objects, inheritance, polymorphism, encapsulation, and abstraction principles...\",\n    reviewScore: 72,\n    xpEarned: 100,\n    incorrectTopics: [\"Polymorphism\", \"Abstract Classes\"],\n    confidenceRating: 3,\n    dailyQuizzes: [],\n    needsReview: true,\n    lastReviewed: \"2025-11-20\",\n    questionsAnswered: 5,\n    identifiedSkills: [\n      { name: \"Systems Design\", description: \"Creating modular, extensible architectures for complex applications\", category: \"technical\", relevantCareers: [\"Systems Architect\", \"Staff Engineer\", \"Technical Director\"], proficiencyLevel: \"developing\" },\n      { name: \"Code Organization\", description: \"Designing components that can be repurposed across different contexts\", category: \"technical\", relevantCareers: [\"Platform Engineer\", \"Library Developer\", \"Framework Author\"], proficiencyLevel: \"developing\" },\n    ],\n  },\n  {\n    id: \"demo-6\",\n    title: \"Data Structures Fundamentals\",\n    date: \"2025-11-25\",\n    content: \"Linked lists, stacks, queues, and their implementations using arrays and pointers...\",\n    reviewScore: 65,\n    xpEarned: 90,\n    incorrectTopics: [\"Binary Trees\", \"Tree Traversal\"],\n    confidenceRating: 2,\n    dailyQuizzes: [],\n    needsReview: true,\n    lastReviewed: \"2025-11-25\",\n    questionsAnswered: 5,\n    identifiedSkills: [\n      { name: \"Data Organization\", description: \"Understanding how data can be structured for efficient access\", category: \"technical\", relevantCareers: [\"Backend Developer\", \"Systems Engineer\", \"Database Developer\"], proficiencyLevel: \"developing\" },\n      { name: \"Algorithmic Thinking\", description: \"Selecting appropriate data structures for different use cases\", category: \"cognitive\", relevantCareers: [\"Software Engineer\", \"Technical Interviewer\", \"CS Educator\"], proficiencyLevel: \"developing\" },\n    ],\n  },\n  {\n    id: \"demo-7\",\n    title: \"Algorithm Analysis\",\n    date: \"2025-11-28\",\n    content: \"Big O notation, time complexity, space complexity, best/worst/average case analysis...\",\n    reviewScore: 80,\n    xpEarned: 115,\n    incorrectTopics: [\"Amortized Analysis\"],\n    confidenceRating: 4,\n    dailyQuizzes: [],\n    needsReview: false,\n    lastReviewed: \"2025-11-28\",\n    questionsAnswered: 5,\n    identifiedSkills: [\n      { name: \"Critical Analysis\", description: \"Evaluating trade-offs and making informed technical decisions\", category: \"cognitive\", relevantCareers: [\"Performance Engineer\", \"Tech Lead\", \"Senior Software Engineer\"], proficiencyLevel: \"intermediate\" },\n      { name: \"Optimization\", description: \"Identifying bottlenecks and improving system performance\", category: \"technical\", relevantCareers: [\"Performance Engineer\", \"Backend Developer\", \"DevOps Engineer\"], proficiencyLevel: \"intermediate\" },\n    ],\n  },\n];\n\n// Demo calendar settings\nexport const DEMO_CALENDAR_SETTINGS: CalendarSettings = {\n  url: \"https://demo.university.edu/calendar/demo.ics\",\n  lastSync: new Date().toISOString(),\n  lastSyncStatus: \"success\",\n};\n\n// Helper to generate dates relative to today\nfunction getDemoDate(daysFromNow: number, hour: number = 9, minute: number = 0): string {\n  const date = new Date();\n  date.setDate(date.getDate() + daysFromNow);\n  date.setHours(hour, minute, 0, 0);\n  return date.toISOString();\n}\n\n// Demo calendar events - mix of lectures and exams\nexport const DEMO_CALENDAR_EVENTS: CalendarEvent[] = [\n  {\n    id: \"cal-demo-1\",\n    uid: \"demo-lecture-1\",\n    title: \"KF4005: Computer Networks - Lecture\",\n    eventType: \"lecture\",\n    startsAt: getDemoDate(1, 9, 0),\n    endsAt: getDemoDate(1, 11, 0),\n    location: \"Room 201, Computer Science Building\",\n    description: \"Introduction to network protocols\",\n  },\n  {\n    id: \"cal-demo-2\",\n    uid: \"demo-lecture-2\",\n    title: \"KF5008: Database Systems - Lecture\",\n    eventType: \"lecture\",\n    startsAt: getDemoDate(2, 14, 0),\n    endsAt: getDemoDate(2, 16, 0),\n    location: \"Room 105, Engineering Block\",\n    description: \"SQL and relational databases\",\n  },\n  {\n    id: \"cal-demo-3\",\n    uid: \"demo-exam-1\",\n    title: \"Quiz: Programming Fundamentals\",\n    eventType: \"exam\",\n    startsAt: getDemoDate(3, 23, 59),\n    endsAt: getDemoDate(3, 23, 59),\n    description: \"Online quiz due by midnight\",\n  },\n  {\n    id: \"cal-demo-4\",\n    uid: \"demo-tutorial-1\",\n    title: \"KF4005: Networks Tutorial\",\n    eventType: \"tutorial\",\n    startsAt: getDemoDate(3, 10, 0),\n    endsAt: getDemoDate(3, 11, 0),\n    location: \"Lab 3, Computer Science Building\",\n  },\n  {\n    id: \"cal-demo-5\",\n    uid: \"demo-lecture-3\",\n    title: \"KF5010: Software Engineering - Lecture\",\n    eventType: \"lecture\",\n    startsAt: getDemoDate(4, 11, 0),\n    endsAt: getDemoDate(4, 13, 0),\n    location: \"Room 302, Main Building\",\n    description: \"Agile methodologies and project management\",\n  },\n  {\n    id: \"cal-demo-6\",\n    uid: \"demo-exam-2\",\n    title: \"Test: Data Structures Midterm\",\n    eventType: \"exam\",\n    startsAt: getDemoDate(5, 14, 0),\n    endsAt: getDemoDate(5, 16, 0),\n    location: \"Examination Hall A\",\n    description: \"Covers chapters 1-5\",\n  },\n  {\n    id: \"cal-demo-7\",\n    uid: \"demo-lecture-4\",\n    title: \"KF4009: Operating Systems - Lecture\",\n    eventType: \"lecture\",\n    startsAt: getDemoDate(6, 9, 0),\n    endsAt: getDemoDate(6, 11, 0),\n    location: \"Room 201, Computer Science Building\",\n    description: \"Process scheduling and memory management\",\n  },\n];\n\n// Zod schemas for API validation\nexport const questionSchema = z.object({\n  question: z.string(),\n  options: z.array(z.string()).length(4),\n  correct: z.number().min(0).max(3),\n  explanation: z.string(),\n});\n\nexport const generateQuizRequestSchema = z.object({\n  content: z.string().min(50, \"Lecture content must be at least 50 characters\"),\n  title: z.string().optional(),\n});\n\nexport const generateDailyQuizRequestSchema = z.object({\n  weakTopics: z.array(z.string()),\n  previousScore: z.number(),\n  confidenceLevel: z.number().min(1).max(5),\n});\n\nexport type GenerateQuizRequest = z.infer<typeof generateQuizRequestSchema>;\nexport type GenerateDailyQuizRequest = z.infer<typeof generateDailyQuizRequestSchema>;\n\n// Calendar integration types\nexport interface CalendarSettings {\n  url: string;\n  lastSync?: string;\n  lastSyncStatus?: \"success\" | \"error\";\n  lastSyncError?: string;\n}\n\nexport interface CalendarEvent {\n  id: string;\n  uid: string;\n  title: string;\n  eventType: \"lecture\" | \"workshop\" | \"tutorial\" | \"exam\" | \"other\";\n  startsAt: string;\n  endsAt: string;\n  location?: string;\n  description?: string;\n  matchedLectureId?: string;\n}\n\nexport const calendarSettingsSchema = z.object({\n  url: z.string().url().refine(\n    (url) => {\n      if (!url.startsWith(\"https://\")) return false;\n      const lowerUrl = url.toLowerCase();\n      const pathname = new URL(url).pathname.toLowerCase();\n      return lowerUrl.includes(\".ics\") || pathname.includes(\"/ical\") || pathname.includes(\"/calendar\");\n    },\n    \"Calendar URL must be a secure HTTPS link to a calendar feed\"\n  ),\n});\n\nexport type CalendarSettingsInput = z.infer<typeof calendarSettingsSchema>;\n\n// Initial calendar settings\nexport const INITIAL_CALENDAR_SETTINGS: CalendarSettings | null = null;\n","path":null,"size_bytes":32803,"size_tokens":null},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","path":null,"size_bytes":7428,"size_tokens":null},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","path":null,"size_bytes":710,"size_tokens":null},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","path":null,"size_bytes":791,"size_tokens":null},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","path":null,"size_bytes":2712,"size_tokens":null},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","path":null,"size_bytes":329,"size_tokens":null},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","path":null,"size_bytes":1280,"size_tokens":null},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","path":null,"size_bytes":565,"size_tokens":null},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","path":null,"size_bytes":1977,"size_tokens":null},"client/src/components/dashboard.tsx":{"content":"import { useState, useMemo } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { \n  Zap, Flame, BookOpen, \n  Play, Upload, ChevronRight, Trash2, Bell,\n  Target, Award, TrendingUp, Trophy, Clock,\n  Calendar, CalendarDays, RefreshCw, X, Loader2, FileCheck, Sparkles,\n  Brain, Briefcase, Download, GraduationCap, BarChart3, Lightbulb, ArrowUpRight, CheckCircle2,\n  EyeOff, MapPin, ChevronDown\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Tooltip, TooltipContent, TooltipTrigger } from \"@/components/ui/tooltip\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from \"@/components/ui/alert-dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Collapsible, CollapsibleContent, CollapsibleTrigger } from \"@/components/ui/collapsible\";\nimport type { UserProfile, Lecture, CalendarSettings, CalendarEvent } from \"@shared/schema\";\nimport { xpForNextLevel, formatDate, getMotivationalQuote, getLevelTitle } from \"@/lib/game-utils\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface CalendarData {\n  settings: CalendarSettings | null;\n  events: CalendarEvent[];\n  upcomingLectures: CalendarEvent[];\n  upcomingExams: CalendarEvent[];\n  missingLectures: CalendarEvent[];\n  totalMissed: number;\n  activeMissed: number;\n  dismissedCount: number;\n  totalEvents: number;\n  lectureCount: number;\n  examCount: number;\n}\n\ninterface DailyQuizStatus {\n  hasDueTopics: boolean;\n  dueTopicsCount: number;\n  totalTopicsTracked: number;\n  dueTopics: {\n    topic: string;\n    lectureTitle: string;\n    lastScore: number;\n    daysSinceReview: number;\n    streak: number;\n    isOverdue: boolean;\n    reason: \"overdue\" | \"weak\" | \"new\" | \"due\";\n    reviewCount: number;\n  }[];\n  currentPlan: {\n    id: string;\n    topicsCount: number;\n    generatedAt: string;\n    completed: boolean;\n    topics?: {\n      topic: string;\n      lectureTitle: string;\n      reason: string;\n    }[];\n  } | null;\n  weeklyStreak: number;\n}\n\ninterface SkillsData {\n  skills: {\n    name: string;\n    description: string;\n    category: string;\n    relevantCareers: string[];\n    proficiencyLevel: \"developing\" | \"intermediate\" | \"proficient\";\n    occurrenceCount: number;\n  }[];\n  totalSkills: number;\n  proficientCount: number;\n  intermediateCount: number;\n  developingCount: number;\n}\n\ninterface DashboardProps {\n  userProfile: UserProfile;\n  lectureHistory: Lecture[];\n  onStartUpload: () => void;\n  onStartReview: (lectureId: string) => void;\n  onViewAchievements: () => void;\n  onDeleteLecture?: (id: string) => void;\n  onStartDailyQuiz?: () => void;\n}\n\nexport function Dashboard({\n  userProfile,\n  lectureHistory,\n  onStartUpload,\n  onStartReview,\n  onViewAchievements,\n  onDeleteLecture,\n  onStartDailyQuiz,\n}: DashboardProps) {\n  const { toast } = useToast();\n  const [calendarDialogOpen, setCalendarDialogOpen] = useState(false);\n  const [calendarUrl, setCalendarUrl] = useState(\"\");\n  const [demoDialogOpen, setDemoDialogOpen] = useState(false);\n  const [missedLecturesOpen, setMissedLecturesOpen] = useState(false);\n  const [topicPreviewOpen, setTopicPreviewOpen] = useState(false);\n  \n  const { data: calendarData } = useQuery<CalendarData>({\n    queryKey: [\"/api/calendar\"],\n  });\n  \n  const { data: dailyQuizStatus } = useQuery<DailyQuizStatus>({\n    queryKey: [\"/api/daily-quiz/status\"],\n  });\n  \n  const { data: skillsData } = useQuery<SkillsData>({\n    queryKey: [\"/api/skills\"],\n  });\n  \n  const setCalendarMutation = useMutation({\n    mutationFn: async (url: string) => {\n      const response = await apiRequest(\"POST\", \"/api/calendar\", { url });\n      return response.json();\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/calendar\"] });\n      toast({ title: \"Calendar connected\", description: data.message });\n      setCalendarDialogOpen(false);\n      setCalendarUrl(\"\");\n    },\n    onError: (error: Error) => {\n      toast({ title: \"Failed to connect calendar\", description: error.message, variant: \"destructive\" });\n    },\n  });\n  \n  const refreshCalendarMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest(\"POST\", \"/api/calendar/refresh\", {});\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/calendar\"] });\n      toast({ title: \"Calendar refreshed\" });\n    },\n    onError: (error: Error) => {\n      toast({ title: \"Failed to refresh calendar\", description: error.message, variant: \"destructive\" });\n    },\n  });\n  \n  const removeCalendarMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest(\"DELETE\", \"/api/calendar\");\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/calendar\"] });\n      toast({ title: \"Calendar removed\" });\n      setCalendarDialogOpen(false);\n    },\n    onError: (error: Error) => {\n      toast({ title: \"Failed to remove calendar\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const demoModeMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest(\"POST\", \"/api/profile/demo\", {});\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/profile\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/lectures\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/calendar\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/daily-quiz/status\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/skills\"] });\n      toast({ title: \"Demo mode activated\", description: \"Sample data loaded\" });\n      setDemoDialogOpen(false);\n    },\n  });\n\n  const dismissLectureMutation = useMutation({\n    mutationFn: async (eventId: string) => {\n      const response = await apiRequest(\"POST\", `/api/calendar/dismiss/${eventId}`, {});\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/calendar\"] });\n      toast({ title: \"Lecture dismissed\", description: \"It won't appear in missed lectures anymore\" });\n    },\n    onError: (error: Error) => {\n      toast({ title: \"Failed to dismiss lecture\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  // Computed values\n  const currentLevelXP = Math.pow(userProfile.level, 2) * 100;\n  const nextLevelXP = xpForNextLevel(userProfile.level);\n  const xpInLevel = userProfile.totalXP - currentLevelXP;\n  const xpNeeded = nextLevelXP - currentLevelXP;\n  const progressPercent = Math.min(100, (xpInLevel / xpNeeded) * 100);\n  const xpToNext = nextLevelXP - userProfile.totalXP;\n  const unlockedAchievements = userProfile.achievements.filter((a) => a.unlocked);\n  const averageAccuracy = lectureHistory.length > 0\n    ? Math.round(lectureHistory.reduce((sum, l) => sum + l.reviewScore, 0) / lectureHistory.length)\n    : 0;\n  const lecturesNeedingReview = lectureHistory.filter((l) => l.needsReview);\n  const hasReviewsDue = lecturesNeedingReview.length > 0;\n  const totalQuestionsAnswered = lectureHistory.reduce((sum, l) => sum + (l.questionsAnswered || 0), 0);\n  const masteredTopicsCount = userProfile.masteredTopics?.length || 0;\n  const skillsCount = skillsData?.totalSkills || 0;\n  const hasCalendar = calendarData?.settings !== null;\n  const upcomingLectures = calendarData?.upcomingLectures || [];\n  const upcomingExams = calendarData?.upcomingExams || [];\n  const missingLectures = calendarData?.missingLectures || [];\n  const hasPriorityAction = dailyQuizStatus?.hasDueTopics || hasReviewsDue;\n  \n  const formatEventDate = (dateStr: string) => {\n    const date = new Date(dateStr);\n    const today = new Date();\n    const tomorrow = new Date(today);\n    tomorrow.setDate(tomorrow.getDate() + 1);\n    if (date.toDateString() === today.toDateString()) {\n      return `Today at ${date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}`;\n    } else if (date.toDateString() === tomorrow.toDateString()) {\n      return `Tomorrow at ${date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}`;\n    }\n    return date.toLocaleDateString([], { weekday: 'short', month: 'short', day: 'numeric' }) + \n      ` at ${date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}`;\n  };\n\n  const exportSkills = () => {\n    if (!skillsData) return;\n    const csvContent = [\n      [\"Skill\", \"Category\", \"Proficiency\", \"Relevant Careers\", \"Times Practiced\"].join(\",\"),\n      ...skillsData.skills.map(skill => [\n        `\"${skill.name}\"`,\n        `\"${skill.category}\"`,\n        skill.proficiencyLevel,\n        `\"${skill.relevantCareers.join(\"; \")}\"`,\n        skill.occurrenceCount\n      ].join(\",\"))\n    ].join(\"\\n\");\n    const blob = new Blob([csvContent], { type: \"text/csv\" });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = \"skills-profile.csv\";\n    a.click();\n    URL.revokeObjectURL(url);\n    toast({ title: \"Skills exported\", description: \"Your skills profile has been downloaded.\" });\n  };\n\n  // AI Learning Coach - Generate personalized insights (only when actionable data exists)\n  // Only enable quiz actions when daily quiz is actually available (not just reviews)\n  const hasQuizAction = Boolean(onStartDailyQuiz && dailyQuizStatus?.hasDueTopics);\n  \n  const aiInsights = useMemo(() => {\n    // Don't show insights if user has no meaningful data\n    if (lectureHistory.length === 0 && userProfile.totalXP === 0) {\n      return [];\n    }\n    \n    const insights: { icon: \"lightbulb\" | \"trending\" | \"target\" | \"flame\" | \"brain\"; text: string; action?: string }[] = [];\n    \n    // Streak-based insight\n    if (userProfile.currentStreak >= 7) {\n      insights.push({ icon: \"flame\", text: `Amazing ${userProfile.currentStreak}-day streak! You're building strong habits.` });\n    } else if (userProfile.currentStreak >= 3) {\n      insights.push({ icon: \"flame\", text: `${userProfile.currentStreak}-day streak going strong. Keep the momentum!` });\n    } else if (userProfile.currentStreak === 0 && lectureHistory.length > 0 && hasQuizAction) {\n      // Only show streak restart if there's actually a quiz available\n      insights.push({ icon: \"target\", text: \"Start a new streak today! Consistency is key to retention.\", action: \"quiz\" });\n    }\n\n    // Accuracy-based insight\n    if (averageAccuracy >= 85) {\n      insights.push({ icon: \"brain\", text: `${averageAccuracy}% average accuracy - you're mastering the material!` });\n    } else if (averageAccuracy >= 60 && averageAccuracy < 85 && dailyQuizStatus?.dueTopics) {\n      const weakTopics = dailyQuizStatus.dueTopics.filter(t => t.lastScore < 70).slice(0, 2);\n      if (weakTopics.length > 0 && hasQuizAction) {\n        insights.push({ icon: \"lightbulb\", text: `Focus on \"${weakTopics[0].topic}\" to boost your score.`, action: \"quiz\" });\n      }\n    }\n\n    // Skills-based insight\n    if (skillsData && skillsData.proficientCount > 0) {\n      const topSkill = skillsData.skills.find(s => s.proficiencyLevel === \"proficient\");\n      if (topSkill && topSkill.relevantCareers.length > 0) {\n        insights.push({ icon: \"trending\", text: `Your \"${topSkill.name}\" skill opens doors to ${topSkill.relevantCareers[0]}.` });\n      }\n    }\n\n    // Progress insight - only show if there's a way to earn XP\n    if (xpToNext <= 100 && hasQuizAction) {\n      insights.push({ icon: \"target\", text: `Only ${xpToNext} XP to Level ${userProfile.level + 1}! One quiz away.`, action: \"quiz\" });\n    }\n\n    // Learning velocity - requires sufficient data\n    if (lectureHistory.length >= 3) {\n      const recentLectures = lectureHistory.slice(0, 3);\n      const avgRecentScore = Math.round(recentLectures.reduce((sum, l) => sum + l.reviewScore, 0) / recentLectures.length);\n      if (avgRecentScore > averageAccuracy + 5) {\n        insights.push({ icon: \"trending\", text: \"Your recent scores are improving! Great progress.\" });\n      }\n    }\n\n    return insights.slice(0, 2); // Show max 2 insights\n  }, [userProfile, lectureHistory, averageAccuracy, skillsData, dailyQuizStatus, xpToNext, hasQuizAction]);\n\n  return (\n    <div className=\"min-h-screen\">\n      <div className=\"max-w-4xl mx-auto px-6 py-10\">\n        \n        {/* Compact Header */}\n        <header className=\"mb-6 animate-fade-in\">\n          <div className=\"flex items-center justify-between mb-3\">\n            <div>\n              <h1 className=\"font-serif text-2xl tracking-tight\">{getLevelTitle(userProfile.level)}</h1>\n              <p className=\"text-sm text-muted-foreground\">{getMotivationalQuote()}</p>\n            </div>\n            <div className=\"flex items-center gap-1\">\n              <Tooltip>\n                <TooltipTrigger asChild>\n                  <Button onClick={() => setDemoDialogOpen(true)} variant=\"ghost\" size=\"icon\" data-testid=\"button-demo-mode\" aria-label=\"Demo mode\">\n                    <Sparkles className=\"h-4 w-4\" />\n                  </Button>\n                </TooltipTrigger>\n                <TooltipContent>Demo Mode</TooltipContent>\n              </Tooltip>\n              <Tooltip>\n                <TooltipTrigger asChild>\n                  <Button onClick={() => setCalendarDialogOpen(true)} variant=\"ghost\" size=\"icon\" className={hasCalendar ? \"text-primary\" : \"\"} data-testid=\"button-calendar-settings\" aria-label=\"Calendar\">\n                    <Calendar className=\"h-4 w-4\" />\n                  </Button>\n                </TooltipTrigger>\n                <TooltipContent>{hasCalendar ? \"Calendar Settings\" : \"Connect Calendar\"}</TooltipContent>\n              </Tooltip>\n            </div>\n          </div>\n          \n          {/* Stats Bar */}\n          <div className=\"flex items-center gap-4 p-3 rounded-lg bg-card border text-sm\">\n            <div className=\"flex items-center gap-1.5\">\n              <Award className=\"h-4 w-4 text-primary\" />\n              <span className=\"font-medium\">Lvl {userProfile.level}</span>\n            </div>\n            <div className=\"flex items-center gap-1.5\">\n              <Zap className=\"h-4 w-4 text-gold\" />\n              <span className=\"font-medium tabular-nums text-gold\">{userProfile.totalXP.toLocaleString()}</span>\n            </div>\n            {userProfile.currentStreak > 0 && (\n              <div className=\"flex items-center gap-1.5\">\n                <Flame className=\"h-4 w-4 text-gold\" />\n                <span className=\"font-medium tabular-nums\">{userProfile.currentStreak}d</span>\n              </div>\n            )}\n            <div className=\"flex-1 flex items-center gap-2 ml-2\">\n              <Progress value={progressPercent} className=\"h-1.5 flex-1\" aria-label=\"Level progress\" />\n              <span className=\"text-xs text-muted-foreground\">{xpToNext} XP to go</span>\n            </div>\n          </div>\n        </header>\n\n        {/* Tab Navigation */}\n        <Tabs defaultValue=\"today\" className=\"space-y-6\">\n          <TabsList className=\"grid w-full grid-cols-3 h-11\">\n            <TabsTrigger value=\"today\" className=\"gap-2\" data-testid=\"tab-today\">\n              <Target className=\"h-4 w-4\" />\n              Today\n              {hasPriorityAction && <span className=\"h-2 w-2 rounded-full bg-primary\" />}\n            </TabsTrigger>\n            <TabsTrigger value=\"skills\" className=\"gap-2\" data-testid=\"tab-skills\">\n              <Brain className=\"h-4 w-4\" />\n              Skills\n              {skillsCount > 0 && <Badge variant=\"secondary\" className=\"text-xs h-5\">{skillsCount}</Badge>}\n            </TabsTrigger>\n            <TabsTrigger value=\"progress\" className=\"gap-2\" data-testid=\"tab-progress\">\n              <BarChart3 className=\"h-4 w-4\" />\n              Progress\n            </TabsTrigger>\n          </TabsList>\n\n          {/* TODAY TAB */}\n          <TabsContent value=\"today\" className=\"space-y-4\" role=\"tabpanel\" aria-label=\"Today's learning activities\">\n            {/* AI Learning Coach Insights */}\n            {aiInsights.length > 0 && (\n              <div className=\"p-4 rounded-xl bg-gradient-to-r from-primary/5 via-accent/5 to-primary/5 border border-primary/10\" data-testid=\"ai-insights-panel\">\n                <div className=\"flex items-center gap-2 mb-3\">\n                  <div className=\"flex h-6 w-6 items-center justify-center rounded-full bg-primary/10\">\n                    <Sparkles className=\"h-3.5 w-3.5 text-primary\" />\n                  </div>\n                  <span className=\"text-xs font-medium text-primary uppercase tracking-wide\">AI Learning Coach</span>\n                </div>\n                <div className=\"space-y-2\">\n                  {aiInsights.map((insight, i) => (\n                    <div key={i} className=\"flex items-start gap-3 group\" data-testid={`insight-${i}`}>\n                      <div className=\"flex h-7 w-7 items-center justify-center rounded-lg bg-card border flex-shrink-0 mt-0.5\">\n                        {insight.icon === \"lightbulb\" && <Lightbulb className=\"h-3.5 w-3.5 text-gold\" />}\n                        {insight.icon === \"trending\" && <TrendingUp className=\"h-3.5 w-3.5 text-success\" />}\n                        {insight.icon === \"target\" && <Target className=\"h-3.5 w-3.5 text-primary\" />}\n                        {insight.icon === \"flame\" && <Flame className=\"h-3.5 w-3.5 text-gold\" />}\n                        {insight.icon === \"brain\" && <Brain className=\"h-3.5 w-3.5 text-primary\" />}\n                      </div>\n                      <div className=\"flex-1 min-w-0\">\n                        <p className=\"text-sm leading-relaxed\">{insight.text}</p>\n                      </div>\n                      {insight.action === \"quiz\" && onStartDailyQuiz && (\n                        <Button variant=\"ghost\" size=\"sm\" onClick={onStartDailyQuiz} className=\"gap-1 flex-shrink-0\" aria-label=\"Start quiz now\" data-testid={`button-insight-action-${i}`}>\n                          <ArrowUpRight className=\"h-3.5 w-3.5\" />\n                        </Button>\n                      )}\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {/* Daily Quiz with Topic Preview */}\n            {dailyQuizStatus?.hasDueTopics && onStartDailyQuiz && (\n              <div className=\"rounded-xl bg-primary/5 border border-primary/20 overflow-hidden\">\n                <div className=\"p-5\">\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"flex h-11 w-11 items-center justify-center rounded-full bg-primary/10\">\n                      <Target className=\"h-5 w-5 text-primary\" />\n                    </div>\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center gap-2\">\n                        <h2 className=\"font-serif text-lg font-medium\">Daily Quiz</h2>\n                        <Badge className=\"bg-primary/20 text-primary border-0 text-xs\">{dailyQuizStatus.dueTopicsCount} topics</Badge>\n                      </div>\n                      <p className=\"text-sm text-muted-foreground\">Practice to strengthen memory</p>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <Button variant=\"ghost\" size=\"sm\" onClick={() => setTopicPreviewOpen(!topicPreviewOpen)} className=\"gap-1.5 text-xs\" data-testid=\"button-preview-topics\">\n                        <ChevronDown className={`h-3.5 w-3.5 transition-transform ${topicPreviewOpen ? 'rotate-180' : ''}`} />\n                        Preview\n                      </Button>\n                      <Button onClick={onStartDailyQuiz} className=\"gap-2\" data-testid=\"button-start-daily-quiz\">\n                        <Zap className=\"h-4 w-4\" />Start\n                      </Button>\n                    </div>\n                  </div>\n                </div>\n                \n                {/* Topic Preview Collapsible */}\n                {topicPreviewOpen && dailyQuizStatus.dueTopics.length > 0 && (\n                  <div className=\"px-5 pb-5\">\n                    <div className=\"border-t border-primary/10 pt-4\">\n                      <p className=\"text-xs text-muted-foreground mb-3\">Topics to review:</p>\n                      <div className=\"space-y-2\">\n                        {dailyQuizStatus.dueTopics.slice(0, 5).map((topic, i) => (\n                          <div key={i} className=\"flex items-center justify-between gap-3 py-2 px-3 rounded-lg bg-background/50\" data-testid={`topic-preview-${i}`}>\n                            <div className=\"flex-1 min-w-0\">\n                              <p className=\"text-sm font-medium truncate\">{topic.topic}</p>\n                              <p className=\"text-xs text-muted-foreground truncate\">{topic.lectureTitle}</p>\n                            </div>\n                            <div className=\"flex items-center gap-2 flex-shrink-0\">\n                              {topic.lastScore > 0 && (\n                                <span className=\"text-xs text-muted-foreground tabular-nums\">{topic.lastScore}%</span>\n                              )}\n                              <Badge \n                                variant=\"secondary\" \n                                className={`text-xs ${\n                                  topic.reason === 'overdue' ? 'bg-destructive/10 text-destructive border-destructive/20' :\n                                  topic.reason === 'weak' ? 'bg-gold/10 text-gold border-gold/20' :\n                                  topic.reason === 'new' ? 'bg-primary/10 text-primary border-primary/20' :\n                                  'bg-muted'\n                                }`}\n                              >\n                                {topic.reason}\n                              </Badge>\n                            </div>\n                          </div>\n                        ))}\n                        {dailyQuizStatus.dueTopics.length > 5 && (\n                          <p className=\"text-xs text-muted-foreground text-center pt-1\">\n                            +{dailyQuizStatus.dueTopics.length - 5} more topics\n                          </p>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n                )}\n              </div>\n            )}\n\n            {/* Reviews Due */}\n            {hasReviewsDue && (\n              <div className=\"p-5 rounded-xl bg-accent/20 border border-accent/30\">\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"flex h-11 w-11 items-center justify-center rounded-full bg-accent/30\">\n                    <Bell className=\"h-5 w-5 text-accent-foreground\" />\n                  </div>\n                  <div className=\"flex-1\">\n                    <h2 className=\"font-serif text-lg font-medium\">{lecturesNeedingReview.length} lecture{lecturesNeedingReview.length !== 1 ? 's' : ''} ready</h2>\n                    <p className=\"text-sm text-muted-foreground\">Complete a review to earn XP</p>\n                  </div>\n                </div>\n                <div className=\"flex flex-wrap gap-2 mt-4 pl-[60px]\">\n                  {lecturesNeedingReview.slice(0, 3).map((lecture) => (\n                    <Button key={lecture.id} onClick={() => onStartReview(lecture.id)} variant=\"outline\" size=\"sm\" className=\"gap-1.5\" data-testid={`button-review-${lecture.id}`}>\n                      <Play className=\"h-3.5 w-3.5\" />{lecture.title}\n                    </Button>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {/* Upload CTA when empty */}\n            {!hasPriorityAction && lectureHistory.length === 0 && (\n              <div className=\"p-8 rounded-xl border border-dashed text-center\">\n                <Upload className=\"h-10 w-10 text-muted-foreground mx-auto mb-4\" />\n                <h2 className=\"font-serif text-lg font-medium mb-2\">Get Started</h2>\n                <p className=\"text-muted-foreground mb-4\">Upload your first lecture to begin learning</p>\n                <Button onClick={onStartUpload} className=\"gap-2\" data-testid=\"button-upload-first\">\n                  <Upload className=\"h-4 w-4\" />Upload Lecture\n                </Button>\n              </div>\n            )}\n\n            {/* Upcoming Schedule */}\n            {(upcomingLectures.length > 0 || upcomingExams.length > 0) && (\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <h3 className=\"font-serif text-lg\">Upcoming</h3>\n                  {hasCalendar && (\n                    <Button variant=\"ghost\" size=\"sm\" onClick={() => refreshCalendarMutation.mutate()} disabled={refreshCalendarMutation.isPending} className=\"gap-1.5 text-xs\" data-testid=\"button-refresh-calendar\">\n                      <RefreshCw className={`h-3.5 w-3.5 ${refreshCalendarMutation.isPending ? 'animate-spin' : ''}`} />Sync\n                    </Button>\n                  )}\n                </div>\n                <div className=\"space-y-2\">\n                  {upcomingExams.slice(0, 2).map((event) => (\n                    <div key={event.id} className=\"flex items-center gap-3 p-3 rounded-lg bg-gold/5 border border-gold/20\" data-testid={`exam-event-${event.id}`}>\n                      <FileCheck className=\"h-4 w-4 text-gold\" />\n                      <div className=\"flex-1 min-w-0\">\n                        <p className=\"font-medium text-sm truncate\">{event.title}</p>\n                        <p className=\"text-xs text-muted-foreground\">{formatEventDate(event.startsAt)}</p>\n                      </div>\n                    </div>\n                  ))}\n                  {upcomingLectures.slice(0, 3).map((event) => (\n                    <div key={event.id} className=\"flex items-center gap-3 p-3 rounded-lg bg-card border\" data-testid={`calendar-event-${event.id}`}>\n                      <CalendarDays className=\"h-4 w-4 text-primary\" />\n                      <div className=\"flex-1 min-w-0\">\n                        <p className=\"font-medium text-sm truncate\">{event.title}</p>\n                        <p className=\"text-xs text-muted-foreground\">{formatEventDate(event.startsAt)}</p>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {/* Missed Lectures Section */}\n            {missingLectures.length > 0 && (\n              <Collapsible open={missedLecturesOpen || missingLectures.length <= 3} onOpenChange={setMissedLecturesOpen}>\n                <div className=\"rounded-xl border border-destructive/20 bg-destructive/5 overflow-hidden\">\n                  <CollapsibleTrigger className=\"w-full p-4 flex items-center justify-between hover-elevate\" data-testid=\"button-toggle-missed-lectures\">\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"flex h-8 w-8 items-center justify-center rounded-full bg-destructive/10\">\n                        <Clock className=\"h-4 w-4 text-destructive\" />\n                      </div>\n                      <div className=\"text-left\">\n                        <div className=\"flex items-center gap-2\">\n                          <span className=\"font-medium text-sm\">Missed Lectures</span>\n                          <Badge variant=\"secondary\" className=\"bg-destructive/10 text-destructive border-destructive/20 text-xs\">\n                            {missingLectures.length}\n                          </Badge>\n                        </div>\n                        <p className=\"text-xs text-muted-foreground\">Past lectures without uploads</p>\n                      </div>\n                    </div>\n                    {missingLectures.length > 3 && (\n                      <ChevronDown className={`h-4 w-4 text-muted-foreground transition-transform ${missedLecturesOpen ? 'rotate-180' : ''}`} />\n                    )}\n                  </CollapsibleTrigger>\n                  \n                  <CollapsibleContent>\n                    <div className=\"px-4 pb-4 space-y-2\">\n                      {missingLectures.map((event) => (\n                        <div key={event.id} className=\"flex items-center justify-between gap-3 p-3 rounded-lg bg-background/50\" data-testid={`missed-lecture-${event.id}`}>\n                          <div className=\"flex-1 min-w-0\">\n                            <p className=\"font-medium text-sm truncate\">{event.title}</p>\n                            <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                              <span>{formatEventDate(event.startsAt)}</span>\n                              {event.location && (\n                                <>\n                                  <span></span>\n                                  <span className=\"flex items-center gap-1 truncate\">\n                                    <MapPin className=\"h-3 w-3\" />\n                                    {event.location}\n                                  </span>\n                                </>\n                              )}\n                            </div>\n                          </div>\n                          <Tooltip>\n                            <TooltipTrigger asChild>\n                              <Button \n                                variant=\"ghost\" \n                                size=\"sm\" \n                                onClick={() => dismissLectureMutation.mutate(event.id)}\n                                disabled={dismissLectureMutation.isPending}\n                                className=\"gap-1.5 text-xs text-muted-foreground hover:text-foreground flex-shrink-0\"\n                                data-testid={`button-dismiss-${event.id}`}\n                              >\n                                <EyeOff className=\"h-3.5 w-3.5\" />\n                                Forget\n                              </Button>\n                            </TooltipTrigger>\n                            <TooltipContent>Dismiss this lecture from missed list</TooltipContent>\n                          </Tooltip>\n                        </div>\n                      ))}\n                    </div>\n                  </CollapsibleContent>\n                </div>\n              </Collapsible>\n            )}\n\n            {/* Study Materials */}\n            {lectureHistory.length > 0 && (\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <h3 className=\"font-serif text-lg\">Study Materials</h3>\n                  <Button onClick={onStartUpload} variant=\"outline\" size=\"sm\" className=\"gap-1.5\" data-testid=\"button-upload\">\n                    <Upload className=\"h-3.5 w-3.5\" />Add\n                  </Button>\n                </div>\n                <div className=\"divide-y divide-border rounded-lg border overflow-hidden\">\n                  {lectureHistory.slice(0, 5).map((lecture) => (\n                    <div key={lecture.id} className=\"flex items-center justify-between p-3 bg-card group\">\n                      <div className=\"flex items-center gap-3 min-w-0 flex-1\">\n                        <BookOpen className=\"h-4 w-4 text-primary flex-shrink-0\" />\n                        <div className=\"min-w-0\">\n                          <p className=\"font-medium text-sm truncate\">{lecture.title}</p>\n                          <p className=\"text-xs text-muted-foreground\">{formatDate(lecture.date)} {lecture.reviewScore > 0 && ` ${lecture.reviewScore}%`}</p>\n                        </div>\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        {lecture.xpEarned > 0 && <Badge variant=\"secondary\" className=\"text-xs bg-gold/10 text-gold border-gold/20\">+{lecture.xpEarned}</Badge>}\n                        {lecture.needsReview && (\n                          <Button onClick={() => onStartReview(lecture.id)} size=\"sm\" variant=\"ghost\" className=\"gap-1 h-7\" data-testid={`button-start-review-${lecture.id}`}>\n                            <Play className=\"h-3 w-3\" />Review\n                          </Button>\n                        )}\n                        {onDeleteLecture && (\n                          <Button variant=\"ghost\" size=\"icon\" onClick={() => onDeleteLecture(lecture.id)} className=\"h-7 w-7 opacity-0 group-hover:opacity-100\" data-testid={`button-delete-lecture-${lecture.id}`} aria-label=\"Delete\">\n                            <Trash2 className=\"h-3.5 w-3.5\" />\n                          </Button>\n                        )}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n          </TabsContent>\n\n          {/* SKILLS TAB */}\n          <TabsContent value=\"skills\" className=\"space-y-6\" role=\"tabpanel\" aria-label=\"Your transferable skills profile\" data-testid=\"section-skills-profile\">\n            {skillsData && skillsData.skills.length > 0 ? (\n              <>\n                {/* Skills Summary */}\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <h2 className=\"font-serif text-xl\">Your Skills Profile</h2>\n                    <p className=\"text-sm text-muted-foreground\">{skillsData.totalSkills} transferable skills from your learning</p>\n                  </div>\n                  <Button onClick={exportSkills} variant=\"outline\" size=\"sm\" className=\"gap-1.5\" data-testid=\"button-export-skills\">\n                    <Download className=\"h-3.5 w-3.5\" />Export\n                  </Button>\n                </div>\n\n                {/* Proficiency Breakdown */}\n                <div className=\"grid grid-cols-3 gap-3\">\n                  <div className=\"p-4 rounded-lg bg-success/5 border border-success/20 text-center\">\n                    <GraduationCap className=\"h-5 w-5 text-success mx-auto mb-1\" />\n                    <p className=\"text-2xl font-semibold text-success\" data-testid=\"text-proficient-count\">{skillsData.proficientCount}</p>\n                    <p className=\"text-xs text-muted-foreground\">Proficient</p>\n                  </div>\n                  <div className=\"p-4 rounded-lg bg-gold/5 border border-gold/20 text-center\">\n                    <TrendingUp className=\"h-5 w-5 text-gold mx-auto mb-1\" />\n                    <p className=\"text-2xl font-semibold text-gold\" data-testid=\"text-intermediate-count\">{skillsData.intermediateCount}</p>\n                    <p className=\"text-xs text-muted-foreground\">Intermediate</p>\n                  </div>\n                  <div className=\"p-4 rounded-lg bg-primary/5 border border-primary/20 text-center\">\n                    <Brain className=\"h-5 w-5 text-primary mx-auto mb-1\" />\n                    <p className=\"text-2xl font-semibold text-primary\" data-testid=\"text-developing-count\">{skillsData.developingCount}</p>\n                    <p className=\"text-xs text-muted-foreground\">Developing</p>\n                  </div>\n                </div>\n\n                {/* Skills List with Progress Visualization */}\n                <div className=\"space-y-3\">\n                  {skillsData.skills.map((skill, index) => {\n                    const proficiencyPercent = skill.proficiencyLevel === \"proficient\" ? 100 : skill.proficiencyLevel === \"intermediate\" ? 66 : 33;\n                    const proficiencyColor = skill.proficiencyLevel === \"proficient\" ? \"bg-success\" : skill.proficiencyLevel === \"intermediate\" ? \"bg-gold\" : \"bg-primary\";\n                    return (\n                      <div key={skill.name} className=\"p-4 rounded-lg bg-card border group transition-all hover:border-primary/30\" data-testid={`skill-item-${index}`}>\n                        <div className=\"flex items-start gap-3\">\n                          <div className={`flex h-9 w-9 items-center justify-center rounded-lg transition-transform group-hover:scale-105 ${\n                            skill.proficiencyLevel === \"proficient\" ? \"bg-success/10\" :\n                            skill.proficiencyLevel === \"intermediate\" ? \"bg-gold/10\" : \"bg-primary/10\"\n                          }`}>\n                            <Brain className={`h-4 w-4 ${\n                              skill.proficiencyLevel === \"proficient\" ? \"text-success\" :\n                              skill.proficiencyLevel === \"intermediate\" ? \"text-gold\" : \"text-primary\"\n                            }`} />\n                          </div>\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center justify-between gap-2 mb-1\">\n                              <h3 className=\"font-medium text-sm\" data-testid={`text-skill-name-dashboard-${index}`}>{skill.name}</h3>\n                              <span className={`text-xs font-medium capitalize ${\n                                skill.proficiencyLevel === \"proficient\" ? \"text-success\" :\n                                skill.proficiencyLevel === \"intermediate\" ? \"text-gold\" : \"text-primary\"\n                              }`}>{skill.proficiencyLevel}</span>\n                            </div>\n                            {/* Skill Progress Bar */}\n                            <div className=\"h-1.5 bg-muted rounded-full overflow-hidden mb-2\">\n                              <div className={`h-full ${proficiencyColor} rounded-full transition-all duration-500`} style={{ width: `${proficiencyPercent}%` }} />\n                            </div>\n                            <p className=\"text-xs text-muted-foreground\">{skill.description}</p>\n                            <div className=\"flex items-center gap-1.5 mt-2 flex-wrap\">\n                              <Briefcase className=\"h-3 w-3 text-muted-foreground flex-shrink-0\" />\n                              {skill.relevantCareers.slice(0, 3).map((career, i) => (\n                                <Badge key={career} variant=\"secondary\" className=\"text-xs\" data-testid={`badge-career-${index}-${i}`}>{career}</Badge>\n                              ))}\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    );\n                  })}\n                </div>\n              </>\n            ) : (\n              <div className=\"p-8 rounded-xl border border-dashed text-center\">\n                <Brain className=\"h-10 w-10 text-muted-foreground mx-auto mb-4\" />\n                <h2 className=\"font-serif text-lg font-medium mb-2\">No Skills Yet</h2>\n                <p className=\"text-muted-foreground mb-4\">Complete quizzes to identify your transferable skills</p>\n                <Button onClick={onStartUpload} variant=\"outline\" className=\"gap-2\">\n                  <Upload className=\"h-4 w-4\" />Upload a Lecture\n                </Button>\n              </div>\n            )}\n          </TabsContent>\n\n          {/* PROGRESS TAB */}\n          <TabsContent value=\"progress\" className=\"space-y-6\" role=\"tabpanel\" aria-label=\"Your learning progress\">\n            {/* Streak Visualization */}\n            {userProfile.currentStreak > 0 && (\n              <div className=\"p-5 rounded-xl bg-gradient-to-r from-gold/10 via-gold/5 to-gold/10 border border-gold/20\">\n                <div className=\"flex items-center justify-between mb-3\">\n                  <div className=\"flex items-center gap-2\">\n                    <Flame className=\"h-5 w-5 text-gold\" />\n                    <span className=\"font-serif text-lg font-medium\">{userProfile.currentStreak}-Day Streak</span>\n                  </div>\n                  {userProfile.longestStreak > userProfile.currentStreak && (\n                    <span className=\"text-xs text-muted-foreground\">Best: {userProfile.longestStreak} days</span>\n                  )}\n                </div>\n                <div className=\"flex gap-1\">\n                  {Array.from({ length: 7 }).map((_, i) => {\n                    const isActive = i < Math.min(userProfile.currentStreak, 7);\n                    const isMilestone = (i + 1) === 7;\n                    return (\n                      <div \n                        key={i} \n                        className={`flex-1 h-2 rounded-full transition-all ${\n                          isActive ? (isMilestone ? \"bg-gold\" : \"bg-gold/60\") : \"bg-muted\"\n                        }`}\n                        aria-label={`Day ${i + 1}: ${isActive ? \"completed\" : \"pending\"}`}\n                      />\n                    );\n                  })}\n                </div>\n                <p className=\"text-xs text-muted-foreground mt-2\">\n                  {userProfile.currentStreak >= 7 \n                    ? \"Week complete! Keep building your learning habit.\" \n                    : `${7 - userProfile.currentStreak} more day${7 - userProfile.currentStreak !== 1 ? 's' : ''} to complete the week`}\n                </p>\n              </div>\n            )}\n\n            {/* Stats Grid */}\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n              <div className=\"p-4 rounded-lg bg-card border text-center group hover:border-gold/30 transition-colors\">\n                <Zap className=\"h-5 w-5 text-gold mx-auto mb-1 group-hover:scale-110 transition-transform\" />\n                <p className=\"text-2xl font-semibold text-gold tabular-nums\">{userProfile.totalXP.toLocaleString()}</p>\n                <p className=\"text-xs text-muted-foreground\">Total XP</p>\n              </div>\n              <div className=\"p-4 rounded-lg bg-card border text-center group hover:border-primary/30 transition-colors\">\n                <BookOpen className=\"h-5 w-5 text-primary mx-auto mb-1 group-hover:scale-110 transition-transform\" />\n                <p className=\"text-2xl font-semibold tabular-nums\">{lectureHistory.length}</p>\n                <p className=\"text-xs text-muted-foreground\">Lectures</p>\n              </div>\n              <div className=\"p-4 rounded-lg bg-card border text-center group hover:border-success/30 transition-colors\">\n                <Target className={`h-5 w-5 mx-auto mb-1 group-hover:scale-110 transition-transform ${averageAccuracy >= 80 ? \"text-success\" : averageAccuracy >= 60 ? \"text-gold\" : \"text-muted-foreground\"}`} />\n                <p className={`text-2xl font-semibold tabular-nums ${averageAccuracy >= 80 ? \"text-success\" : averageAccuracy >= 60 ? \"text-gold\" : \"\"}`}>{averageAccuracy}%</p>\n                <p className=\"text-xs text-muted-foreground\">Accuracy</p>\n              </div>\n              <div className=\"p-4 rounded-lg bg-card border text-center group hover:border-gold/30 transition-colors\">\n                <Flame className={`h-5 w-5 mx-auto mb-1 group-hover:scale-110 transition-transform ${userProfile.currentStreak > 0 ? \"text-gold\" : \"text-muted-foreground\"}`} />\n                <p className=\"text-2xl font-semibold tabular-nums\">{userProfile.currentStreak}</p>\n                <p className=\"text-xs text-muted-foreground\">Day Streak</p>\n              </div>\n            </div>\n\n            {/* Impact Metrics */}\n            <div className=\"grid grid-cols-3 gap-4\">\n              <div className=\"p-4 rounded-lg bg-card border\" data-testid=\"stat-questions-answered\">\n                <div className=\"flex items-center gap-2 mb-1\">\n                  <Target className=\"h-4 w-4 text-primary\" />\n                  <span className=\"text-xs text-muted-foreground\">Questions</span>\n                </div>\n                <p className=\"text-xl font-semibold tabular-nums\">{totalQuestionsAnswered}</p>\n              </div>\n              <div className=\"p-4 rounded-lg bg-card border\" data-testid=\"stat-topics-mastered\">\n                <div className=\"flex items-center gap-2 mb-1\">\n                  <Trophy className={`h-4 w-4 ${masteredTopicsCount > 0 ? \"text-gold\" : \"text-muted-foreground\"}`} />\n                  <span className=\"text-xs text-muted-foreground\">Mastered</span>\n                </div>\n                <p className={`text-xl font-semibold tabular-nums ${masteredTopicsCount > 0 ? \"text-gold\" : \"\"}`}>{masteredTopicsCount}</p>\n              </div>\n              <div className=\"p-4 rounded-lg bg-card border\" data-testid=\"stat-skills-developed\">\n                <div className=\"flex items-center gap-2 mb-1\">\n                  <Brain className={`h-4 w-4 ${skillsCount > 0 ? \"text-primary\" : \"text-muted-foreground\"}`} />\n                  <span className=\"text-xs text-muted-foreground\">Skills</span>\n                </div>\n                <p className={`text-xl font-semibold tabular-nums ${skillsCount > 0 ? \"text-primary\" : \"\"}`}>{skillsCount}</p>\n              </div>\n            </div>\n\n            {/* Achievements */}\n            <div>\n              <div className=\"flex items-center justify-between mb-3\">\n                <h3 className=\"font-serif text-lg\">Achievements</h3>\n                <Button variant=\"ghost\" size=\"sm\" onClick={onViewAchievements} className=\"gap-1 text-xs\" data-testid=\"button-view-achievements\">\n                  View All<ChevronRight className=\"h-3.5 w-3.5\" />\n                </Button>\n              </div>\n              <div className=\"flex flex-wrap gap-2\">\n                {userProfile.achievements.slice(0, 6).map((achievement) => (\n                  <Tooltip key={achievement.id}>\n                    <TooltipTrigger asChild>\n                      <div className={`flex items-center gap-2 px-3 py-2 rounded-lg ${achievement.unlocked ? \"bg-gold/5 border border-gold/20\" : \"opacity-40\"}`}>\n                        {getAchievementIcon(achievement.icon)}\n                        <span className=\"text-xs font-medium\">{achievement.name}</span>\n                        {!achievement.unlocked && achievement.maxProgress && (\n                          <span className=\"text-xs text-muted-foreground\">{achievement.progress || 0}/{achievement.maxProgress}</span>\n                        )}\n                      </div>\n                    </TooltipTrigger>\n                    <TooltipContent>\n                      <p className=\"font-medium\">{achievement.name}</p>\n                      <p className=\"text-xs text-muted-foreground\">{achievement.description}</p>\n                    </TooltipContent>\n                  </Tooltip>\n                ))}\n              </div>\n            </div>\n\n            {/* Power-ups */}\n            {(userProfile.powerUps.secondChance > 0 || userProfile.powerUps.hints > 0 || userProfile.powerUps.doubleXP) && (\n              <div>\n                <h3 className=\"font-serif text-lg mb-3\">Power-Ups</h3>\n                <div className=\"flex flex-wrap gap-2\">\n                  {userProfile.powerUps.secondChance > 0 && (\n                    <div className=\"flex items-center gap-2 px-3 py-2 rounded-lg bg-primary/10 border border-primary/20\">\n                      <span className=\"text-sm\">Second Chance</span>\n                      <Badge variant=\"secondary\" className=\"text-xs\">{userProfile.powerUps.secondChance}</Badge>\n                    </div>\n                  )}\n                  {userProfile.powerUps.hints > 0 && (\n                    <div className=\"flex items-center gap-2 px-3 py-2 rounded-lg bg-gold/10 border border-gold/20\">\n                      <span className=\"text-sm\">Hints</span>\n                      <Badge variant=\"secondary\" className=\"text-xs\">{userProfile.powerUps.hints}</Badge>\n                    </div>\n                  )}\n                  {userProfile.powerUps.doubleXP && (\n                    <div className=\"flex items-center gap-2 px-3 py-2 rounded-lg bg-success/10 border border-success/20\">\n                      <Zap className=\"h-4 w-4 text-success\" />\n                      <span className=\"text-sm font-medium text-success\">Double XP</span>\n                    </div>\n                  )}\n                </div>\n              </div>\n            )}\n          </TabsContent>\n        </Tabs>\n      </div>\n      \n      {/* Calendar Dialog */}\n      <Dialog open={calendarDialogOpen} onOpenChange={setCalendarDialogOpen}>\n        <DialogContent className=\"sm:max-w-md\">\n          <DialogHeader>\n            <DialogTitle className=\"font-serif\">{hasCalendar ? \"Calendar Settings\" : \"Connect Your Calendar\"}</DialogTitle>\n            <DialogDescription>{hasCalendar ? \"Manage your lecture calendar\" : \"Add your calendar to track upcoming classes\"}</DialogDescription>\n          </DialogHeader>\n          {hasCalendar ? (\n            <div className=\"space-y-4 pt-4\">\n              <div className=\"flex items-center gap-3 p-3 rounded-lg bg-primary/5 border border-primary/20\">\n                <Calendar className=\"h-5 w-5 text-primary\" />\n                <div className=\"flex-1\">\n                  <p className=\"font-medium text-sm\">Connected</p>\n                  <p className=\"text-xs text-muted-foreground\">{calendarData?.lectureCount || 0} lectures found</p>\n                </div>\n              </div>\n              <div className=\"flex gap-2\">\n                <Button variant=\"outline\" className=\"flex-1 gap-2\" onClick={() => refreshCalendarMutation.mutate()} disabled={refreshCalendarMutation.isPending} data-testid=\"button-dialog-refresh\">\n                  <RefreshCw className={`h-4 w-4 ${refreshCalendarMutation.isPending ? 'animate-spin' : ''}`} />Refresh\n                </Button>\n                <Button variant=\"destructive\" className=\"flex-1 gap-2\" onClick={() => removeCalendarMutation.mutate()} data-testid=\"button-remove-calendar\">\n                  <X className=\"h-4 w-4\" />Remove\n                </Button>\n              </div>\n            </div>\n          ) : (\n            <div className=\"space-y-4 pt-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"calendar-url\">Calendar Share Link</Label>\n                <Input id=\"calendar-url\" placeholder=\"https://...calendar.ics\" value={calendarUrl} onChange={(e) => setCalendarUrl(e.target.value)} data-testid=\"input-calendar-url\" />\n                <p className=\"text-xs text-muted-foreground\">Paste the ICS link from your university calendar</p>\n              </div>\n              <Button className=\"w-full gap-2\" onClick={() => setCalendarMutation.mutate(calendarUrl)} disabled={!calendarUrl.trim() || setCalendarMutation.isPending} data-testid=\"button-connect-calendar\">\n                {setCalendarMutation.isPending ? <><Loader2 className=\"h-4 w-4 animate-spin\" />Connecting...</> : <><Calendar className=\"h-4 w-4\" />Connect</>}\n              </Button>\n            </div>\n          )}\n        </DialogContent>\n      </Dialog>\n\n      {/* Demo Dialog */}\n      <AlertDialog open={demoDialogOpen} onOpenChange={setDemoDialogOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle className=\"font-serif\">Enter Demo Mode?</AlertDialogTitle>\n            <AlertDialogDescription>This will load sample data to demonstrate the app's features.</AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel data-testid=\"button-demo-cancel\">Cancel</AlertDialogCancel>\n            <AlertDialogAction onClick={() => demoModeMutation.mutate()} disabled={demoModeMutation.isPending} className=\"gap-2\" data-testid=\"button-demo-confirm\">\n              {demoModeMutation.isPending ? <><Loader2 className=\"h-4 w-4 animate-spin\" />Loading...</> : <><Sparkles className=\"h-4 w-4\" />Enter Demo</>}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </div>\n  );\n}\n\nfunction getAchievementIcon(iconName: string) {\n  const icons: Record<string, JSX.Element> = {\n    footprints: <TrendingUp className=\"h-4 w-4 text-gold\" />,\n    zap: <Zap className=\"h-4 w-4 text-gold\" />,\n    \"book-open\": <BookOpen className=\"h-4 w-4 text-gold\" />,\n    \"trending-up\": <TrendingUp className=\"h-4 w-4 text-gold\" />,\n    star: <Award className=\"h-4 w-4 text-gold\" />,\n    flame: <Flame className=\"h-4 w-4 text-gold\" />,\n    crown: <Trophy className=\"h-4 w-4 text-gold\" />,\n    moon: <Award className=\"h-4 w-4 text-gold\" />,\n    sunrise: <Award className=\"h-4 w-4 text-gold\" />,\n    target: <Target className=\"h-4 w-4 text-gold\" />,\n    search: <BookOpen className=\"h-4 w-4 text-gold\" />,\n  };\n  return icons[iconName] || <Trophy className=\"h-4 w-4 text-gold\" />;\n}\n","path":null,"size_bytes":52587,"size_tokens":null},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","path":null,"size_bytes":1584,"size_tokens":null},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","path":null,"size_bytes":2359,"size_tokens":null},"design_guidelines.md":{"content":"# LectureQuest Design Guidelines\n\n## Design Philosophy\n\nLectureQuest follows a \"quiet luxury\" aesthetic inspired by modern editorial design. The visual language balances **warmth and professionalism**, creating an inviting learning environment that feels sophisticated yet approachable.\n\n### Core Principles\n- **Editorial elegance** - Every element serves emotional or cognitive clarity\n- **Warm minimalism** - Clean layouts with purposeful whitespace\n- **Human-centered** - Feels welcoming, not clinical or cold\n- **Restrained, bold when needed** - Subtle by default, impactful at key moments\n\n---\n\n## Color Palette\n\n### Light Mode\n| Role | Color | HSL |\n|------|-------|-----|\n| Background | Warm Cream | `43 60% 98%` (#FFFDF9) |\n| Primary | Forest Green | `171 93% 16%` (#034F46) |\n| Accent | Soft Lavender | `282 60% 94%` (#F0D7FF) |\n| Text | Near Black | `0 0% 10%` (#1A1A1A) |\n| Card | Warm White | `43 40% 97%` |\n| Muted | Cream Gray | `43 20% 92%` |\n| Gold (XP) | Warm Gold | `40 85% 55%` |\n| Success | Teal Green | `160 60% 35%` |\n\n### Dark Mode\n| Role | Color | HSL |\n|------|-------|-----|\n| Background | Deep Forest | `170 15% 8%` |\n| Primary | Bright Teal | `160 60% 45%` |\n| Accent | Muted Lavender | `282 40% 25%` |\n| Text | Warm White | `40 20% 95%` |\n| Card | Dark Forest | `170 12% 11%` |\n\n### Usage Guidelines\n- Use **primary (forest green)** for main CTAs and important UI elements\n- Use **accent (lavender)** for secondary buttons and highlights\n- Use **gold** sparingly for XP, achievements, and celebration moments\n- Never use pure white (#FFF) for backgrounds - always use warm cream tones\n\n---\n\n## Typography\n\n### Font Families\n- **Headings**: EB Garamond (serif) - Elegant, editorial feel\n- **Body/UI**: Figtree (sans-serif) - Clean, modern, highly readable\n\n### Type Scale\n| Element | Size | Weight | Font |\n|---------|------|--------|------|\n| Display Hero | 4.5rem | 400 | EB Garamond |\n| H1 | 2.5rem | 500 | EB Garamond |\n| H2 | 1.75rem | 500 | EB Garamond |\n| H3 | 1.25rem | 500 | Figtree |\n| Body | 1rem | 400 | Figtree |\n| Small | 0.875rem | 400 | Figtree |\n| Caption | 0.75rem | 400 | Figtree |\n\n### Typography Rules\n- Use serif (EB Garamond) for headlines and display text\n- Use sans-serif (Figtree) for body text, labels, and UI elements\n- Maintain generous line-height (1.5-1.75) for readability\n- Use tracking-tight (-0.02em) for large headlines\n\n---\n\n## Spacing & Layout\n\n### Container Widths\n- **Max content width**: 1200px (max-w-5xl)\n- **Narrow content**: 640px (max-w-xl) - for forms, modals\n- **Reading width**: 720px (max-w-2xl) - for quizzes, results\n\n### Spacing Scale\n| Size | Tailwind | Use Case |\n|------|----------|----------|\n| xs | 2 (0.5rem) | Tight inline spacing |\n| sm | 3-4 (0.75-1rem) | Between related items |\n| md | 6 (1.5rem) | Section padding |\n| lg | 8-12 (2-3rem) | Major section breaks |\n| xl | 16-24 (4-6rem) | Page sections |\n\n### Layout Principles\n- Use generous vertical padding (py-16 to py-24) for page sections\n- Cards should have consistent internal padding (p-6)\n- Maintain visual rhythm with consistent spacing between elements\n- Use grid layouts (2-4 columns) for stat cards and achievements\n\n---\n\n## Components\n\n### Buttons\n\n**Primary Button** (Forest Green)\n- Background: primary\n- Text: primary-foreground (white)\n- Border-radius: 12px (rounded-xl)\n- Use for main CTAs: \"Start Quiz\", \"Upload Lecture\"\n\n**Accent Button** (Lavender)\n- Background: accent (soft lavender)\n- Text: foreground (dark)\n- Border: 1px solid foreground/10\n- Use for secondary actions: \"View All\", \"Try Demo\"\n\n**Ghost Button**\n- No background\n- Text: foreground\n- Use for tertiary actions: \"Back\", navigation\n\n### Cards\n\n- Background: card (warm white)\n- Border: subtle (border-border)\n- Border-radius: 12px\n- Shadow: subtle warm shadow (shadow-sm)\n- Hover: subtle lift effect (translateY -2px)\n\n### Badges\n\n**XP/Gold Badge**\n- Background: gold/10\n- Text: gold\n- Border: gold/20\n\n**Achievement Badge**\n- Unlocked: gold background glow\n- Locked: muted background, grayscale icon\n\n### Progress Bars\n\n- Track: muted background\n- Fill: primary (forest green)\n- Height: 6-8px for main progress, 4px for inline\n- Border-radius: full (rounded-full)\n\n---\n\n## Iconography\n\n### Style\n- Use Lucide React icons for all UI icons\n- Icon size: 16-20px for inline, 24px for standalone\n- Stroke width: 1.5-2 for visibility\n- Color: inherit from parent or use semantic colors\n\n### Key Icons\n| Use | Icon | Notes |\n|-----|------|-------|\n| XP | Zap | Gold color |\n| Level | Award | Primary color |\n| Streak | Flame | Gold when active |\n| Upload | Upload | Primary color |\n| Quiz | Play | Primary color |\n| Achievement | Trophy | Gold color |\n| Back | ArrowLeft | Muted color |\n| Theme | Sun/Moon | Muted color |\n\n---\n\n## Animation & Motion\n\n### Principles\n- **Purposeful**: Every animation should serve clarity or delight\n- **Subtle**: Prefer understated over flashy\n- **Quick**: Keep durations under 400ms for UI responses\n\n### Standard Transitions\n- **Hover**: 200ms ease\n- **Focus**: 150ms ease\n- **Page transitions**: 300-400ms ease-out\n- **Loading states**: Subtle shimmer or pulse\n\n### Key Animations\n- **Float up**: XP earned (+10, +50) floats up and fades\n- **Check bounce**: Correct answer checkmark bounces in\n- **Shake**: Wrong answer subtle horizontal shake\n- **Gold pulse**: Achievement unlock subtle glow pulse\n- **Fade in**: Page content fades in with slight upward motion\n\n---\n\n## Gamification Visual Language\n\n### XP & Progress\n- XP numbers always in **gold** color\n- Show progress bars prominently\n- Use **+XX XP** format for earned points\n- Animate XP gains with float-up effect\n\n### Levels\n- Display level number prominently\n- Show level title (e.g., \"Novice Scholar\")\n- Progress to next level with visual bar\n\n### Achievements\n- Unlocked: Gold background, full color icon\n- Locked: Muted background, grayscale icon\n- Progress: Small progress bar below\n\n### Streaks\n- Flame icon in gold when active\n- Display streak count prominently\n- Celebrate milestones (7, 30 days)\n\n---\n\n## Accessibility\n\n### Color Contrast\n- Ensure 4.5:1 minimum for body text\n- Ensure 3:1 minimum for large text and UI elements\n- Test both light and dark modes\n\n### Focus States\n- Visible focus rings on all interactive elements\n- Use ring color matching primary\n- Never remove focus styles\n\n### Motion\n- Respect prefers-reduced-motion\n- Provide non-animated alternatives\n\n---\n\n## Responsive Design\n\n### Breakpoints\n- **sm**: 640px - Stack to single column\n- **md**: 768px - Tablet adjustments\n- **lg**: 1024px - Full desktop layout\n\n### Mobile Considerations\n- Touch targets minimum 44x44px\n- Reduce padding on mobile (py-8 vs py-16)\n- Stack horizontal layouts vertically\n- Simplify navigation on mobile\n","path":null,"size_bytes":6731,"size_tokens":null},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","path":null,"size_bytes":140,"size_tokens":null},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","path":null,"size_bytes":6210,"size_tokens":null},"client/src/components/upload-view.tsx":{"content":"import { useState, useRef, useCallback } from \"react\";\nimport { Upload, FileText, AlertCircle, ArrowLeft, Check, Loader2, BookOpen, Plus, Trash2, Files } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Card } from \"@/components/ui/card\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\ninterface UploadViewProps {\n  onSave: (content: string, title: string) => void;\n  onBack: () => void;\n  isSaving: boolean;\n  error: string | null;\n}\n\ninterface BatchLecture {\n  id: string;\n  title: string;\n  content: string;\n  filename?: string;\n  status: \"pending\" | \"processing\" | \"completed\" | \"error\";\n  error?: string;\n}\n\ninterface BatchResult {\n  batchId: string;\n  total: number;\n  successCount: number;\n  errorCount: number;\n  results: Array<{\n    index: number;\n    lectureId: string | null;\n    title: string;\n    status: \"completed\" | \"error\";\n    error?: string;\n  }>;\n}\n\nfunction extractTitleFromContent(content: string): string {\n  const lines = content.split(/[\\n\\r]+/).map(line => line.trim()).filter(line => line.length > 0);\n  \n  let subjectTitle: string | null = null;\n  const fallbackCandidates: string[] = [];\n  \n  for (let i = 0; i < Math.min(30, lines.length); i++) {\n    const line = lines[i];\n    const lowerLine = line.toLowerCase();\n    \n    if (line.startsWith(\"#\")) {\n      const title = line.replace(/^#+\\s*/, \"\").trim();\n      if (title.length >= 5 && title.length <= 80) {\n        return title;\n      }\n    }\n    \n    if (\n      lowerLine.includes(\"\") ||\n      lowerLine.includes(\"copyright\") ||\n      lowerLine.includes(\"all rights reserved\") ||\n      lowerLine.includes(\"confidential\") ||\n      lowerLine.includes(\"cisco\") ||\n      /^\\d+$/.test(lowerLine) ||\n      /^page\\s+\\d+/.test(lowerLine) ||\n      line.length < 5 ||\n      line.length > 80\n    ) {\n      continue;\n    }\n    \n    if (\n      lowerLine.includes(\"objective\") ||\n      lowerLine.includes(\"description\") ||\n      lowerLine.includes(\"topic title\") ||\n      lowerLine.includes(\"topic objective\") ||\n      lowerLine.startsWith(\"module title:\") ||\n      lowerLine.startsWith(\"chapter title:\") ||\n      lowerLine.startsWith(\"lecture title:\")\n    ) {\n      continue;\n    }\n    \n    const moduleMatch = line.match(/^(?:Module|Chapter|Unit|Lecture)\\s+\\d+\\s*[:\\-]\\s*(.+)/i);\n    if (moduleMatch && moduleMatch[1]) {\n      const extracted = moduleMatch[1].trim();\n      if (extracted.length >= 5 && extracted.length <= 80) {\n        subjectTitle = extracted;\n        continue;\n      }\n    }\n    \n    if (!subjectTitle && line.length >= 8 && line.length <= 60) {\n      if (!lowerLine.includes(\":\") && !lowerLine.match(/^[\\d.]+\\s/)) {\n        fallbackCandidates.push(line);\n      }\n    }\n  }\n  \n  if (subjectTitle) {\n    return subjectTitle;\n  }\n  \n  if (fallbackCandidates.length > 0) {\n    return fallbackCandidates[0];\n  }\n  \n  const firstLine = lines[0]?.trim() || \"\";\n  return firstLine.slice(0, 100) || \"Untitled Lecture\";\n}\n\nexport function UploadView({ onSave, onBack, isSaving, error }: UploadViewProps) {\n  const [dragActive, setDragActive] = useState(false);\n  const [fileName, setFileName] = useState<string | null>(null);\n  const [fileType, setFileType] = useState<string | null>(null);\n  const [content, setContent] = useState(\"\");\n  const [title, setTitle] = useState(\"\");\n  const [parseError, setParseError] = useState<string | null>(null);\n  const [isParsing, setIsParsing] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  \n  // Batch upload state\n  const [batchLectures, setBatchLectures] = useState<BatchLecture[]>([]);\n  const [isBatchUploading, setIsBatchUploading] = useState(false);\n  const [batchProgress, setBatchProgress] = useState(0);\n  const [batchResult, setBatchResult] = useState<BatchResult | null>(null);\n  const [batchError, setBatchError] = useState<string | null>(null);\n  const batchFileInputRef = useRef<HTMLInputElement>(null);\n\n  const handleDrag = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (e.type === \"dragenter\" || e.type === \"dragover\") {\n      setDragActive(true);\n    } else if (e.type === \"dragleave\") {\n      setDragActive(false);\n    }\n  }, []);\n\n  const processFile = useCallback(async (file: File) => {\n    setParseError(null);\n    setFileName(file.name);\n    setFileType(file.type);\n    \n    const supportedTypes = [\n      \"text/plain\",\n      \"application/pdf\", \n      \"text/html\"\n    ];\n    \n    const isSupported = supportedTypes.includes(file.type) || \n      file.name.endsWith(\".txt\") ||\n      file.name.endsWith(\".pdf\") ||\n      file.name.endsWith(\".html\") ||\n      file.name.endsWith(\".htm\");\n\n    if (!isSupported) {\n      setParseError(\"Unsupported file type. Please upload PDF, HTML, or TXT files.\");\n      return;\n    }\n\n    if (file.type === \"text/plain\" || file.name.endsWith(\".txt\")) {\n      const reader = new FileReader();\n      reader.onload = (e) => {\n        const text = e.target?.result as string;\n        setContent(text);\n        const extractedTitle = extractTitleFromContent(text);\n        setTitle(extractedTitle);\n      };\n      reader.readAsText(file);\n    } else {\n      setIsParsing(true);\n      try {\n        const reader = new FileReader();\n        reader.onload = async (e) => {\n          try {\n            const base64 = (e.target?.result as string).split(\",\")[1];\n            \n            const response = await apiRequest(\"POST\", \"/api/parse-file\", {\n              fileData: base64,\n              fileType: file.type,\n              fileName: file.name\n            });\n            \n            const result = await response.json();\n            \n            if (result.error) {\n              setParseError(result.error);\n            } else {\n              setContent(result.text);\n              const extractedTitle = result.title || extractTitleFromContent(result.text);\n              setTitle(extractedTitle);\n            }\n          } catch (err: any) {\n            console.error(\"Parse error:\", err);\n            setParseError(err.message || \"Failed to parse file. Please try again or paste text manually.\");\n          } finally {\n            setIsParsing(false);\n          }\n        };\n        reader.readAsDataURL(file);\n      } catch (err: any) {\n        setIsParsing(false);\n        setParseError(\"Failed to read file. Please try again.\");\n      }\n    }\n  }, []);\n\n  const handleDrop = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setDragActive(false);\n\n    if (e.dataTransfer.files && e.dataTransfer.files[0]) {\n      processFile(e.dataTransfer.files[0]);\n    }\n  }, [processFile]);\n\n  const handleFileInput = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files && e.target.files[0]) {\n      processFile(e.target.files[0]);\n    }\n  }, [processFile]);\n\n  const handleContentChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    const newContent = e.target.value;\n    setContent(newContent);\n    if (!title || title === \"Untitled Lecture\") {\n      const extractedTitle = extractTitleFromContent(newContent);\n      setTitle(extractedTitle);\n    }\n  };\n\n  const handleSubmit = () => {\n    if (content.trim().length >= 50 && title.trim()) {\n      onSave(content.trim(), title.trim());\n    }\n  };\n\n  const clearFile = () => {\n    setFileName(null);\n    setFileType(null);\n    setContent(\"\");\n    setTitle(\"\");\n    setParseError(null);\n    if (fileInputRef.current) {\n      fileInputRef.current.value = \"\";\n    }\n  };\n\n  const canSubmit = content.trim().length >= 50 && title.trim().length > 0;\n\n  const getFileTypeLabel = () => {\n    if (!fileName) return null;\n    if (fileName.endsWith(\".pdf\")) return \"PDF\";\n    if (fileName.endsWith(\".html\") || fileName.endsWith(\".htm\")) return \"HTML\";\n    if (fileName.endsWith(\".txt\")) return \"TXT\";\n    return \"File\";\n  };\n\n  // Batch upload functions\n  const addManualEntry = () => {\n    const newEntry: BatchLecture = {\n      id: `manual-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n      title: \"\",\n      content: \"\",\n      status: \"pending\"\n    };\n    setBatchLectures(prev => [...prev, newEntry]);\n  };\n\n  const updateBatchLecture = (id: string, updates: Partial<BatchLecture>) => {\n    setBatchLectures(prev => prev.map(lecture => \n      lecture.id === id ? { ...lecture, ...updates } : lecture\n    ));\n  };\n\n  const removeBatchLecture = (id: string) => {\n    setBatchLectures(prev => prev.filter(lecture => lecture.id !== id));\n  };\n\n  const processBatchFiles = useCallback(async (files: FileList) => {\n    const newLectures: BatchLecture[] = [];\n    \n    for (let i = 0; i < files.length; i++) {\n      const file = files[i];\n      const isSupported = \n        file.type === \"text/plain\" || \n        file.type === \"application/pdf\" || \n        file.type === \"text/html\" ||\n        file.name.endsWith(\".txt\") ||\n        file.name.endsWith(\".pdf\") ||\n        file.name.endsWith(\".html\") ||\n        file.name.endsWith(\".htm\");\n\n      if (!isSupported) continue;\n\n      const lectureEntry: BatchLecture = {\n        id: `file-${Date.now()}-${i}-${Math.random().toString(36).substr(2, 9)}`,\n        title: \"\",\n        content: \"\",\n        filename: file.name,\n        status: \"processing\"\n      };\n      newLectures.push(lectureEntry);\n    }\n\n    setBatchLectures(prev => [...prev, ...newLectures]);\n\n    // Process each file\n    for (let i = 0; i < files.length; i++) {\n      const file = files[i];\n      const lectureId = newLectures[i]?.id;\n      if (!lectureId) continue;\n\n      try {\n        if (file.type === \"text/plain\" || file.name.endsWith(\".txt\")) {\n          const text = await new Promise<string>((resolve, reject) => {\n            const reader = new FileReader();\n            reader.onload = (e) => resolve(e.target?.result as string);\n            reader.onerror = () => reject(new Error(\"Failed to read file\"));\n            reader.readAsText(file);\n          });\n          \n          const extractedTitle = extractTitleFromContent(text);\n          updateBatchLecture(lectureId, { \n            content: text, \n            title: extractedTitle,\n            status: \"pending\"\n          });\n        } else {\n          const base64 = await new Promise<string>((resolve, reject) => {\n            const reader = new FileReader();\n            reader.onload = (e) => {\n              const result = e.target?.result as string;\n              resolve(result.split(\",\")[1]);\n            };\n            reader.onerror = () => reject(new Error(\"Failed to read file\"));\n            reader.readAsDataURL(file);\n          });\n\n          const response = await apiRequest(\"POST\", \"/api/parse-file\", {\n            fileData: base64,\n            fileType: file.type,\n            fileName: file.name\n          });\n          \n          const result = await response.json();\n          \n          if (result.error) {\n            updateBatchLecture(lectureId, { \n              status: \"error\",\n              error: result.error\n            });\n          } else {\n            const extractedTitle = result.title || extractTitleFromContent(result.text);\n            updateBatchLecture(lectureId, { \n              content: result.text, \n              title: extractedTitle,\n              status: \"pending\"\n            });\n          }\n        }\n      } catch (err: any) {\n        updateBatchLecture(lectureId, { \n          status: \"error\",\n          error: err.message || \"Failed to process file\"\n        });\n      }\n    }\n  }, []);\n\n  const handleBatchFileInput = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files && e.target.files.length > 0) {\n      processBatchFiles(e.target.files);\n    }\n    if (batchFileInputRef.current) {\n      batchFileInputRef.current.value = \"\";\n    }\n  }, [processBatchFiles]);\n\n  const handleBatchDrop = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setDragActive(false);\n\n    if (e.dataTransfer.files && e.dataTransfer.files.length > 0) {\n      processBatchFiles(e.dataTransfer.files);\n    }\n  }, [processBatchFiles]);\n\n  const submitBatchUpload = async () => {\n    const validLectures = batchLectures.filter(\n      l => l.status === \"pending\" && l.content.trim().length >= 50 && l.title.trim().length > 0\n    );\n\n    if (validLectures.length === 0) {\n      setBatchError(\"No valid lectures to upload. Each lecture needs a title and at least 50 characters of content.\");\n      return;\n    }\n\n    setIsBatchUploading(true);\n    setBatchError(null);\n    setBatchProgress(0);\n\n    try {\n      const response = await apiRequest(\"POST\", \"/api/lectures/batch\", {\n        lectures: validLectures.map(l => ({\n          title: l.title.trim(),\n          content: l.content.trim(),\n          filename: l.filename\n        }))\n      });\n\n      const result: BatchResult = await response.json();\n      setBatchResult(result);\n      setBatchProgress(100);\n\n      // Update individual lecture statuses\n      result.results.forEach((r, idx) => {\n        const lecture = validLectures[idx];\n        if (lecture) {\n          updateBatchLecture(lecture.id, {\n            status: r.status,\n            error: r.error\n          });\n        }\n      });\n\n    } catch (err: any) {\n      console.error(\"Batch upload error:\", err);\n      setBatchError(err.message || \"Failed to upload lectures. Please try again.\");\n    } finally {\n      setIsBatchUploading(false);\n    }\n  };\n\n  const resetBatchUpload = () => {\n    setBatchLectures([]);\n    setBatchResult(null);\n    setBatchError(null);\n    setBatchProgress(0);\n  };\n\n  const validBatchCount = batchLectures.filter(\n    l => l.status === \"pending\" && l.content.trim().length >= 50 && l.title.trim().length > 0\n  ).length;\n\n  return (\n    <div className=\"min-h-screen\">\n      <div className=\"max-w-2xl mx-auto px-6 py-16 animate-fade-in\">\n        <Button\n          variant=\"ghost\"\n          onClick={onBack}\n          className=\"mb-10 -ml-2\"\n          data-testid=\"button-back\"\n          aria-label=\"Go back to dashboard\"\n        >\n          <ArrowLeft className=\"h-4 w-4 mr-2\" aria-hidden=\"true\" />\n          Back\n        </Button>\n\n        <div className=\"space-y-3 mb-10\">\n          <h1 className=\"font-serif text-display-sm tracking-tight\">Upload Lectures</h1>\n          <p className=\"text-lg text-muted-foreground leading-relaxed\">\n            Add your study materials to your library. Upload a single lecture or multiple at once.\n          </p>\n        </div>\n\n        <Tabs defaultValue=\"single\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-2 mb-8\">\n            <TabsTrigger value=\"single\" data-testid=\"tab-single-upload\">\n              <FileText className=\"h-4 w-4 mr-2\" />\n              Single Upload\n            </TabsTrigger>\n            <TabsTrigger value=\"batch\" data-testid=\"tab-batch-upload\">\n              <Files className=\"h-4 w-4 mr-2\" />\n              Batch Upload\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"single\">\n            <div className=\"space-y-8\">\n              <div\n                className={`relative rounded-xl border-2 border-dashed transition-all duration-200 ${\n                  dragActive\n                    ? \"border-primary bg-primary/5\"\n                    : fileName && content\n                      ? \"border-primary/50 bg-primary/5\"\n                      : \"border-border hover:border-muted-foreground/50 hover:bg-muted/30\"\n                }`}\n                onDragEnter={handleDrag}\n                onDragLeave={handleDrag}\n                onDragOver={handleDrag}\n                onDrop={handleDrop}\n                role=\"button\"\n                tabIndex={0}\n                aria-label=\"Drop zone for file upload\"\n                onKeyDown={(e) => {\n                  if (e.key === \"Enter\" || e.key === \" \") {\n                    fileInputRef.current?.click();\n                  }\n                }}\n              >\n                <input\n                  ref={fileInputRef}\n                  type=\"file\"\n                  accept=\".txt,.pdf,.html,.htm,text/plain,application/pdf,text/html\"\n                  onChange={handleFileInput}\n                  className=\"absolute inset-0 w-full h-full opacity-0 cursor-pointer\"\n                  aria-label=\"File input\"\n                  data-testid=\"input-file\"\n                />\n                \n                <div className=\"flex flex-col items-center justify-center py-14 px-6\">\n                  {isParsing ? (\n                    <>\n                      <Loader2 className=\"h-10 w-10 text-primary animate-spin mb-4\" aria-hidden=\"true\" />\n                      <p className=\"font-medium text-lg\">Processing {fileName}...</p>\n                      <p className=\"text-muted-foreground mt-1\">Extracting text content</p>\n                    </>\n                  ) : fileName && content ? (\n                    <>\n                      <div className=\"h-12 w-12 rounded-full bg-primary/10 flex items-center justify-center mb-4\">\n                        <Check className=\"h-6 w-6 text-primary\" aria-hidden=\"true\" />\n                      </div>\n                      <div className=\"flex items-center gap-2 mb-2\">\n                        <span className=\"font-medium text-lg\">{fileName}</span>\n                        <Badge variant=\"secondary\" className=\"text-xs\">{getFileTypeLabel()}</Badge>\n                      </div>\n                      <p className=\"text-muted-foreground\">\n                        {content.length.toLocaleString()} characters extracted\n                      </p>\n                      <button\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          clearFile();\n                        }}\n                        className=\"text-sm text-muted-foreground hover:text-foreground mt-4 underline-offset-4 hover:underline transition-colors\"\n                        data-testid=\"button-clear-file\"\n                      >\n                        Choose different file\n                      </button>\n                    </>\n                  ) : (\n                    <>\n                      <div className=\"h-12 w-12 rounded-full bg-muted flex items-center justify-center mb-4\">\n                        <Upload className=\"h-6 w-6 text-muted-foreground\" aria-hidden=\"true\" />\n                      </div>\n                      <p className=\"font-medium text-lg\">Drop your file here</p>\n                      <p className=\"text-muted-foreground mt-1\">or click to browse</p>\n                      <div className=\"flex gap-2 mt-5\">\n                        <Badge variant=\"outline\" className=\"font-normal\">PDF</Badge>\n                        <Badge variant=\"outline\" className=\"font-normal\">HTML</Badge>\n                        <Badge variant=\"outline\" className=\"font-normal\">TXT</Badge>\n                      </div>\n                    </>\n                  )}\n                </div>\n              </div>\n\n              {parseError && (\n                <div className=\"p-5 rounded-xl bg-destructive/10 border border-destructive/20\">\n                  <div className=\"flex items-start gap-4\">\n                    <AlertCircle className=\"h-5 w-5 text-destructive flex-shrink-0 mt-0.5\" aria-hidden=\"true\" />\n                    <div>\n                      <p className=\"font-medium\">Processing failed</p>\n                      <p className=\"text-sm text-muted-foreground mt-1\">{parseError}</p>\n                      <p className=\"text-sm text-muted-foreground mt-2\">\n                        You can paste the content manually below.\n                      </p>\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              <div className=\"space-y-5\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"lecture-title\" className=\"text-sm font-medium\">Title</Label>\n                  <Input\n                    id=\"lecture-title\"\n                    placeholder=\"e.g., Introduction to Data Structures\"\n                    value={title}\n                    onChange={(e) => setTitle(e.target.value)}\n                    className=\"rounded-xl h-12\"\n                    data-testid=\"input-title\"\n                  />\n                  <p className=\"text-xs text-muted-foreground\">\n                    Auto-extracted from your content. You can edit it.\n                  </p>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <div className=\"flex items-center justify-between\">\n                    <Label htmlFor=\"lecture-content\" className=\"text-sm font-medium\">Content</Label>\n                    <span className=\"text-xs text-muted-foreground\">\n                      {content.length.toLocaleString()} / 50 min\n                    </span>\n                  </div>\n                  <Textarea\n                    id=\"lecture-content\"\n                    placeholder=\"Paste or type your lecture notes here...\"\n                    value={content}\n                    onChange={handleContentChange}\n                    className=\"min-h-[180px] resize-y rounded-xl\"\n                    data-testid=\"input-content\"\n                  />\n                </div>\n              </div>\n\n              {error && (\n                <div className=\"p-5 rounded-xl bg-destructive/10 border border-destructive/20\">\n                  <div className=\"flex items-start gap-4\">\n                    <AlertCircle className=\"h-5 w-5 text-destructive flex-shrink-0 mt-0.5\" aria-hidden=\"true\" />\n                    <div>\n                      <p className=\"font-medium\">Error</p>\n                      <p className=\"text-sm text-muted-foreground mt-1\">{error}</p>\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              <Button\n                onClick={handleSubmit}\n                disabled={!canSubmit || isSaving || isParsing}\n                className=\"w-full rounded-xl\"\n                size=\"lg\"\n                data-testid=\"button-save-lecture\"\n              >\n                {isSaving ? (\n                  <>\n                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" aria-hidden=\"true\" />\n                    Saving...\n                  </>\n                ) : (\n                  <>\n                    <BookOpen className=\"mr-2 h-4 w-4\" aria-hidden=\"true\" />\n                    Save to Library\n                  </>\n                )}\n              </Button>\n\n              <p className=\"text-center text-muted-foreground text-sm\">\n                After saving, you can review this lecture anytime from your dashboard.\n              </p>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"batch\">\n            <div className=\"space-y-6\">\n              {batchResult ? (\n                <div className=\"space-y-6\">\n                  <div className=\"p-6 rounded-xl bg-primary/5 border border-primary/20\">\n                    <div className=\"flex items-center gap-3 mb-4\">\n                      <div className=\"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center\">\n                        <Check className=\"h-5 w-5 text-primary\" />\n                      </div>\n                      <div>\n                        <p className=\"font-medium text-lg\">Batch Upload Complete</p>\n                        <p className=\"text-sm text-muted-foreground\">\n                          {batchResult.successCount} of {batchResult.total} lectures uploaded successfully\n                        </p>\n                      </div>\n                    </div>\n                    \n                    <div className=\"space-y-2\">\n                      {batchResult.results.map((result, idx) => (\n                        <div \n                          key={idx}\n                          className={`flex items-center justify-between p-3 rounded-lg ${\n                            result.status === \"completed\" \n                              ? \"bg-primary/5\" \n                              : \"bg-destructive/5\"\n                          }`}\n                          data-testid={`batch-result-${idx}`}\n                        >\n                          <span className=\"font-medium truncate flex-1\">{result.title}</span>\n                          {result.status === \"completed\" ? (\n                            <Badge variant=\"secondary\" className=\"ml-2\">\n                              <Check className=\"h-3 w-3 mr-1\" />\n                              Saved\n                            </Badge>\n                          ) : (\n                            <Badge variant=\"destructive\" className=\"ml-2\">\n                              Failed\n                            </Badge>\n                          )}\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n\n                  <div className=\"flex gap-3\">\n                    <Button\n                      variant=\"outline\"\n                      onClick={resetBatchUpload}\n                      className=\"flex-1 rounded-xl\"\n                      data-testid=\"button-upload-more\"\n                    >\n                      Upload More Lectures\n                    </Button>\n                    <Button\n                      onClick={onBack}\n                      className=\"flex-1 rounded-xl\"\n                      data-testid=\"button-go-to-library\"\n                    >\n                      Go to Library\n                    </Button>\n                  </div>\n                </div>\n              ) : (\n                <>\n                  <div\n                    className={`relative rounded-xl border-2 border-dashed transition-all duration-200 ${\n                      dragActive\n                        ? \"border-primary bg-primary/5\"\n                        : \"border-border hover:border-muted-foreground/50 hover:bg-muted/30\"\n                    }`}\n                    onDragEnter={handleDrag}\n                    onDragLeave={handleDrag}\n                    onDragOver={handleDrag}\n                    onDrop={handleBatchDrop}\n                  >\n                    <input\n                      ref={batchFileInputRef}\n                      type=\"file\"\n                      accept=\".txt,.pdf,.html,.htm,text/plain,application/pdf,text/html\"\n                      onChange={handleBatchFileInput}\n                      className=\"absolute inset-0 w-full h-full opacity-0 cursor-pointer\"\n                      multiple\n                      data-testid=\"input-batch-files\"\n                    />\n                    \n                    <div className=\"flex flex-col items-center justify-center py-10 px-6\">\n                      <div className=\"h-12 w-12 rounded-full bg-muted flex items-center justify-center mb-4\">\n                        <Files className=\"h-6 w-6 text-muted-foreground\" aria-hidden=\"true\" />\n                      </div>\n                      <p className=\"font-medium text-lg\">Drop multiple files here</p>\n                      <p className=\"text-muted-foreground mt-1\">or click to select files</p>\n                      <div className=\"flex gap-2 mt-4\">\n                        <Badge variant=\"outline\" className=\"font-normal\">PDF</Badge>\n                        <Badge variant=\"outline\" className=\"font-normal\">HTML</Badge>\n                        <Badge variant=\"outline\" className=\"font-normal\">TXT</Badge>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"flex-1 h-px bg-border\" />\n                    <span className=\"text-sm text-muted-foreground\">or add manually</span>\n                    <div className=\"flex-1 h-px bg-border\" />\n                  </div>\n\n                  <Button\n                    variant=\"outline\"\n                    onClick={addManualEntry}\n                    className=\"w-full rounded-xl\"\n                    data-testid=\"button-add-manual-entry\"\n                  >\n                    <Plus className=\"h-4 w-4 mr-2\" />\n                    Add Lecture Entry\n                  </Button>\n\n                  {batchLectures.length > 0 && (\n                    <div className=\"space-y-4\">\n                      <div className=\"flex items-center justify-between\">\n                        <h3 className=\"font-medium\">Lectures to Upload ({batchLectures.length})</h3>\n                        {validBatchCount > 0 && (\n                          <Badge variant=\"secondary\">{validBatchCount} ready</Badge>\n                        )}\n                      </div>\n\n                      <div className=\"space-y-3\">\n                        {batchLectures.map((lecture, idx) => (\n                          <Card key={lecture.id} className=\"p-4\" data-testid={`batch-lecture-${idx}`}>\n                            <div className=\"flex items-start gap-3\">\n                              <div className=\"flex-1 space-y-3\">\n                                <div className=\"flex items-center gap-2\">\n                                  {lecture.filename && (\n                                    <Badge variant=\"outline\" className=\"text-xs\">\n                                      <FileText className=\"h-3 w-3 mr-1\" />\n                                      {lecture.filename}\n                                    </Badge>\n                                  )}\n                                  {lecture.status === \"processing\" && (\n                                    <Badge variant=\"secondary\">\n                                      <Loader2 className=\"h-3 w-3 mr-1 animate-spin\" />\n                                      Processing\n                                    </Badge>\n                                  )}\n                                  {lecture.status === \"error\" && (\n                                    <Badge variant=\"destructive\">Error</Badge>\n                                  )}\n                                  {lecture.status === \"completed\" && (\n                                    <Badge variant=\"secondary\">\n                                      <Check className=\"h-3 w-3 mr-1\" />\n                                      Uploaded\n                                    </Badge>\n                                  )}\n                                </div>\n\n                                {lecture.status !== \"completed\" && (\n                                  <>\n                                    <Input\n                                      placeholder=\"Lecture title\"\n                                      value={lecture.title}\n                                      onChange={(e) => updateBatchLecture(lecture.id, { title: e.target.value })}\n                                      className=\"rounded-lg\"\n                                      disabled={lecture.status === \"processing\"}\n                                      data-testid={`batch-title-${idx}`}\n                                    />\n                                    \n                                    <Textarea\n                                      placeholder=\"Lecture content (min 50 characters)\"\n                                      value={lecture.content}\n                                      onChange={(e) => {\n                                        const newContent = e.target.value;\n                                        const updates: Partial<BatchLecture> = { content: newContent };\n                                        if (!lecture.title) {\n                                          updates.title = extractTitleFromContent(newContent);\n                                        }\n                                        updateBatchLecture(lecture.id, updates);\n                                      }}\n                                      className=\"min-h-[100px] resize-y rounded-lg\"\n                                      disabled={lecture.status === \"processing\"}\n                                      data-testid={`batch-content-${idx}`}\n                                    />\n\n                                    <div className=\"flex items-center justify-between text-xs text-muted-foreground\">\n                                      <span>{lecture.content.length.toLocaleString()} characters</span>\n                                      {lecture.content.length < 50 && (\n                                        <span className=\"text-amber-500\">Need at least 50 characters</span>\n                                      )}\n                                    </div>\n                                  </>\n                                )}\n\n                                {lecture.error && (\n                                  <p className=\"text-sm text-destructive\">{lecture.error}</p>\n                                )}\n                              </div>\n\n                              {lecture.status !== \"completed\" && (\n                                <Button\n                                  variant=\"ghost\"\n                                  size=\"icon\"\n                                  onClick={() => removeBatchLecture(lecture.id)}\n                                  className=\"text-muted-foreground hover:text-destructive\"\n                                  data-testid={`button-remove-${idx}`}\n                                >\n                                  <Trash2 className=\"h-4 w-4\" />\n                                </Button>\n                              )}\n                            </div>\n                          </Card>\n                        ))}\n                      </div>\n                    </div>\n                  )}\n\n                  {batchError && (\n                    <div className=\"p-5 rounded-xl bg-destructive/10 border border-destructive/20\">\n                      <div className=\"flex items-start gap-4\">\n                        <AlertCircle className=\"h-5 w-5 text-destructive flex-shrink-0 mt-0.5\" />\n                        <div>\n                          <p className=\"font-medium\">Upload Error</p>\n                          <p className=\"text-sm text-muted-foreground mt-1\">{batchError}</p>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n\n                  {isBatchUploading && (\n                    <div className=\"space-y-2\">\n                      <div className=\"flex items-center justify-between text-sm\">\n                        <span>Uploading lectures...</span>\n                        <span>{batchProgress}%</span>\n                      </div>\n                      <Progress value={batchProgress} className=\"h-2\" />\n                    </div>\n                  )}\n\n                  {batchLectures.length > 0 && (\n                    <Button\n                      onClick={submitBatchUpload}\n                      disabled={validBatchCount === 0 || isBatchUploading}\n                      className=\"w-full rounded-xl\"\n                      size=\"lg\"\n                      data-testid=\"button-batch-upload\"\n                    >\n                      {isBatchUploading ? (\n                        <>\n                          <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                          Uploading {validBatchCount} Lectures...\n                        </>\n                      ) : (\n                        <>\n                          <Upload className=\"mr-2 h-4 w-4\" />\n                          Upload {validBatchCount} Lecture{validBatchCount !== 1 ? \"s\" : \"\"}\n                        </>\n                      )}\n                    </Button>\n                  )}\n\n                  <p className=\"text-center text-muted-foreground text-sm\">\n                    Upload up to 20 lectures at once. Each lecture needs a title and at least 50 characters of content.\n                  </p>\n                </>\n              )}\n            </div>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":36094,"size_tokens":null},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","path":null,"size_bytes":7609,"size_tokens":null},"replit.md":{"content":"# LectureQuest - Gamified Learning Platform\n\n## Overview\n\nLectureQuest is a single-page React application that transforms passive lecture attendance into active learning through gamification. Students upload lecture materials (text/PDF), take AI-generated quizzes, and track their progress through an XP-based leveling system with achievements and daily challenges.\n\nThe application uses an AI-powered quiz generation system (Claude API) to create personalized learning experiences based on lecture content and identified weak areas.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n\n**Framework**: React 18 with TypeScript using functional components and hooks (useState, useEffect)\n\n**UI Framework**: Shadcn/ui component library built on Radix UI primitives with Tailwind CSS for styling\n\n**Styling Approach**: \n- \"Quiet luxury\" aesthetic inspired by wisprflow.ai with editorial elegance\n- Color palette: Warm cream background (#FFFDF9), deep forest green primary (#034F46), soft lavender accents (#F0D7FF)\n- Typography: EB Garamond (serif) for headings, Figtree (sans-serif) for body text\n- Clean, minimal design with generous whitespace (max-w-5xl containers, py-16 spacing)\n- Elegant cards with subtle shadows and refined borders\n- Gold accents for XP/achievements, success color for high accuracy\n- Lucide icons for all iconography (no emojis)\n- Full design system defined in `design_guidelines.md` and `client/src/index.css`\n\n**State Management**: Local React state with no global state library. Application state managed in `client/src/pages/home.tsx` includes:\n- User profile (level, XP, achievements, power-ups, streaks)\n- Lecture history\n- Current quiz state\n- View navigation (dashboard, upload, quiz, results, achievements)\n\n**Dashboard Design**: Clean, tab-based interface in `client/src/components/dashboard.tsx`:\n- Compact header with stats bar (Level, XP, Streak, Progress)\n- Three-tab navigation for focused content:\n  - **Today** tab: Daily quiz, reviews due, calendar events, study materials\n  - **Skills** tab: Skills profile with career insights and export\n  - **Progress** tab: Stats grid, achievements, power-ups\n- Demo mode for showcasing features with sample data\n\n**Routing**: Wouter for lightweight client-side routing\n\n**Data Fetching**: TanStack Query (React Query) with custom API request utilities in `client/src/lib/queryClient.ts`\n\n**Type Safety**: Comprehensive TypeScript interfaces defined in `shared/schema.ts` for:\n- Questions and quiz results\n- User profiles and achievements\n- Lectures and daily quizzes\n- Gamification elements (XP, levels, power-ups)\n\n### Backend Architecture\n\n**Server Framework**: Express.js with TypeScript\n\n**API Structure**: RESTful endpoints defined in `server/routes.ts`:\n- `POST /api/generate-quiz` - Generates quiz from lecture content\n- `POST /api/generate-daily-quiz` - Creates personalized daily quizzes based on weak topics\n- `POST /api/calendar` - Connects and syncs ICS calendar feed\n- `GET /api/calendar/events` - Retrieves cached calendar events\n- `DELETE /api/calendar` - Disconnects calendar\n\n### Calendar Integration\n\n**ICS Feed Parsing**: Uses node-ical to parse ICS calendar feeds from academic calendars\n\n**Security Features** (SSRF Protection):\n- HTTPS-only URL requirement\n- DNS resolution validation before connection\n- Private IP range blocking (IPv4 and IPv6 loopback, private, link-local, CGNAT, multicast, reserved)\n- Custom DNS lookup function to prevent DNS rebinding attacks\n- Redirect validation with per-hop DNS verification (max 5 redirects)\n- Blocks suspicious domains (.nip.io, .sslip.io, .xip.io, .localtest.me, .local, .internal)\n- Direct IP addresses not allowed (must use domain names)\n\n**Event Classification**: Automatically classifies events as lectures, labs, tutorials, exams, or other based on title keywords\n\n**Dashboard Integration**:\n- Upcoming Lectures: Shows next 7 days of scheduled events\n- Missing Lectures: Identifies attended lectures without uploaded materials (14-day lookback)\n\n**Request Validation**: Zod schemas for type-safe request validation\n\n**Development Setup**: \n- Vite dev server with HMR (Hot Module Replacement)\n- Custom middleware in `server/vite.ts` for development mode\n- Static file serving for production builds\n\n**Build Process**: Custom build script (`script/build.ts`) that:\n- Bundles client with Vite\n- Bundles server with esbuild\n- Optimizes dependencies for cold start performance\n\n### Data Storage\n\n**Current Implementation**: PostgreSQL database with Neon serverless driver and Drizzle ORM\n\n**Database Tables**:\n- `users` - User profiles with level, XP, achievements, streaks\n- `lectures` - Uploaded lecture content with quiz results and skills\n- `topic_review_stats` - SM-2 spaced repetition tracking per topic\n- `review_events` - Audit log of all review activities\n- `daily_quiz_plans` - Generated daily quiz plans with completion status\n- `calendar_settings` - ICS calendar URL and sync status\n- `calendar_events` - Cached calendar events\n\n**WebSocket Configuration**: Uses `ws` package for Neon serverless connection in Node.js environment\n\n**Schema Definition**: Drizzle ORM configuration in `drizzle.config.ts`\n- Schema defined in `shared/schema.ts`\n- Migration: `npm run db:push` for schema sync\n- Database connection via `DATABASE_URL` environment variable\n\n### Gamification System\n\n**Level Calculation**: Square root formula - Level = floor(sqrt(totalXP / 100))\n\n**XP Distribution**:\n- Base XP per quiz: 50\n- Per correct answer: 10\n- Perfect score bonus: 50\n- Confidence rating bonus: 5 per rating point\n- Improvement bonus: 20\n- Streak bonus: 5 per day streak\n- Double XP power-up: 2x multiplier\n\n**Achievements System**: Tracked in `client/src/lib/game-utils.ts` with conditions for:\n- Perfect scores\n- Streak milestones\n- Level achievements\n- Quiz completion counts\n- Improvement metrics\n\n**Power-ups**:\n- Hints (eliminate wrong answers)\n- Second Chance (retry incorrect answer)\n- Double XP\n\n### AI Integration\n\n**Provider**: Anthropic Claude API (claude-sonnet-4-20250514 model)\n\n**Implementation**: Direct API calls in `server/routes.ts` using `@anthropic-ai/sdk`\n\n**Quiz Generation Strategy**:\n- Analyzes lecture content to extract key concepts\n- Generates 5-7 multiple choice questions\n- Provides explanations for each answer\n- Identifies topics for weak areas based on incorrect answers\n- **Skills Recognition**: Identifies 3-5 transferable skills per lecture with:\n  - Name, description, and category (cognitive/technical/interpersonal)\n  - Relevant career paths (2-3 per skill)\n  - Proficiency level calculated from quiz accuracy\n\n**Skills Proficiency Calculation**:\n- Proficient: Quiz accuracy >= 85%\n- Intermediate: Quiz accuracy 60-84%\n- Developing: Quiz accuracy < 60%\n\n**Daily Quiz Generation**:\n- Uses previous weak topics\n- Considers confidence level\n- Adapts difficulty based on previous scores\n\n**Response Processing**: JSON parsing with cleanup utility to remove markdown code fences\n\n### Skills Profile & Career Mapping\n\n**Aggregation**: GET /api/skills endpoint aggregates all identified skills across lectures\n- Skills sorted by proficiency level (proficient > intermediate > developing)\n- Dashboard displays skills with career badges\n- CSV export functionality for sharing with employers/advisors\n\n**Dashboard Integration**:\n- Skills Profile section shows aggregated skills\n- Each skill displays 2-3 relevant career paths\n- Proficiency breakdown (proficient/intermediate/developing counts)\n- Export button generates CSV with full skill data\n\n## External Dependencies\n\n### Third-Party Services\n\n**AI Service**: \n- Anthropic Claude API\n- API key configured via `ANTHROPIC_API_KEY` environment variable\n- Used for quiz generation and content analysis\n\n**Database** (Configured but not active):\n- Neon PostgreSQL (via `@neondatabase/serverless`)\n- Connection pooling for serverless environments\n- Drizzle ORM for schema management and queries\n\n### Key NPM Packages\n\n**UI Components**:\n- Radix UI primitives (accordion, dialog, dropdown, progress, toast, etc.)\n- Tailwind CSS for utility-first styling\n- class-variance-authority and clsx for conditional styling\n\n**Development Tools**:\n- Vite for fast development and optimized production builds\n- TypeScript for type safety\n- tsx for running TypeScript files directly\n- esbuild for server bundling\n\n**Form Handling**:\n- React Hook Form with Zod resolvers for validation\n\n**Date Utilities**:\n- date-fns for date formatting and manipulation\n\n### Build and Deployment\n\n**Development**: `npm run dev` - Runs tsx server with Vite middleware for HMR\n\n**Production Build**: `npm run build` - Creates optimized client bundle and server bundle\n\n**Production Start**: `npm start` - Runs compiled server with static file serving\n\n**Database Management**: `npm run db:push` - Pushes Drizzle schema changes to database\n\n### Environment Variables Required\n\n- `ANTHROPIC_API_KEY` - Claude API authentication\n- `DATABASE_URL` - PostgreSQL connection string (when database is activated)\n- `NODE_ENV` - Environment mode (development/production)","path":null,"size_bytes":9132,"size_tokens":null},"client/src/components/header.tsx":{"content":"import { Flame, Moon, Sun, Zap } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Tooltip, TooltipContent, TooltipTrigger } from \"@/components/ui/tooltip\";\nimport { useTheme } from \"@/components/theme-provider\";\nimport type { UserProfile } from \"@shared/schema\";\nimport { getLevelTitle, xpForNextLevel } from \"@/lib/game-utils\";\n\ninterface HeaderProps {\n  userProfile: UserProfile;\n  onNavigate: (view: \"dashboard\" | \"upload\" | \"achievements\") => void;\n  currentView: string;\n}\n\nexport function Header({ userProfile, onNavigate, currentView }: HeaderProps) {\n  const { theme, toggleTheme } = useTheme();\n\n  const currentLevelXP = Math.pow(userProfile.level, 2) * 100;\n  const nextLevelXP = xpForNextLevel(userProfile.level);\n  const xpInLevel = userProfile.totalXP - currentLevelXP;\n  const xpNeeded = nextLevelXP - currentLevelXP;\n  const progressPercent = Math.min(100, (xpInLevel / xpNeeded) * 100);\n\n  return (\n    <header \n      className=\"sticky top-0 z-50 w-full border-b border-border/40 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/80\"\n      role=\"banner\"\n    >\n      <div className=\"max-w-5xl mx-auto flex h-16 items-center justify-between gap-6 px-6\">\n        <button\n          onClick={() => onNavigate(\"dashboard\")}\n          className=\"focus:outline-none focus-visible:ring-2 focus-visible:ring-ring rounded-md\"\n          data-testid=\"link-home\"\n          aria-label=\"Go to dashboard\"\n        >\n          <span className=\"font-serif text-xl tracking-tight\">\n            LectureQuest\n          </span>\n        </button>\n\n        <div className=\"flex items-center gap-5\">\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <div className=\"flex items-center gap-4 cursor-default\">\n                <div className=\"flex items-center gap-1.5 text-sm\">\n                  <span className=\"font-medium\">Level {userProfile.level}</span>\n                </div>\n                \n                <div className=\"hidden sm:flex items-center gap-4\">\n                  <div className=\"flex items-center gap-1.5\">\n                    <Zap className=\"h-4 w-4 text-gold\" aria-hidden=\"true\" />\n                    <span className=\"text-sm font-medium tabular-nums text-gold\">\n                      {userProfile.totalXP.toLocaleString()}\n                    </span>\n                  </div>\n                  \n                  {userProfile.currentStreak > 0 && (\n                    <div className=\"flex items-center gap-1.5\">\n                      <Flame className=\"h-4 w-4 text-gold\" aria-hidden=\"true\" />\n                      <span className=\"text-sm font-medium tabular-nums\">{userProfile.currentStreak}</span>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </TooltipTrigger>\n            <TooltipContent side=\"bottom\" className=\"max-w-xs\">\n              <div className=\"space-y-2 py-1\">\n                <p className=\"font-serif font-medium text-base\">\n                  {getLevelTitle(userProfile.level)}\n                </p>\n                <p className=\"text-sm text-muted-foreground\">\n                  {userProfile.totalXP.toLocaleString()} XP total\n                </p>\n                <p className=\"text-sm text-muted-foreground\">\n                  {(nextLevelXP - userProfile.totalXP).toLocaleString()} XP to next level\n                </p>\n                {userProfile.currentStreak > 0 && (\n                  <p className=\"text-sm text-muted-foreground\">\n                    {userProfile.currentStreak} day streak (best: {userProfile.longestStreak})\n                  </p>\n                )}\n              </div>\n            </TooltipContent>\n          </Tooltip>\n\n          <div className=\"w-28 hidden md:block\">\n            <div className=\"h-1.5 rounded-full bg-muted overflow-hidden\">\n              <div \n                className=\"h-full bg-primary rounded-full progress-smooth\"\n                style={{ width: `${progressPercent}%` }}\n                role=\"progressbar\"\n                aria-valuenow={progressPercent}\n                aria-valuemin={0}\n                aria-valuemax={100}\n                aria-label={`XP progress: ${Math.round(progressPercent)}%`}\n              />\n            </div>\n          </div>\n\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={toggleTheme}\n            className=\"h-9 w-9\"\n            data-testid=\"button-theme-toggle\"\n            aria-label={`Switch to ${theme === \"dark\" ? \"light\" : \"dark\"} mode`}\n          >\n            {theme === \"dark\" ? (\n              <Sun className=\"h-[18px] w-[18px]\" aria-hidden=\"true\" />\n            ) : (\n              <Moon className=\"h-[18px] w-[18px]\" aria-hidden=\"true\" />\n            )}\n          </Button>\n        </div>\n      </div>\n    </header>\n  );\n}\n","path":null,"size_bytes":4819,"size_tokens":null},"server/static.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(__dirname, \"public\");\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","path":null,"size_bytes":547,"size_tokens":null},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":711,"size_tokens":null},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","path":null,"size_bytes":3848,"size_tokens":null},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { serveStatic } from \"./static\";\nimport { createServer } from \"http\";\n\nconst app = express();\nconst httpServer = createServer(app);\n\ndeclare module \"http\" {\n  interface IncomingMessage {\n    rawBody: unknown;\n  }\n}\n\napp.use(\n  express.json({\n    limit: '50mb',\n    verify: (req, _res, buf) => {\n      req.rawBody = buf;\n    },\n  }),\n);\n\napp.use(express.urlencoded({ extended: false, limit: '50mb' }));\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  await registerRoutes(httpServer, app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (process.env.NODE_ENV === \"production\") {\n    serveStatic(app);\n  } else {\n    const { setupVite } = await import(\"./vite\");\n    await setupVite(httpServer, app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || \"5000\", 10);\n  httpServer.listen(\n    {\n      port,\n      host: \"0.0.0.0\",\n      reusePort: true,\n    },\n    () => {\n      log(`serving on port ${port}`);\n    },\n  );\n})();\n","path":null,"size_bytes":2594,"size_tokens":null},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","path":null,"size_bytes":772,"size_tokens":null},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","path":null,"size_bytes":10481,"size_tokens":null},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","path":null,"size_bytes":8605,"size_tokens":null},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","path":null,"size_bytes":3895,"size_tokens":null},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","path":null,"size_bytes":1527,"size_tokens":null},"server/vite.ts":{"content":"import { type Express } from \"express\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport async function setupVite(server: Server, app: Express) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server, path: \"/vite-hmr\" },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n","path":null,"size_bytes":1534,"size_tokens":null},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","path":null,"size_bytes":5741,"size_tokens":null},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","path":null,"size_bytes":2751,"size_tokens":null},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","path":null,"size_bytes":1056,"size_tokens":null},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* LIGHT MODE - Wisprflow-inspired elegant warm cream theme */\n:root {\n  --button-outline: rgba(0,0,0, .08);\n  --badge-outline: rgba(0,0,0, .05);\n  --opaque-button-border-intensity: -8;\n  --elevate-1: rgba(0,0,0, .03);\n  --elevate-2: rgba(0,0,0, .06);\n  \n  /* Core palette - warm cream with forest green and lavender */\n  --background: 43 60% 98%;\n  --foreground: 0 0% 10%;\n  --border: 43 20% 88%;\n  \n  /* Cards - slightly warmer than background */\n  --card: 43 40% 97%;\n  --card-foreground: 0 0% 10%;\n  --card-border: 43 20% 90%;\n  \n  /* Sidebar */\n  --sidebar: 43 30% 96%;\n  --sidebar-foreground: 0 0% 10%;\n  --sidebar-border: 43 20% 88%;\n  --sidebar-primary: 171 93% 16%;\n  --sidebar-primary-foreground: 0 0% 98%;\n  --sidebar-accent: 282 60% 94%;\n  --sidebar-accent-foreground: 0 0% 10%;\n  --sidebar-ring: 171 93% 16%;\n  \n  /* Popover */\n  --popover: 43 50% 99%;\n  --popover-foreground: 0 0% 10%;\n  --popover-border: 43 20% 88%;\n  \n  /* Primary - deep forest green */\n  --primary: 171 93% 16%;\n  --primary-foreground: 0 0% 98%;\n  \n  /* Secondary - soft lavender accent */\n  --secondary: 282 60% 92%;\n  --secondary-foreground: 0 0% 10%;\n  \n  /* Muted */\n  --muted: 43 20% 92%;\n  --muted-foreground: 0 0% 40%;\n  \n  /* Accent - lavender highlight */\n  --accent: 282 60% 94%;\n  --accent-foreground: 0 0% 10%;\n  \n  /* Status colors */\n  --destructive: 0 72% 48%;\n  --destructive-foreground: 0 0% 98%;\n  --success: 160 60% 35%;\n  --success-foreground: 0 0% 100%;\n  --gold: 40 85% 55%;\n  --gold-foreground: 40 100% 15%;\n  \n  /* Input */\n  --input: 43 20% 88%;\n  --ring: 171 93% 16%;\n  \n  /* Charts */\n  --chart-1: 171 80% 25%;\n  --chart-2: 282 50% 70%;\n  --chart-3: 40 80% 55%;\n  --chart-4: 160 55% 40%;\n  --chart-5: 200 60% 50%;\n  \n  /* Typography */\n  --font-sans: 'Figtree', system-ui, sans-serif;\n  --font-serif: 'EB Garamond', Georgia, serif;\n  --font-mono: 'JetBrains Mono', monospace;\n  \n  /* Spacing and radius */\n  --radius: .75rem;\n  --spacing: 0.25rem;\n  \n  /* Shadows - subtle and warm */\n  --shadow-2xs: 0px 1px 2px 0px hsl(40 20% 20% / 0.02);\n  --shadow-xs: 0px 2px 4px 0px hsl(40 20% 20% / 0.03);\n  --shadow-sm: 0px 2px 8px 0px hsl(40 20% 20% / 0.04);\n  --shadow: 0px 4px 12px 0px hsl(40 20% 20% / 0.05);\n  --shadow-md: 0px 6px 16px 0px hsl(40 20% 20% / 0.06);\n  --shadow-lg: 0px 8px 24px 0px hsl(40 20% 20% / 0.08);\n  --shadow-xl: 0px 12px 32px 0px hsl(40 20% 20% / 0.10);\n  --shadow-2xl: 0px 16px 48px 0px hsl(40 20% 20% / 0.12);\n  --tracking-normal: 0em;\n\n  /* Border calculations */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n/* DARK MODE - Deep forest with warm accents */\n.dark {\n  --button-outline: rgba(255,255,255, .10);\n  --badge-outline: rgba(255,255,255, .06);\n  --opaque-button-border-intensity: 10;\n  --elevate-1: rgba(255,255,255, .04);\n  --elevate-2: rgba(255,255,255, .08);\n  \n  /* Dark background with warm undertones */\n  --background: 170 15% 8%;\n  --foreground: 40 20% 95%;\n  --border: 170 10% 18%;\n  \n  /* Cards */\n  --card: 170 12% 11%;\n  --card-foreground: 40 20% 95%;\n  --card-border: 170 10% 16%;\n  \n  /* Sidebar */\n  --sidebar: 170 12% 10%;\n  --sidebar-foreground: 40 20% 95%;\n  --sidebar-border: 170 10% 16%;\n  --sidebar-primary: 160 60% 45%;\n  --sidebar-primary-foreground: 0 0% 98%;\n  --sidebar-accent: 282 40% 25%;\n  --sidebar-accent-foreground: 40 20% 95%;\n  --sidebar-ring: 160 60% 45%;\n  \n  /* Popover */\n  --popover: 170 12% 12%;\n  --popover-foreground: 40 20% 95%;\n  --popover-border: 170 10% 18%;\n  \n  /* Primary - lighter forest green for dark mode */\n  --primary: 160 60% 45%;\n  --primary-foreground: 0 0% 98%;\n  \n  /* Secondary - muted lavender */\n  --secondary: 282 30% 35%;\n  --secondary-foreground: 40 20% 95%;\n  \n  /* Muted */\n  --muted: 170 10% 18%;\n  --muted-foreground: 40 15% 60%;\n  \n  /* Accent */\n  --accent: 282 25% 22%;\n  --accent-foreground: 40 20% 95%;\n  \n  /* Status colors */\n  --destructive: 0 65% 55%;\n  --destructive-foreground: 0 0% 98%;\n  --success: 160 55% 45%;\n  --success-foreground: 0 0% 100%;\n  --gold: 40 80% 55%;\n  --gold-foreground: 40 100% 10%;\n  \n  /* Input */\n  --input: 170 10% 20%;\n  --ring: 160 60% 45%;\n  \n  /* Charts */\n  --chart-1: 160 55% 50%;\n  --chart-2: 282 40% 55%;\n  --chart-3: 40 75% 55%;\n  --chart-4: 160 50% 50%;\n  --chart-5: 200 55% 55%;\n  \n  /* Shadows */\n  --shadow-2xs: 0px 1px 2px 0px hsl(0 0% 0% / 0.15);\n  --shadow-xs: 0px 2px 4px 0px hsl(0 0% 0% / 0.20);\n  --shadow-sm: 0px 2px 8px 0px hsl(0 0% 0% / 0.25);\n  --shadow: 0px 4px 12px 0px hsl(0 0% 0% / 0.30);\n  --shadow-md: 0px 6px 16px 0px hsl(0 0% 0% / 0.35);\n  --shadow-lg: 0px 8px 24px 0px hsl(0 0% 0% / 0.40);\n  --shadow-xl: 0px 12px 32px 0px hsl(0 0% 0% / 0.45);\n  --shadow-2xl: 0px 16px 48px 0px hsl(0 0% 0% / 0.50);\n\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n  \n  /* Elegant editorial headings */\n  h1, h2, h3 {\n    @apply font-serif tracking-tight;\n  }\n}\n\n/* Custom utilities */\n@layer utilities {\n  /* Hide search cancel button in Chrome */\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  /* Placeholder styling for contentEditable */\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  .no-default-hover-elevate {}\n  .no-default-active-elevate {}\n\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    border-radius: inherit;\n    z-index: -1;\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    border-radius: inherit;\n    z-index: 999;\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n\n  /* Elegant gradient text */\n  .gradient-text {\n    background: linear-gradient(135deg, hsl(var(--primary)), hsl(160, 50%, 30%));\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n  }\n\n  /* Lavender accent gradient */\n  .accent-gradient {\n    background: linear-gradient(135deg, hsl(var(--accent)), hsl(282, 70%, 88%));\n  }\n\n  /* Subtle shimmer animation */\n  .shimmer {\n    background: linear-gradient(90deg, \n      hsl(var(--card)) 0%, \n      hsl(var(--muted)) 50%, \n      hsl(var(--card)) 100%);\n    background-size: 200% 100%;\n    animation: shimmer 2s ease-in-out infinite;\n  }\n\n  @keyframes shimmer {\n    0% { background-position: 100% 50%; }\n    50% { background-position: 0% 50%; }\n    100% { background-position: 100% 50%; }\n  }\n\n  /* Gold accent for achievements/XP - uses CSS variable for dark mode */\n  .gold-glow {\n    box-shadow: 0 0 16px hsl(var(--gold) / 0.25);\n  }\n  \n  .dark .gold-glow {\n    box-shadow: 0 0 20px hsl(var(--gold) / 0.4);\n  }\n\n  @keyframes gold-pulse {\n    0%, 100% {\n      box-shadow: 0 0 8px hsl(var(--gold) / 0.3);\n    }\n    50% {\n      box-shadow: 0 0 16px hsl(var(--gold) / 0.5);\n    }\n  }\n\n  .gold-pulse {\n    animation: gold-pulse 2s ease-in-out infinite;\n  }\n\n  /* Floating animation */\n  @keyframes float-up {\n    0% {\n      opacity: 1;\n      transform: translateY(0) scale(1);\n    }\n    100% {\n      opacity: 0;\n      transform: translateY(-40px) scale(1.1);\n    }\n  }\n\n  .animate-float-up {\n    animation: float-up 1.2s ease-out forwards;\n  }\n\n  /* Subtle shake for errors */\n  @keyframes shake {\n    0%, 100% { transform: translateX(0); }\n    10%, 30%, 50%, 70%, 90% { transform: translateX(-3px); }\n    20%, 40%, 60%, 80% { transform: translateX(3px); }\n  }\n\n  .animate-shake {\n    animation: shake 0.4s ease-in-out;\n  }\n\n  /* Check bounce animation */\n  @keyframes check-bounce {\n    0% { transform: scale(0); }\n    50% { transform: scale(1.2); }\n    100% { transform: scale(1); }\n  }\n\n  .check-bounce {\n    animation: check-bounce 0.3s ease-out;\n  }\n\n  /* Elegant fade in */\n  @keyframes fade-in {\n    0% { opacity: 0; transform: translateY(8px); }\n    100% { opacity: 1; transform: translateY(0); }\n  }\n\n  .animate-fade-in {\n    animation: fade-in 0.4s ease-out;\n  }\n\n  /* Card hover effect - subtle lift */\n  .card-hover {\n    transition: transform 0.2s ease, box-shadow 0.2s ease;\n  }\n\n  .card-hover:hover {\n    transform: translateY(-2px);\n    box-shadow: var(--shadow-md);\n  }\n\n  /* Progress bar */\n  .progress-smooth {\n    transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);\n  }\n\n  /* Lavender button hover */\n  .btn-accent {\n    background: hsl(var(--accent));\n    border: 1px solid hsl(var(--foreground) / 0.1);\n    transition: all 0.2s ease;\n  }\n\n  .btn-accent:hover {\n    background: hsl(282, 65%, 90%);\n    border-color: hsl(var(--foreground) / 0.15);\n  }\n}\n","path":null,"size_bytes":12182,"size_tokens":null},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","path":null,"size_bytes":4885,"size_tokens":null},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","path":null,"size_bytes":5128,"size_tokens":null},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","path":null,"size_bytes":1753,"size_tokens":null},"client/src/components/level-up-overlay.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { Sparkles, Star, Gift } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { getLevelTitle } from \"@/lib/game-utils\";\n\ninterface LevelUpOverlayProps {\n  newLevel: number;\n  rewards?: string[];\n  onContinue: () => void;\n}\n\ninterface ConfettiPiece {\n  id: number;\n  left: number;\n  color: string;\n  delay: number;\n  size: number;\n}\n\nexport function LevelUpOverlay({ newLevel, rewards = [], onContinue }: LevelUpOverlayProps) {\n  const [confetti, setConfetti] = useState<ConfettiPiece[]>([]);\n  const [showContent, setShowContent] = useState(false);\n\n  useEffect(() => {\n    const pieces: ConfettiPiece[] = [];\n    const colors = [\n      \"bg-gold\",\n      \"bg-primary\",\n      \"bg-secondary\",\n      \"bg-success\",\n      \"bg-white\",\n      \"bg-primary/80\",\n    ];\n\n    for (let i = 0; i < 50; i++) {\n      pieces.push({\n        id: i,\n        left: Math.random() * 100,\n        color: colors[Math.floor(Math.random() * colors.length)],\n        delay: Math.random() * 2,\n        size: Math.random() * 8 + 4,\n      });\n    }\n    setConfetti(pieces);\n\n    const timer = setTimeout(() => setShowContent(true), 300);\n    return () => clearTimeout(timer);\n  }, []);\n\n  const levelTitle = getLevelTitle(newLevel);\n\n  return (\n    <div \n      className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm\"\n      role=\"dialog\"\n      aria-modal=\"true\"\n      aria-labelledby=\"level-up-title\"\n    >\n      {confetti.map((piece) => (\n        <div\n          key={piece.id}\n          className={`confetti ${piece.color} rounded-sm`}\n          style={{\n            left: `${piece.left}%`,\n            width: `${piece.size}px`,\n            height: `${piece.size}px`,\n            animationDelay: `${piece.delay}s`,\n          }}\n          aria-hidden=\"true\"\n        />\n      ))}\n\n      <div\n        className={`relative z-10 text-center max-w-md mx-4 transition-all duration-500 ${\n          showContent ? \"opacity-100 scale-100\" : \"opacity-0 scale-90\"\n        }`}\n      >\n        <div className=\"mb-6\">\n          <div className=\"relative inline-block\">\n            <div className=\"absolute inset-0 blur-2xl bg-gold/50 rounded-full animate-pulse\" />\n            <div className=\"relative flex h-24 w-24 items-center justify-center rounded-full bg-gradient-to-br from-gold to-primary text-4xl font-bold text-black shadow-2xl mx-auto\">\n              {newLevel}\n            </div>\n          </div>\n        </div>\n\n        <div className=\"space-y-2 mb-8\">\n          <p className=\"text-gold text-sm font-medium uppercase tracking-widest flex items-center justify-center gap-2\">\n            <Star className=\"h-4 w-4 animate-sparkle\" aria-hidden=\"true\" />\n            FANFARE\n            <Star className=\"h-4 w-4 animate-sparkle\" aria-hidden=\"true\" />\n          </p>\n          <h2 \n            id=\"level-up-title\"\n            className=\"text-5xl font-bold level-up-text\"\n          >\n            LEVEL UP!\n          </h2>\n          <p className=\"text-2xl font-semibold text-white mt-4\">\n            Level {newLevel}\n          </p>\n          <p className=\"text-lg text-gold\">\n            {levelTitle}\n          </p>\n        </div>\n\n        {rewards.length > 0 && (\n          <div className=\"mb-8 p-4 rounded-lg bg-white/10 border border-gold/30\">\n            <p className=\"text-sm font-medium text-gold flex items-center justify-center gap-2 mb-3\">\n              <Gift className=\"h-4 w-4\" aria-hidden=\"true\" />\n              Rewards Unlocked\n            </p>\n            <div className=\"space-y-2\">\n              {rewards.map((reward, i) => (\n                <div \n                  key={i}\n                  className=\"flex items-center justify-center gap-2 text-white\"\n                >\n                  <Sparkles className=\"h-4 w-4 text-gold\" aria-hidden=\"true\" />\n                  <span>{reward}</span>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n\n        <Button\n          onClick={onContinue}\n          size=\"lg\"\n          className=\"h-12 px-8 text-lg bg-gold hover:bg-gold/90 text-black font-semibold\"\n          data-testid=\"button-continue-level-up\"\n        >\n          <Sparkles className=\"mr-2 h-5 w-5\" aria-hidden=\"true\" />\n          Continue\n        </Button>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":4320,"size_tokens":null},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","path":null,"size_bytes":1139,"size_tokens":null},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","path":null,"size_bytes":1080,"size_tokens":null},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","path":null,"size_bytes":2695,"size_tokens":null},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","path":null,"size_bytes":4845,"size_tokens":null},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","path":null,"size_bytes":2765,"size_tokens":null},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","path":null,"size_bytes":4281,"size_tokens":null},"client/src/components/achievements-view.tsx":{"content":"import { ArrowLeft, Lock, Check, Trophy, Zap, Flame, BookOpen, Target, TrendingUp, Award } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Progress } from \"@/components/ui/progress\";\nimport type { Achievement } from \"@shared/schema\";\nimport { formatDate } from \"@/lib/game-utils\";\n\ninterface AchievementsViewProps {\n  achievements: Achievement[];\n  onBack: () => void;\n}\n\nexport function AchievementsView({ achievements, onBack }: AchievementsViewProps) {\n  const unlockedCount = achievements.filter((a) => a.unlocked).length;\n  const totalCount = achievements.length;\n  const progressPercent = (unlockedCount / totalCount) * 100;\n\n  const unlockedAchievements = achievements.filter((a) => a.unlocked);\n  const lockedAchievements = achievements.filter((a) => !a.unlocked);\n\n  return (\n    <div className=\"min-h-screen\">\n      <div className=\"max-w-2xl mx-auto px-6 py-16 animate-fade-in\">\n        <Button\n          variant=\"ghost\"\n          onClick={onBack}\n          className=\"mb-10 -ml-2\"\n          data-testid=\"button-back\"\n          aria-label=\"Go back to dashboard\"\n        >\n          <ArrowLeft className=\"h-4 w-4 mr-2\" aria-hidden=\"true\" />\n          Back\n        </Button>\n\n        <div className=\"space-y-4 mb-12\">\n          <h1 className=\"font-serif text-display-sm tracking-tight\">Achievements</h1>\n          <p className=\"text-lg text-muted-foreground\">\n            {unlockedCount} of {totalCount} unlocked\n          </p>\n          <div className=\"max-w-sm pt-2\">\n            <Progress value={progressPercent} className=\"h-2\" />\n          </div>\n        </div>\n\n        {unlockedAchievements.length > 0 && (\n          <section className=\"mb-12\">\n            <h2 className=\"text-sm font-medium text-muted-foreground mb-5 flex items-center gap-2 uppercase tracking-wide\">\n              <Check className=\"h-4 w-4\" aria-hidden=\"true\" />\n              Unlocked\n            </h2>\n            <div className=\"grid gap-4 sm:grid-cols-2\">\n              {unlockedAchievements.map((achievement) => (\n                <Card key={achievement.id} className=\"border-gold/30 bg-gold/5 card-hover\">\n                  <CardContent className=\"p-5\">\n                    <div className=\"flex items-start gap-4\">\n                      <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gold/10 flex-shrink-0\">\n                        {getAchievementIcon(achievement.icon)}\n                      </div>\n                      <div className=\"min-w-0 flex-1\">\n                        <h3 className=\"font-medium\">{achievement.name}</h3>\n                        <p className=\"text-sm text-muted-foreground mt-1\">\n                          {achievement.description}\n                        </p>\n                        {achievement.unlockedDate && (\n                          <p className=\"text-xs text-muted-foreground mt-2\">\n                            Unlocked {formatDate(achievement.unlockedDate)}\n                          </p>\n                        )}\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          </section>\n        )}\n\n        {lockedAchievements.length > 0 && (\n          <section>\n            <h2 className=\"text-sm font-medium text-muted-foreground mb-5 flex items-center gap-2 uppercase tracking-wide\">\n              <Lock className=\"h-4 w-4\" aria-hidden=\"true\" />\n              Locked\n            </h2>\n            <div className=\"grid gap-4 sm:grid-cols-2\">\n              {lockedAchievements.map((achievement) => (\n                <Card key={achievement.id} className=\"opacity-60\">\n                  <CardContent className=\"p-5\">\n                    <div className=\"flex items-start gap-4\">\n                      <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-muted flex-shrink-0 grayscale\">\n                        {getAchievementIcon(achievement.icon)}\n                      </div>\n                      <div className=\"min-w-0 flex-1\">\n                        <h3 className=\"font-medium\">{achievement.name}</h3>\n                        <p className=\"text-sm text-muted-foreground mt-1\">\n                          {achievement.description}\n                        </p>\n                        {achievement.maxProgress && (\n                          <div className=\"mt-3\">\n                            <div className=\"flex items-center justify-between text-xs mb-1.5\">\n                              <span className=\"text-muted-foreground tabular-nums\">\n                                {achievement.progress || 0}/{achievement.maxProgress}\n                              </span>\n                            </div>\n                            <Progress \n                              value={((achievement.progress || 0) / achievement.maxProgress) * 100}\n                              className=\"h-1.5\"\n                            />\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          </section>\n        )}\n      </div>\n    </div>\n  );\n}\n\nfunction getAchievementIcon(iconName: string) {\n  const iconClass = \"h-6 w-6 text-gold\";\n  const iconComponents: Record<string, JSX.Element> = {\n    footprints: <TrendingUp className={iconClass} />,\n    zap: <Zap className={iconClass} />,\n    \"book-open\": <BookOpen className={iconClass} />,\n    \"trending-up\": <TrendingUp className={iconClass} />,\n    star: <Award className={iconClass} />,\n    flame: <Flame className={iconClass} />,\n    crown: <Trophy className={iconClass} />,\n    moon: <Award className={iconClass} />,\n    sunrise: <Award className={iconClass} />,\n    target: <Target className={iconClass} />,\n    search: <BookOpen className={iconClass} />,\n  };\n  return iconComponents[iconName] || <Trophy className={iconClass} />;\n}\n","path":null,"size_bytes":5999,"size_tokens":null},"attached_assets/cbc-hackathon-notes_1764498863209.md":{"content":"# CBC Hackathon\n\n**Transforming University Learning**  \n*From Passive to Personalised*\n\n---\n\n## The Challenge\n\nHow might we use AI to transform university learning into personalised, accessible experiences that help students both **master their subject** AND **recognise the transferable skills** they're developing for future careers?\n\n---\n\n## Why This Matters\n\n### Key Statistics\n\n- **42%** - of young people cite lack of skills as biggest employment barrier\n- **5.5%** - North East unemployment vs 4.3% UK average\n- **31-34%** - of graduates are overqualified for their jobs\n- **40%** - feel confident they understand what employers want\n\n---\n\n## Remember\n\n-  Simple solutions can beat complex ones - judges care about impact\n-  No-code is completely valid - Claude.ai chat interface alone can win\n-  Prompt engineering = programming - smart prompts valued as much as code\n-  Accessibility matters - think about diverse student needs from the start\n-  Focus on ONE problem - solve it well rather than building everything\n\n---\n\n## Challenge Focus Areas\n\nChoose ONE focus area for your project:\n\n### 1. The Accessible Lecture Companion\nTransform lecture content for personalised engagement\n\n### 2. The Skills Translator\nHelp students recognise and articulate transferable skills\n\n### 3. Interest-Driven Learning Pathways\nConnect learning to career interests and opportunities\n\n### 4. The Accessibility Adapter\nMake content accessible for diverse student needs\n\n### 5. Open Challenge\nYour own solution to transform passive learning\n\n---\n\n## Judging Criteria\n\n| Criterion | Weight | Description |\n|-----------|--------|-------------|\n| **Impact & Relevance** | 30% | Does it solve a real student problem? Clear potential impact? |\n| **Personalisation & Use of AI** | 25% | How effectively does AI personalise the experience? |\n| **Accessibility & Inclusion** | 20% | Works for diverse learning needs? International students? |\n| **Skills Recognition** | 15% | Helps identify/articulate transferable skills? |\n| **Feasibility & Polish** | 10% | Could this be implemented? Is it functional? |\n\n---\n\n## Prizes\n\n-  **Best Overall Solution** - 125\n-  **Most Innovative** - 50\n-  **People's Choice** - 25\n\nAll participants receive a certificate + website showcase\n\n---\n\n## Submission Requirements\n\n**Deadline: Sunday 14:00**  \nAll submissions must be in by 2pm\n\n### What to Submit\n\nSubmit a **slide deck** that includes:\n\n1. **Team Names & Focus Area**  \n   Your team members and chosen challenge track\n\n2. **Demonstration**  \n   Show your app in action (video, screenshots, or live link)\n\n3. **Brief Description**  \n   Max 300 words - what it does and who it's for\n\n4. **AI Prompts & Chat History**  \n   Link to your Claude/ChatGPT conversations (if applicable)\n\n**How to submit:** Upload via the provided submission link before 14:00 Sunday\n\n**Pro tip:** Share your Claude/ChatGPT conversation links to show your prompt engineering process!\n\n---\n\n## In Scope\n\n-  Conversational AI tools\n-  Content transformation\n-  Skills recognition\n-  Personalisation tools\n-  Career connection\n-  Accessibility features\n\n## Out of Scope\n\n-  Replacing teaching\n-  Academic dishonesty\n-  Complete LMS platforms\n-  Grading tools\n-  Real student data\n-  Mental health diagnosis\n\n---\n\n## Notes & Ideas\n\n*Add your project notes, ideas, and development progress below:*\n\n### Team Information\n- Team Name: \n- Members:\n- Focus Area:\n\n### Project Concept\n\n\n### Development Log\n\n\n### Prompt Engineering Notes\n\n\n### Resources & Links\n\n\n### Next Steps\n\n","path":null,"size_bytes":3591,"size_tokens":null},"server/replitAuth.ts":{"content":"import * as client from \"openid-client\";\nimport { Strategy, type VerifyFunction } from \"openid-client/passport\";\n\nimport passport from \"passport\";\nimport session from \"express-session\";\nimport type { Express, RequestHandler } from \"express\";\nimport memoize from \"memoizee\";\nimport connectPg from \"connect-pg-simple\";\nimport { storage } from \"./storage\";\n\nconst getOidcConfig = memoize(\n  async () => {\n    return await client.discovery(\n      new URL(process.env.ISSUER_URL ?? \"https://replit.com/oidc\"),\n      process.env.REPL_ID!\n    );\n  },\n  { maxAge: 3600 * 1000 }\n);\n\nexport function getSession() {\n  const sessionTtl = 7 * 24 * 60 * 60 * 1000; // 1 week\n  const pgStore = connectPg(session);\n  const sessionStore = new pgStore({\n    conString: process.env.DATABASE_URL,\n    createTableIfMissing: false,\n    ttl: sessionTtl,\n    tableName: \"sessions\",\n  });\n  return session({\n    secret: process.env.SESSION_SECRET!,\n    store: sessionStore,\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      secure: true,\n      maxAge: sessionTtl,\n    },\n  });\n}\n\nfunction updateUserSession(\n  user: any,\n  tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers\n) {\n  user.claims = tokens.claims();\n  user.access_token = tokens.access_token;\n  user.refresh_token = tokens.refresh_token;\n  user.expires_at = user.claims?.exp;\n}\n\nasync function upsertUser(\n  claims: any,\n) {\n  await storage.upsertUser({\n    id: claims[\"sub\"],\n    email: claims[\"email\"],\n    firstName: claims[\"first_name\"],\n    lastName: claims[\"last_name\"],\n    profileImageUrl: claims[\"profile_image_url\"],\n  });\n}\n\nexport async function setupAuth(app: Express) {\n  app.set(\"trust proxy\", 1);\n  app.use(getSession());\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  const config = await getOidcConfig();\n\n  const verify: VerifyFunction = async (\n    tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers,\n    verified: passport.AuthenticateCallback\n  ) => {\n    const user = {};\n    updateUserSession(user, tokens);\n    await upsertUser(tokens.claims());\n    verified(null, user);\n  };\n\n  const registeredStrategies = new Set<string>();\n\n  const ensureStrategy = (domain: string) => {\n    const strategyName = `replitauth:${domain}`;\n    if (!registeredStrategies.has(strategyName)) {\n      const strategy = new Strategy(\n        {\n          name: strategyName,\n          config,\n          scope: \"openid email profile offline_access\",\n          callbackURL: `https://${domain}/api/callback`,\n        },\n        verify,\n      );\n      passport.use(strategy);\n      registeredStrategies.add(strategyName);\n    }\n  };\n\n  passport.serializeUser((user: Express.User, cb) => cb(null, user));\n  passport.deserializeUser((user: Express.User, cb) => cb(null, user));\n\n  app.get(\"/api/login\", (req, res, next) => {\n    ensureStrategy(req.hostname);\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      prompt: \"login consent\",\n      scope: [\"openid\", \"email\", \"profile\", \"offline_access\"],\n    })(req, res, next);\n  });\n\n  app.get(\"/api/callback\", (req, res, next) => {\n    ensureStrategy(req.hostname);\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      successReturnToOrRedirect: \"/\",\n      failureRedirect: \"/api/login\",\n    })(req, res, next);\n  });\n\n  app.get(\"/api/logout\", (req, res) => {\n    req.logout(() => {\n      res.redirect(\n        client.buildEndSessionUrl(config, {\n          client_id: process.env.REPL_ID!,\n          post_logout_redirect_uri: `${req.protocol}://${req.hostname}`,\n        }).href\n      );\n    });\n  });\n}\n\nexport const isAuthenticated: RequestHandler = async (req, res, next) => {\n  const user = req.user as any;\n\n  if (!req.isAuthenticated() || !user.expires_at) {\n    return res.status(401).json({ message: \"Unauthorized\" });\n  }\n\n  const now = Math.floor(Date.now() / 1000);\n  if (now <= user.expires_at) {\n    return next();\n  }\n\n  const refreshToken = user.refresh_token;\n  if (!refreshToken) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n\n  try {\n    const config = await getOidcConfig();\n    const tokenResponse = await client.refreshTokenGrant(config, refreshToken);\n    updateUserSession(user, tokenResponse);\n    return next();\n  } catch (error) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n};\n","path":null,"size_bytes":4371,"size_tokens":null},"client/src/lib/authUtils.ts":{"content":"export function isUnauthorizedError(error: Error): boolean {\n  return /^401: .*Unauthorized/.test(error.message);\n}\n","path":null,"size_bytes":116,"size_tokens":null},"client/src/pages/landing.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Zap, BookOpen, Target, Calendar, Award, TrendingUp } from \"lucide-react\";\n\nexport default function Landing() {\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"flex items-center justify-between px-6 py-4 md:px-12\">\n        <div className=\"flex items-center gap-2\">\n          <BookOpen className=\"h-6 w-6 text-primary\" />\n          <span className=\"font-serif text-xl font-medium\">LectureQuest</span>\n        </div>\n        <a href=\"/api/login\" data-testid=\"link-login-header\">\n          <Button variant=\"outline\" size=\"sm\" data-testid=\"button-login-header\">\n            Log In\n          </Button>\n        </a>\n      </header>\n\n      <main className=\"px-6 md:px-12\">\n        <section className=\"mx-auto max-w-4xl py-16 md:py-24 text-center\">\n          <h1 className=\"font-serif text-4xl md:text-5xl lg:text-6xl font-normal tracking-tight text-foreground mb-6\">\n            Master Your Lectures,<br />\n            <span className=\"text-primary\">One Quiz at a Time</span>\n          </h1>\n          <p className=\"text-lg md:text-xl text-muted-foreground max-w-2xl mx-auto mb-10 leading-relaxed\">\n            Transform your study routine with AI-powered quizzes, spaced repetition, and gamified learning. \n            Upload your lecture materials and let LectureQuest guide you to academic excellence.\n          </p>\n          <div className=\"flex flex-col sm:flex-row gap-4 justify-center\">\n            <a href=\"/api/login\" data-testid=\"link-get-started\">\n              <Button size=\"lg\" className=\"text-base px-8\" data-testid=\"button-get-started\">\n                Get Started\n              </Button>\n            </a>\n          </div>\n        </section>\n\n        <section className=\"mx-auto max-w-5xl pb-24\">\n          <h2 className=\"font-serif text-2xl md:text-3xl text-center mb-12 text-foreground\">\n            Everything you need to excel\n          </h2>\n          <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            <Card className=\"hover-elevate transition-transform duration-200\">\n              <CardContent className=\"pt-6\">\n                <div className=\"flex items-center gap-3 mb-4\">\n                  <div className=\"p-2 rounded-lg bg-primary/10\">\n                    <Zap className=\"h-5 w-5 text-primary\" />\n                  </div>\n                  <h3 className=\"font-medium text-lg\">AI-Generated Quizzes</h3>\n                </div>\n                <p className=\"text-muted-foreground leading-relaxed\">\n                  Upload any lecture PDF or text and our AI instantly creates comprehensive quizzes to test your understanding.\n                </p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"hover-elevate transition-transform duration-200\">\n              <CardContent className=\"pt-6\">\n                <div className=\"flex items-center gap-3 mb-4\">\n                  <div className=\"p-2 rounded-lg bg-primary/10\">\n                    <Target className=\"h-5 w-5 text-primary\" />\n                  </div>\n                  <h3 className=\"font-medium text-lg\">Spaced Repetition</h3>\n                </div>\n                <p className=\"text-muted-foreground leading-relaxed\">\n                  Our algorithm tracks your progress and schedules reviews at optimal intervals for long-term retention.\n                </p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"hover-elevate transition-transform duration-200\">\n              <CardContent className=\"pt-6\">\n                <div className=\"flex items-center gap-3 mb-4\">\n                  <div className=\"p-2 rounded-lg bg-primary/10\">\n                    <Award className=\"h-5 w-5 text-primary\" />\n                  </div>\n                  <h3 className=\"font-medium text-lg\">Gamified Learning</h3>\n                </div>\n                <p className=\"text-muted-foreground leading-relaxed\">\n                  Earn XP, level up, and unlock achievements as you study. Stay motivated with streaks and progress tracking.\n                </p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"hover-elevate transition-transform duration-200\">\n              <CardContent className=\"pt-6\">\n                <div className=\"flex items-center gap-3 mb-4\">\n                  <div className=\"p-2 rounded-lg bg-primary/10\">\n                    <Calendar className=\"h-5 w-5 text-primary\" />\n                  </div>\n                  <h3 className=\"font-medium text-lg\">Calendar Integration</h3>\n                </div>\n                <p className=\"text-muted-foreground leading-relaxed\">\n                  Connect your university timetable to automatically track lectures and never miss important material.\n                </p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"hover-elevate transition-transform duration-200\">\n              <CardContent className=\"pt-6\">\n                <div className=\"flex items-center gap-3 mb-4\">\n                  <div className=\"p-2 rounded-lg bg-primary/10\">\n                    <TrendingUp className=\"h-5 w-5 text-primary\" />\n                  </div>\n                  <h3 className=\"font-medium text-lg\">Skill Tracking</h3>\n                </div>\n                <p className=\"text-muted-foreground leading-relaxed\">\n                  Identify transferable skills from your studies and see how your academic work connects to career paths.\n                </p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"hover-elevate transition-transform duration-200\">\n              <CardContent className=\"pt-6\">\n                <div className=\"flex items-center gap-3 mb-4\">\n                  <div className=\"p-2 rounded-lg bg-primary/10\">\n                    <BookOpen className=\"h-5 w-5 text-primary\" />\n                  </div>\n                  <h3 className=\"font-medium text-lg\">Daily Reviews</h3>\n                </div>\n                <p className=\"text-muted-foreground leading-relaxed\">\n                  Personalized daily quizzes focus on your weak areas, ensuring efficient and effective study sessions.\n                </p>\n              </CardContent>\n            </Card>\n          </div>\n        </section>\n\n        <section className=\"mx-auto max-w-3xl pb-24 text-center\">\n          <div className=\"bg-card border border-border rounded-xl p-8 md:p-12\">\n            <h2 className=\"font-serif text-2xl md:text-3xl mb-4 text-foreground\">\n              Ready to transform your learning?\n            </h2>\n            <p className=\"text-muted-foreground mb-8 leading-relaxed\">\n              Join LectureQuest and start mastering your course material with the power of AI and proven learning science.\n            </p>\n            <a href=\"/api/login\" data-testid=\"link-cta-bottom\">\n              <Button size=\"lg\" className=\"text-base px-8\" data-testid=\"button-cta-bottom\">\n                Start Learning Today\n              </Button>\n            </a>\n          </div>\n        </section>\n      </main>\n\n      <footer className=\"border-t border-border py-8 px-6 md:px-12\">\n        <div className=\"flex flex-col md:flex-row items-center justify-between gap-4 text-sm text-muted-foreground\">\n          <div className=\"flex items-center gap-2\">\n            <BookOpen className=\"h-4 w-4\" />\n            <span>LectureQuest</span>\n          </div>\n          <p>Transform your study routine with AI-powered learning</p>\n        </div>\n      </footer>\n    </div>\n  );\n}\n","path":null,"size_bytes":7592,"size_tokens":null},"client/src/hooks/useAuth.ts":{"content":"import { useQuery } from \"@tanstack/react-query\";\n\nexport function useAuth() {\n  const { data: user, isLoading } = useQuery({\n    queryKey: [\"/api/auth/user\"],\n    retry: false,\n  });\n  return { user, isLoading, isAuthenticated: !!user };\n}\n","path":null,"size_bytes":241,"size_tokens":null},"server/db.ts":{"content":"import { Pool, neonConfig } from \"@neondatabase/serverless\";\nimport { drizzle } from \"drizzle-orm/neon-serverless\";\nimport ws from \"ws\";\nimport * as schema from \"@shared/schema\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL environment variable is required\");\n}\n\nneonConfig.webSocketConstructor = ws;\n\nconst pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle(pool, { schema });\n","path":null,"size_bytes":439,"size_tokens":null}},"version":2}